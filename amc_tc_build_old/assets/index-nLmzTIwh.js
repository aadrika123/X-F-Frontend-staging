import{j as e,r as m,l as B,C as O,D as J,g as U,S as X,Q,a as k,e as A}from"./index-aWaQQ42f.js";import{P as ee}from"./index-6NPCvypU.js";import{u as L,T as N,F as ie}from"./TextField-CwPCL7nw.js";import{c as R,a as u,f as se,e as ne}from"./index.esm-zH7Du9xY.js";import{F as T}from"./FormProvider-LSxOEFwC.js";import{S as F}from"./SelectField-e9Tht50U.js";import"./index-tZzLdNKj.js";import{T as M,S as re}from"./react-select.esm-g3oPIE7V.js";import{O as le}from"./OverLayLoader-ahJ9xkng.js";import"./module-Tqv8lF4J.js";function ae({data:i,setData:S,next:w,tradeApplyData:h}){var r,n,p,x,b,o;const t=L({enableReinitialize:!0,initialValues:i,validationSchema:R({applyWith:u().required("Required"),firmType:u().required("Required"),ownershipType:u().required("Required")}),onSubmit:a=>{w(a)}});return e.jsx(T,{formik:t,children:e.jsxs(m.Card,{children:[e.jsx("div",{className:"flex justify-between items-center px-5 bg-blue-gray-400 py-2 rounded-tl-lg rounded-tr-lg",children:e.jsx("h1",{className:"text-base font-semibold text-gray-100",children:"Basic Details"})}),e.jsxs(m.CardBody,{children:[e.jsx("div",{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(F,{label:"Apply With",name:"applyWith",formik:t,isRequiredLabel:!0,children:[e.jsx("option",{value:"",children:"Apply With"}),e.jsx("option",{value:"2",children:"New Application"})]}),e.jsxs(F,{label:"Firm Type",name:"firmType",formik:t,isRequiredLabel:!0,children:[e.jsx("option",{value:"",children:"Firm Type"}),(p=(n=(r=h==null?void 0:h.data)==null?void 0:r.data)==null?void 0:n.firmTypeList)==null?void 0:p.map(a=>e.jsx("option",{value:a==null?void 0:a.id,children:a==null?void 0:a.firm_type},a==null?void 0:a.id))]}),e.jsxs(F,{label:"Ownership Type",name:"ownershipType",formik:t,isRequiredLabel:!0,children:[e.jsx("option",{value:"",children:"Ownership Type"}),(o=(b=(x=h==null?void 0:h.data)==null?void 0:x.data)==null?void 0:b.ownershipTypeList)==null?void 0:o.map(a=>e.jsx("option",{value:a==null?void 0:a.id,children:a==null?void 0:a.ownership_type},a==null?void 0:a.id))]})]})}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsx(m.Button,{color:"blue",type:"submit",size:"sm",children:"Next"})})]})]})})}function te({data:i,setData:S,next:w,prev:h,tradeApplyData:t,natureOfBusiness:r}){var o,a,j,d,q,v,l,g,y;const n=L({enableReinitialize:!0,initialValues:i,validationSchema:R({holdingNo:u().min(10).max(16).label(),zoneId:u().required("Required"),wardNo:u().required("Required"),areaSqft:u().required("Required").min(1).max(10),firmName:u().required("Required").min(2).max(500),firmNameMarathi:u().required("Required"),firmEstdDate:u().required("Required"),businessAddress:u().required("Required").min(2).max(500),landmark:u().required("Required").min(2).max(200),pincode:u().required("Required").min(6).max(6),premisesOwner:u().required("Required").min(2).max(500),businessDescription:u().required("Required").min(2).max(500),natureOfBusiness:se().required("Required")}),onSubmit:s=>{w({...i,...s})}}),{values:p}=n,x=B({api:O.tradeGetPropByHolding,config:{holdingNo:p.holdingNo},value:[p.holdingNo],options:{enabled:!1,onSuccess:s=>{var f,c,C,D,E,z,I,_,P,V,$,W,G,K,Y,H,Z;console.log("res",(f=s==null?void 0:s.data)==null?void 0:f.property),n.setFieldValue("zoneId",(C=(c=s==null?void 0:s.data)==null?void 0:c.property)==null?void 0:C.zone_mstr_id),n.setFieldValue("wardNo",(E=(D=s==null?void 0:s.data)==null?void 0:D.property)==null?void 0:E.ward_mstr_id),n.setFieldValue("areaSqft",(I=(z=s==null?void 0:s.data)==null?void 0:z.property)==null?void 0:I.area_of_plot),n.setFieldValue("businessAddress",(P=(_=s==null?void 0:s.data)==null?void 0:_.property)==null?void 0:P.prop_address),n.setFieldValue("landmark",($=(V=s==null?void 0:s.data)==null?void 0:V.property)==null?void 0:$.landmark),n.setFieldValue("pincode",(G=(W=s==null?void 0:s.data)==null?void 0:W.property)==null?void 0:G.prop_pin_code),n.setFieldValue("premisesOwner",(Y=(K=s==null?void 0:s.data)==null?void 0:K.property)==null?void 0:Y.owner_name),n==null||n.setFieldValue("propDtlId",(Z=(H=s==null?void 0:s.data)==null?void 0:H.property)==null?void 0:Z.id)}}}),b=B({api:(o=J)==null?void 0:o.getWardByZone,config:{zoneId:p.zoneId},value:[p.zoneId],options:{enabled:!!p.zoneId}});return e.jsxs(T,{formik:n,children:[x.isLoading&&e.jsx(le,{}),e.jsxs(m.Card,{children:[e.jsx("div",{className:"flex justify-between items-center px-5 bg-blue-gray-400 py-2 rounded-tl-lg rounded-tr-lg",children:e.jsx("h1",{className:"text-base font-semibold text-gray-100",children:"Firm Details"})}),e.jsxs(m.CardBody,{children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-2 gap-4",children:[e.jsx(N,{label:"Holding No",name:"holdingNo",formik:n,isRequiredLabel:!0,onBlur:()=>x.refetch()}),e.jsxs(F,{label:"Zone",name:"zoneId",formik:n,isRequiredLabel:!0,children:[e.jsx("option",{value:"",children:"Zone"}),(d=(j=(a=t==null?void 0:t.data)==null?void 0:a.data)==null?void 0:j.zone)==null?void 0:d.map(s=>e.jsx("option",{value:s==null?void 0:s.id,children:s==null?void 0:s.zone_name},s==null?void 0:s.id))]}),e.jsxs(F,{label:"Ward No",name:"wardNo",formik:n,isRequiredLabel:!0,children:[e.jsx("option",{value:"",children:"Ward No"}),(v=(q=b==null?void 0:b.data)==null?void 0:q.data)==null?void 0:v.map(s=>e.jsx("option",{value:s==null?void 0:s.id,children:s==null?void 0:s.ward_name},s==null?void 0:s.id))]}),e.jsx(N,{type:"number",label:"Area in Sqft",name:"areaSqft",formik:n,isRequiredLabel:!0}),e.jsx(N,{label:"Firm Name",name:"firmName",formik:n,isRequiredLabel:!0}),e.jsx(M,{onChangeText:s=>{n.setFieldValue("firmNameMarathi",s)},value:(l=n==null?void 0:n.values)==null?void 0:l.firmNameMarathi,insertCurrentSelectionOnBlur:!0,triggerKeys:["KEY_SPACE"],label:"Firm Name (Marathi)",name:"firmNameMarathi",formik:n,isRequiredLabel:!0}),e.jsx(N,{type:"date",label:"Firm Estd. Date",name:"firmEstdDate",formik:n,isRequiredLabel:!0}),e.jsx(N,{label:"Business Address",name:"businessAddress",formik:n,isRequiredLabel:!0}),e.jsx(N,{label:"Landmark",name:"landmark",formik:n,isRequiredLabel:!0}),e.jsx(N,{label:"Pincode",name:"pincode",formik:n}),e.jsx(N,{disabled:n.values.holdingNo,label:"Premises Owner",name:"premisesOwner",formik:n,isRequiredLabel:!0}),e.jsx(N,{label:"Business Description",name:"businessDescription",formik:n,isRequiredLabel:!0}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(re,{value:(g=n==null?void 0:n.values)==null?void 0:g.natureOfBusiness,name:"natureOfBusiness",options:r,className:"basic-multi-select",classNamePrefix:"select",onChange:s=>{n.setFieldValue("natureOfBusiness",s)}}),e.jsx("p",{className:"text-sm text-red-500",children:(y=n==null?void 0:n.errors)==null?void 0:y.natureOfBusiness})]})]}),e.jsx("hr",{className:"my-4"}),e.jsxs("div",{className:"flex justify-between mt-4 gap-4",children:[e.jsx(m.Button,{color:"gray",size:"sm",onClick:()=>h(n.values),children:"Back"}),e.jsx(m.Button,{color:"blue",type:"submit",size:"sm",children:"Next"})]})]})]})]})}function oe({data:i,setData:S,next:w,prev:h}){const t=L({enableReinitialize:!0,initialValues:i,validationSchema:R({ownerDetails:ne().of(R().shape({businessOwnerName:u().required("Required").min(2).max(500).label("Owner Name"),guardianName:u().required("Required").min(2).max(500).label("Guardian Name"),mobileNo:u().required("Required").min(10).max(10).label("Mobile No"),ownerNameMarathi:u().required("Required").min(2).max(500).label("Owner Name Marathi"),guardianNameMarathi:u().required("Required").min(2).max(500).label("Guardian Name Marathi"),email:u().required("Required").min(2).max(500).label("Email")}))}),onSubmit:r=>{w(r)}});return e.jsx(T,{formik:t,children:e.jsxs(m.Card,{children:[e.jsx("div",{className:"flex justify-between items-center px-5 bg-blue-gray-400 py-2 rounded-tl-lg rounded-tr-lg",children:e.jsx("h1",{className:"text-base font-semibold text-gray-100",children:"Owner"})}),e.jsxs(m.CardBody,{children:[e.jsx("div",{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsx(ie,{name:"ownerDetails",children:({push:r,remove:n})=>{var p,x;return e.jsxs(e.Fragment,{children:[(x=(p=t==null?void 0:t.values)==null?void 0:p.ownerDetails)==null?void 0:x.map((b,o)=>{var a,j,d,q,v,l;return e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-2 gap-2",children:[e.jsx(N,{isDynamic:!0,label:"Owner Name",name:"ownerDetails.".concat(o,".businessOwnerName"),formik:t,isRequiredLabel:!0}),e.jsx(N,{isDynamic:!0,label:"Guardian Name",name:"ownerDetails.".concat(o,".guardianName"),formik:t,isRequiredLabel:!0}),e.jsx(N,{type:"number",onInput:g=>g.target.value=Math.max(0,parseInt(g.target.value)).toString().slice(0,10),isDynamic:!0,label:"Mobile No",name:"ownerDetails.".concat(o,".mobileNo"),formik:t,isRequiredLabel:!0}),e.jsx(M,{onChangeText:g=>{t.setFieldValue("ownerDetails.".concat(o,".ownerNameMarathi"),g)},value:(d=(j=(a=t==null?void 0:t.values)==null?void 0:a.ownerDetails)==null?void 0:j[o])==null?void 0:d.ownerNameMarathi,insertCurrentSelectionOnBlur:!0,triggerKeys:["KEY_SPACE"],isDynamic:!0,label:"Owner Name Marathi",name:"ownerDetails.".concat(o,".ownerNameMarathi"),formik:t,isRequiredLabel:!0}),e.jsx(M,{insertCurrentSelectionOnBlur:!0,triggerKeys:["KEY_SPACE"],isDynamic:!0,value:(l=(v=(q=t==null?void 0:t.values)==null?void 0:q.ownerDetails)==null?void 0:v[o])==null?void 0:l.guardianNameMarathi,onChangeText:g=>{t.setFieldValue("ownerDetails.".concat(o,".guardianNameMarathi"),g)},label:"Guardian Name Marathi",name:"ownerDetails.".concat(o,".guardianNameMarathi"),formik:t,isRequiredLabel:!0}),e.jsx(N,{isDynamic:!0,type:"email",label:"Email",name:"ownerDetails.".concat(o,".email"),formik:t,isRequiredLabel:!0}),o>0&&e.jsx("div",{className:"flex justify-end items-end col-span-2",children:e.jsx(m.Button,{color:"red",size:"sm",onClick:()=>n(o),children:e.jsx("small",{children:"Remove"})})})]}),e.jsx("div",{className:"border-b border-gray-300 my-4"})]},o)}),(i==null?void 0:i.firmType)!=1&&e.jsx("div",{className:"flex justify-center items-end -mt-4",children:e.jsx(m.Button,{size:"sm",onClick:()=>r?r({businessOwnerName:"",guardianName:"",mobileNo:"",ownerNameMarathi:"",guardianNameMarathi:"",email:""}):null,children:"Add Owner"})})]})}})})}),e.jsxs("div",{className:"flex justify-between mt-4 gap-4",children:[e.jsx(m.Button,{color:"gray",size:"sm",onClick:()=>h(t.values),children:"Back"}),e.jsx(m.Button,{color:"blue",type:"submit",size:"sm",children:"Next"})]})]})]})})}function ce({data:i,setData:S,next:w,prev:h}){var p,x,b,o,a,j,d,q,v;const{mutateAsync:t}=U({}),r=L({enableReinitialize:!0,initialValues:{licenseFor:i.licenseFor||"",licenseCharge:i.licenseCharge||"",penalty:i.penalty||"",denialAmount:i.denialAmount||"",totalCharge:i.totalCharge||""},validationSchema:R().shape({licenseFor:u().required("License For is required"),licenseCharge:u().required("License Charge is required"),penalty:u().required("Penalty is required"),denialAmount:u().required("Denial Amount is required"),totalCharge:u().required("Total Charge is required")}),onSubmit:async(l,{setSubmitting:g})=>{var y,s,f;i==null||i.applyWith,i!=null&&i.noticeNo,i!=null&&i.noticeDate,i!=null&&i.firmType,i!=null&&i.ownershipType,i!=null&&i.licenseNo,i!=null&&i.otherFirmType,i!=null&&i.wardNo,i!=null&&i.holdingNo,i!=null&&i.areaSqft,i!=null&&i.firmName,i!=null&&i.firmNameMarathi,i!=null&&i.firmEstdDate,i!=null&&i.businessAddress,i!=null&&i.landmark,i!=null&&i.pincode,i!=null&&i.premisesOwner,i!=null&&i.businessDescription,(y=i==null?void 0:i.natureOfBusiness)==null||y.label,(s=i==null?void 0:i.natureOfBusiness)==null||s.value,i!=null&&i.propDtlId,i!=null&&i.zoneId,i==null||i.ownerDetails,l==null||l.licenseFor,l==null||l.licenseCharge,l==null||l.penalty,l==null||l.denialAmount,l==null||l.totalCharge,X.fire({title:"Are you sure?",text:"You want to proceed with the payment of ₹ ".concat((f=r==null?void 0:r.values)==null?void 0:f.totalCharge),icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, Proceed!",cancelButtonText:"No, cancel!",reverseButtons:!0}).then(c=>{c.isConfirmed&&n(l)}).catch(c=>{var C,D;Q.error((D=(C=c==null?void 0:c.response)==null?void 0:C.data)==null?void 0:D.message)})}}),n=async l=>{var g,y,s,f;try{const c=await t({api:O.tradeAddNew,data:submitData});(g=c==null?void 0:c.data)!=null&&g.status&&(Q.success((y=c==null?void 0:c.data)==null?void 0:y.message),w({...i,...l,message:(s=c==null?void 0:c.data)==null?void 0:s.message,applyLicenseId:(f=c==null?void 0:c.data)==null?void 0:f.applyLicenseId}))}catch(c){console.log(c)}};return B({api:O.tradeGetDemand,config:{licenseFor:r.values.licenseFor,firmEstdDate:i==null?void 0:i.firmEstdDate,natureOfBusiness:[{id:(p=i.natureOfBusiness)==null?void 0:p.value,name:(x=i.natureOfBusiness)==null?void 0:x.label}],areaSqft:i==null?void 0:i.areaSqft,applicationType:"NEWLICENSE",tocStatus:0,noticeDate:""},value:[(b=r==null?void 0:r.values)==null?void 0:b.licenseFor],options:{enabled:!!((o=r==null?void 0:r.values)!=null&&o.licenseFor),onSuccess:l=>{var g,y,s,f,c,C;console.log("res",(g=l==null?void 0:l.data)==null?void 0:g.total_charge),r.setFieldValue("licenseCharge",(y=l==null?void 0:l.data)==null?void 0:y.rate),r.setFieldValue("penalty",(s=l==null?void 0:l.data)==null?void 0:s.penalty),r.setFieldValue("denialAmount",((f=l==null?void 0:l.data)==null?void 0:f.arear_amount)+((c=l==null?void 0:l.data)==null?void 0:c.notice_amount)||0),r.setFieldValue("totalCharge",((C=l==null?void 0:l.data)==null?void 0:C.total_charge)||0)}}}),e.jsx(T,{formik:r,children:e.jsxs(m.Card,{children:[e.jsx("div",{className:"flex justify-between items-center px-5 bg-blue-gray-400 py-2 rounded-tl-lg rounded-tr-lg",children:e.jsx("h1",{className:"text-base font-semibold text-gray-100",children:"Payable Amount"})}),e.jsxs(m.CardBody,{children:[e.jsx("div",{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsxs(F,{label:"License For",name:"licenseFor",formik:r,children:[e.jsx("option",{value:"",children:"Select License For"}),e.jsx("option",{value:"1",children:"1 Year"})]})})}),e.jsx("div",{className:"border-t border-gray-200 my-5"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-2 gap-4 ",children:[e.jsx("h1",{className:"text-sm font-semibold text-gray-700",children:"Charge Applied :"}),e.jsxs("h1",{className:"text-sm font-semibold text-gray-700",children:["₹ ",((a=r==null?void 0:r.values)==null?void 0:a.licenseCharge)||0]}),e.jsx("h1",{className:"text-sm font-semibold text-gray-700",children:"Penalty :"}),e.jsxs("h1",{className:"text-sm font-semibold text-gray-700",children:["₹ ",((j=r==null?void 0:r.values)==null?void 0:j.penalty)||0]}),e.jsx("h1",{className:"text-sm font-semibold text-gray-700",children:"Denial Amount :"}),e.jsxs("h1",{className:"text-sm font-semibold text-gray-700",children:["₹ ",((d=r==null?void 0:r.values)==null?void 0:d.denialAmount)||0]}),e.jsx("h1",{className:"text-sm font-semibold text-gray-700",children:"Total Charge :"}),e.jsxs("h1",{className:"text-sm font-semibold text-gray-700",children:["₹ ",((q=r==null?void 0:r.values)==null?void 0:q.totalCharge)||0]}),e.jsx("div",{className:"border-t border-gray-200 col-span-2 "}),e.jsx("h1",{className:"text-sm font-semibold text-gray-700",children:"Payable Amount :"}),e.jsxs("h1",{className:"text-sm font-semibold text-gray-700",children:["₹ ",((v=r==null?void 0:r.values)==null?void 0:v.totalCharge)||0]})]}),e.jsxs("div",{className:"flex justify-between mt-4",children:[e.jsx(m.Button,{color:"gray",size:"sm",onClick:()=>h(r.values),children:"Back"}),e.jsx(m.Button,{color:"blue",type:"submit",size:"sm",children:"Final Submit"})]})]})]})})}function ue({data:i}){const S=k();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"border border-gray-200 shadow-md shadow-gray-300 justify-center p-4 sm:w-1/2 lg:w-1/3 w-full bg-white mx-auto flex flex-col h-screen top-0 left-0 right-0 bottom-0 fixed",children:[e.jsxs("div",{className:"relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 hover:bg-white opacity-0 transition duration-700 hover:opacity-10"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor","data-slot":"icon",className:"text-white w-24 h-24 mb-4 mt-12 bg-green-600 max-w-full h-auto mx-auto animate-wiggle rounded-full",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12c0 1.268-.63 2.39-1.593 3.068a3.745 3.745 0 0 1-1.043 3.296 3.745 3.745 0 0 1-3.296 1.043A3.745 3.745 0 0 1 12 21c-1.268 0-2.39-.63-3.068-1.593a3.746 3.746 0 0 1-3.296-1.043 3.745 3.745 0 0 1-1.043-3.296A3.745 3.745 0 0 1 3 12c0-1.268.63-2.39 1.593-3.068a3.745 3.745 0 0 1 1.043-3.296 3.746 3.746 0 0 1 3.296-1.043A3.746 3.746 0 0 1 12 3c1.268 0 2.39.63 3.068 1.593a3.746 3.746 0 0 1 3.296 1.043 3.746 3.746 0 0 1 1.043 3.296A3.745 3.745 0 0 1 21 12Z"})})]}),e.jsx("div",{className:"",children:e.jsxs("div",{className:"mb-2",children:[e.jsx("h3",{className:"text-2xl  text-center mb-6 text-[#40AA15] font-openSans font-semibold",children:"This Application Is Submitted."}),e.jsxs("h3",{className:"text-xl  text-center mb-2 text-gray-400 font-openSans font-semibold ",children:["Generated Application No: ",i==null?void 0:i.message]}),e.jsx("h3",{className:"text-sm  text-center mb-3 text-gray-400 font-openSans font-semibold ",children:"( Keep This application No. for future reference. You can always find your applications in)"})]})}),e.jsx("div",{className:"",children:e.jsx("div",{className:" text-center mt-8 mb-16",children:e.jsxs("button",{onClick:()=>S("/amc-app/trade/application-details/".concat(i==null?void 0:i.applyLicenseId),{replace:!0}),className:"bg-[#1A4D8C] text-sm px-8 py-2 text-white  rounded leading-5 shadow-lg",children:[" ","View Application"]})})})]})})}function fe(){const[i,S]=A.useState([]),w=B({api:O.tradeApplyData,config:{applicationType:"NEWLICENSE"},options:{enabled:!0,onSuccess:o=>{var a,j;S((j=(a=o==null?void 0:o.data)==null?void 0:a.natureOfBusiness)==null?void 0:j.map(d=>({value:d==null?void 0:d.id,label:"(".concat(d==null?void 0:d.trade_code,") - ").concat(d==null?void 0:d.trade_item)})))}}}),[h,t]=A.useState(1),[r,n]=A.useState({applyWith:"",noticeNo:"",noticeDate:"",firmType:"",ownershipType:"",licenseNo:"",otherFirmType:"",holdingNo:"",zoneId:"",wardNo:"",areaSqft:"",firmName:"",firmNameMarathi:"",firmEstdDate:"",businessAddress:"",landmark:"",pincode:"",premisesOwner:"",businessDescription:"",natureOfBusiness:null,tocStatus:0,propDtlId:"",ownerDetails:[{businessOwnerName:"",guardianName:"",mobileNo:"",ownerNameMarathi:"",guardianNameMarathi:"",email:""}],licenseFor:"",licenseCharge:"",penalty:"",denialAmount:"",totalCharge:"",message:"",applyLicenseId:""}),p=o=>{console.log(o)},x=(o,a=!1)=>{if(n({...r,...o}),a){p(o);return}t(h+1)},b=o=>{n({...r,...o}),t(h-1)};return e.jsx(ee,{title:"New Application Trade",children:e.jsx("div",{className:"p-4",children:{1:e.jsx(ae,{data:r,setData:n,next:x,tradeApplyData:w}),2:e.jsx(te,{data:r,setData:n,next:x,prev:b,tradeApplyData:w,natureOfBusiness:i}),3:e.jsx(oe,{data:r,setData:n,next:x,prev:b}),4:e.jsx(ce,{data:r,setData:n,next:x,prev:b}),5:e.jsx(ue,{data:r})}[h]})})}export{fe as default};
