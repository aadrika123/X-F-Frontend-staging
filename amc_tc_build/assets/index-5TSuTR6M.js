var ns=Object.defineProperty;var ss=(D,n,L)=>n in D?ns(D,n,{enumerable:!0,configurable:!0,writable:!0,value:L}):D[n]=L;var se=(D,n,L)=>(ss(D,typeof n!="symbol"?n+"":n,L),L),Be=(D,n,L)=>{if(!n.has(D))throw TypeError("Cannot "+L)};var t=(D,n,L)=>(Be(D,n,"read from private field"),L?L.call(D):n.get(D)),W=(D,n,L)=>{if(n.has(D))throw TypeError("Cannot add the same private member more than once");n instanceof WeakSet?n.add(D):n.set(D,L)},ot=(D,n,L,i)=>(Be(D,n,"write to private field"),i?i.call(D,L):n.set(D,L),L);var be=(D,n,L,i)=>({set _(f){ot(D,n,f,L)},get _(){return t(D,n,i)}}),Y=(D,n,L)=>(Be(D,n,"access private method"),L);import{j as jsxRuntimeExports,b as usePostMutation,a as useApiPost,p as propertyApi,Q,f as InitialLoader}from"./index-rvbWXsAs.js";import{m as getAugmentedNamespace,g as getDefaultExportFromCjs,r as reactExports,R as React,P as PropTypes,u as useNavigate,h as useParams,e as react}from"./react-HXRlOr-l.js";import{u as useFormik}from"./formik.esm-BYe_KACy.js";import{c as create$3,a as create$6}from"./index.esm-yBrOrWJe.js";import{F as FormProvider}from"./FormProvider-KXcKKeLM.js";import{T as TextAreaField}from"./TextAreaField-fhPjsiJM.js";import"./index-mWJwE1Yp.js";import{P as Page$2}from"./index-ydPQ-Vjj.js";import{r as resizeFile}from"./resizeImage-jKDw1KZT.js";import{O as OverLayLoader}from"./OverLayLoader-VNf_HxNe.js";import"./module-P9sElsZx.js";function _mergeNamespaces(D,n){for(var L=0;L<n.length;L++){const i=n[L];if(typeof i!="string"&&!Array.isArray(i)){for(const f in i)if(f!=="default"&&!(f in D)){const z=Object.getOwnPropertyDescriptor(i,f);z&&Object.defineProperty(D,f,z.get?z:{enumerable:!0,get:()=>i[f]})}}}return Object.freeze(Object.defineProperty(D,Symbol.toStringTag,{value:"Module"}))}function commonjsRequire(D){throw new Error('Could not dynamically require "'+D+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf$1={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports){(function(n,L){module.exports=n.pdfjsLib=L()})(globalThis,()=>(()=>{var __webpack_modules__=[,(D,n)=>{var Xt;Object.defineProperty(n,"__esModule",{value:!0}),n.VerbosityLevel=n.Util=n.UnknownErrorException=n.UnexpectedResponseException=n.TextRenderingMode=n.RenderingIntentFlag=n.PromiseCapability=n.PermissionFlag=n.PasswordResponses=n.PasswordException=n.PageActionEventType=n.OPS=n.MissingPDFException=n.MAX_IMAGE_SIZE_TO_CACHE=n.LINE_FACTOR=n.LINE_DESCENT_FACTOR=n.InvalidPDFException=n.ImageKind=n.IDENTITY_MATRIX=n.FormatError=n.FeatureTest=n.FONT_IDENTITY_MATRIX=n.DocumentActionEventType=n.CMapCompressionType=n.BaseException=n.BASELINE_FACTOR=n.AnnotationType=n.AnnotationReplyType=n.AnnotationPrefix=n.AnnotationMode=n.AnnotationFlag=n.AnnotationFieldFlag=n.AnnotationEditorType=n.AnnotationEditorPrefix=n.AnnotationEditorParamsType=n.AnnotationBorderStyleType=n.AnnotationActionEventType=n.AbortException=void 0,n.assert=ut,n.bytesToString=U,n.createValidAbsoluteUrl=Tt,n.getModificationDate=Ct,n.getUuid=zt,n.getVerbosityLevel=X,n.info=tt,n.isArrayBuffer=gt,n.isArrayEqual=Pt,n.isNodeJS=void 0,n.normalizeUnicode=Yt,n.objectFromMap=pt,n.objectSize=lt,n.setVerbosityLevel=S,n.shadow=wt,n.string32=nt,n.stringToBytes=rt,n.stringToPDFString=bt,n.stringToUTF8String=it,n.unreachable=G,n.utf8StringToString=st,n.warn=at;const L=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");n.isNodeJS=L;const i=[1,0,0,1,0,0];n.IDENTITY_MATRIX=i;const f=[.001,0,0,.001,0,0];n.FONT_IDENTITY_MATRIX=f;const z=1e7;n.MAX_IMAGE_SIZE_TO_CACHE=z;const H=1.35;n.LINE_FACTOR=H;const ct=.35;n.LINE_DESCENT_FACTOR=ct;const F=ct/H;n.BASELINE_FACTOR=F;const R={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};n.RenderingIntentFlag=R;const m={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};n.AnnotationMode=m;const I="pdfjs_internal_editor_";n.AnnotationEditorPrefix=I;const N={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15};n.AnnotationEditorType=N;const P={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23};n.AnnotationEditorParamsType=P;const E={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};n.PermissionFlag=E;const v={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};n.TextRenderingMode=v;const p={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};n.ImageKind=p;const y={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};n.AnnotationType=y;const C={GROUP:"Group",REPLY:"R"};n.AnnotationReplyType=C;const x={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};n.AnnotationFlag=x;const A={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};n.AnnotationFieldFlag=A;const c={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};n.AnnotationBorderStyleType=c;const d={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};n.AnnotationActionEventType=d;const M={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};n.DocumentActionEventType=M;const b={O:"PageOpen",C:"PageClose"};n.PageActionEventType=b;const l={ERRORS:0,WARNINGS:1,INFOS:5};n.VerbosityLevel=l;const w={NONE:0,BINARY:1};n.CMapCompressionType=w;const g={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};n.OPS=g;const $={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};n.PasswordResponses=$;let V=l.WARNINGS;function S(ft){Number.isInteger(ft)&&(V=ft)}function X(){return V}function tt(ft){V>=l.INFOS&&console.log("Info: ".concat(ft))}function at(ft){V>=l.WARNINGS&&console.log("Warning: ".concat(ft))}function G(ft){throw new Error(ft)}function ut(ft,et){ft||G(et)}function yt(ft){switch(ft==null?void 0:ft.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function Tt(ft,et=null,K=null){if(!ft)return null;try{if(K&&typeof ft=="string"){if(K.addDefaultProtocol&&ft.startsWith("www.")){const vt=ft.match(/\./g);(vt==null?void 0:vt.length)>=2&&(ft="http://".concat(ft))}if(K.tryConvertEncoding)try{ft=it(ft)}catch(vt){}}const At=et?new URL(ft,et):new URL(ft);if(yt(At))return At}catch(At){}return null}function wt(ft,et,K,At=!1){return Object.defineProperty(ft,et,{value:K,enumerable:!At,configurable:!0,writable:!1}),K}const k=function(){function et(K,At){this.constructor===et&&G("Cannot initialize BaseException."),this.message=K,this.name=At}return et.prototype=new Error,et.constructor=et,et}();n.BaseException=k;class s extends k{constructor(et,K){super(et,"PasswordException"),this.code=K}}n.PasswordException=s;class o extends k{constructor(et,K){super(et,"UnknownErrorException"),this.details=K}}n.UnknownErrorException=o;class a extends k{constructor(et){super(et,"InvalidPDFException")}}n.InvalidPDFException=a;class h extends k{constructor(et){super(et,"MissingPDFException")}}n.MissingPDFException=h;class u extends k{constructor(et,K){super(et,"UnexpectedResponseException"),this.status=K}}n.UnexpectedResponseException=u;class T extends k{constructor(et){super(et,"FormatError")}}n.FormatError=T;class O extends k{constructor(et){super(et,"AbortException")}}n.AbortException=O;function U(ft){(typeof ft!="object"||(ft==null?void 0:ft.length)===void 0)&&G("Invalid argument for bytesToString");const et=ft.length,K=8192;if(et<K)return String.fromCharCode.apply(null,ft);const At=[];for(let vt=0;vt<et;vt+=K){const ne=Math.min(vt+K,et),ee=ft.subarray(vt,ne);At.push(String.fromCharCode.apply(null,ee))}return At.join("")}function rt(ft){typeof ft!="string"&&G("Invalid argument for stringToBytes");const et=ft.length,K=new Uint8Array(et);for(let At=0;At<et;++At)K[At]=ft.charCodeAt(At)&255;return K}function nt(ft){return String.fromCharCode(ft>>24&255,ft>>16&255,ft>>8&255,ft&255)}function lt(ft){return Object.keys(ft).length}function pt(ft){const et=Object.create(null);for(const[K,At]of ft)et[K]=At;return et}function mt(){const ft=new Uint8Array(4);return ft[0]=1,new Uint32Array(ft.buffer,0,1)[0]===1}function dt(){try{return new Function(""),!0}catch(ft){return!1}}class kt{static get isLittleEndian(){return wt(this,"isLittleEndian",mt())}static get isEvalSupported(){return wt(this,"isEvalSupported",dt())}static get isOffscreenCanvasSupported(){return wt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?wt(this,"platform",{isWin:!1,isMac:!1}):wt(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}static get isCSSRoundSupported(){var et,K;return wt(this,"isCSSRoundSupported",(K=(et=globalThis.CSS)==null?void 0:et.supports)==null?void 0:K.call(et,"width: round(1.5px, 1px)"))}}n.FeatureTest=kt;const Nt=[...Array(256).keys()].map(ft=>ft.toString(16).padStart(2,"0"));class St{static makeHexColor(et,K,At){return"#".concat(Nt[et]).concat(Nt[K]).concat(Nt[At])}static scaleMinMax(et,K){let At;et[0]?(et[0]<0&&(At=K[0],K[0]=K[1],K[1]=At),K[0]*=et[0],K[1]*=et[0],et[3]<0&&(At=K[2],K[2]=K[3],K[3]=At),K[2]*=et[3],K[3]*=et[3]):(At=K[0],K[0]=K[2],K[2]=At,At=K[1],K[1]=K[3],K[3]=At,et[1]<0&&(At=K[2],K[2]=K[3],K[3]=At),K[2]*=et[1],K[3]*=et[1],et[2]<0&&(At=K[0],K[0]=K[1],K[1]=At),K[0]*=et[2],K[1]*=et[2]),K[0]+=et[4],K[1]+=et[4],K[2]+=et[5],K[3]+=et[5]}static transform(et,K){return[et[0]*K[0]+et[2]*K[1],et[1]*K[0]+et[3]*K[1],et[0]*K[2]+et[2]*K[3],et[1]*K[2]+et[3]*K[3],et[0]*K[4]+et[2]*K[5]+et[4],et[1]*K[4]+et[3]*K[5]+et[5]]}static applyTransform(et,K){const At=et[0]*K[0]+et[1]*K[2]+K[4],vt=et[0]*K[1]+et[1]*K[3]+K[5];return[At,vt]}static applyInverseTransform(et,K){const At=K[0]*K[3]-K[1]*K[2],vt=(et[0]*K[3]-et[1]*K[2]+K[2]*K[5]-K[4]*K[3])/At,ne=(-et[0]*K[1]+et[1]*K[0]+K[4]*K[1]-K[5]*K[0])/At;return[vt,ne]}static getAxialAlignedBoundingBox(et,K){const At=this.applyTransform(et,K),vt=this.applyTransform(et.slice(2,4),K),ne=this.applyTransform([et[0],et[3]],K),ee=this.applyTransform([et[2],et[1]],K);return[Math.min(At[0],vt[0],ne[0],ee[0]),Math.min(At[1],vt[1],ne[1],ee[1]),Math.max(At[0],vt[0],ne[0],ee[0]),Math.max(At[1],vt[1],ne[1],ee[1])]}static inverseTransform(et){const K=et[0]*et[3]-et[1]*et[2];return[et[3]/K,-et[1]/K,-et[2]/K,et[0]/K,(et[2]*et[5]-et[4]*et[3])/K,(et[4]*et[1]-et[5]*et[0])/K]}static singularValueDecompose2dScale(et){const K=[et[0],et[2],et[1],et[3]],At=et[0]*K[0]+et[1]*K[2],vt=et[0]*K[1]+et[1]*K[3],ne=et[2]*K[0]+et[3]*K[2],ee=et[2]*K[1]+et[3]*K[3],Z=(At+ee)/2,xt=Math.sqrt((At+ee)**2-4*(At*ee-ne*vt))/2,It=Z+xt||1,Ft=Z-xt||1;return[Math.sqrt(It),Math.sqrt(Ft)]}static normalizeRect(et){const K=et.slice(0);return et[0]>et[2]&&(K[0]=et[2],K[2]=et[0]),et[1]>et[3]&&(K[1]=et[3],K[3]=et[1]),K}static intersect(et,K){const At=Math.max(Math.min(et[0],et[2]),Math.min(K[0],K[2])),vt=Math.min(Math.max(et[0],et[2]),Math.max(K[0],K[2]));if(At>vt)return null;const ne=Math.max(Math.min(et[1],et[3]),Math.min(K[1],K[3])),ee=Math.min(Math.max(et[1],et[3]),Math.max(K[1],K[3]));return ne>ee?null:[At,ne,vt,ee]}static bezierBoundingBox(et,K,At,vt,ne,ee,Z,xt){const It=[],Ft=[[],[]];let Bt,Ut,Zt,Et,Jt,jt,j,e;for(let J=0;J<2;++J){if(J===0?(Ut=6*et-12*At+6*ne,Bt=-3*et+9*At-9*ne+3*Z,Zt=3*At-3*et):(Ut=6*K-12*vt+6*ee,Bt=-3*K+9*vt-9*ee+3*xt,Zt=3*vt-3*K),Math.abs(Bt)<1e-12){if(Math.abs(Ut)<1e-12)continue;Et=-Zt/Ut,0<Et&&Et<1&&It.push(Et);continue}j=Ut*Ut-4*Zt*Bt,e=Math.sqrt(j),!(j<0)&&(Jt=(-Ut+e)/(2*Bt),0<Jt&&Jt<1&&It.push(Jt),jt=(-Ut-e)/(2*Bt),0<jt&&jt<1&&It.push(jt))}let _=It.length,B;const q=_;for(;_--;)Et=It[_],B=1-Et,Ft[0][_]=B*B*B*et+3*B*B*Et*At+3*B*Et*Et*ne+Et*Et*Et*Z,Ft[1][_]=B*B*B*K+3*B*B*Et*vt+3*B*Et*Et*ee+Et*Et*Et*xt;return Ft[0][q]=et,Ft[1][q]=K,Ft[0][q+1]=Z,Ft[1][q+1]=xt,Ft[0].length=Ft[1].length=q+2,[Math.min(...Ft[0]),Math.min(...Ft[1]),Math.max(...Ft[0]),Math.max(...Ft[1])]}}n.Util=St;const Ot=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function bt(ft){if(ft[0]>="ï"){let K;if(ft[0]==="þ"&&ft[1]==="ÿ"?K="utf-16be":ft[0]==="ÿ"&&ft[1]==="þ"?K="utf-16le":ft[0]==="ï"&&ft[1]==="»"&&ft[2]==="¿"&&(K="utf-8"),K)try{const At=new TextDecoder(K,{fatal:!0}),vt=rt(ft);return At.decode(vt)}catch(At){at('stringToPDFString: "'.concat(At,'".'))}}const et=[];for(let K=0,At=ft.length;K<At;K++){const vt=Ot[ft.charCodeAt(K)];et.push(vt?String.fromCharCode(vt):ft.charAt(K))}return et.join("")}function it(ft){return decodeURIComponent(escape(ft))}function st(ft){return unescape(encodeURIComponent(ft))}function gt(ft){return typeof ft=="object"&&(ft==null?void 0:ft.byteLength)!==void 0}function Pt(ft,et){if(ft.length!==et.length)return!1;for(let K=0,At=ft.length;K<At;K++)if(ft[K]!==et[K])return!1;return!0}function Ct(ft=new Date){return[ft.getUTCFullYear().toString(),(ft.getUTCMonth()+1).toString().padStart(2,"0"),ft.getUTCDate().toString().padStart(2,"0"),ft.getUTCHours().toString().padStart(2,"0"),ft.getUTCMinutes().toString().padStart(2,"0"),ft.getUTCSeconds().toString().padStart(2,"0")].join("")}class $t{constructor(){W(this,Xt,!1);this.promise=new Promise((et,K)=>{this.resolve=At=>{ot(this,Xt,!0),et(At)},this.reject=At=>{ot(this,Xt,!0),K(At)}})}get settled(){return t(this,Xt)}}Xt=new WeakMap,n.PromiseCapability=$t;let Vt=null,Ht=null;function Yt(ft){return Vt||(Vt=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Ht=new Map([["ﬅ","ſt"]])),ft.replaceAll(Vt,(et,K,At)=>K?K.normalize("NFKC"):Ht.get(At))}function zt(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const ft=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(ft);else for(let et=0;et<32;et++)ft[et]=Math.floor(Math.random()*255);return U(ft)}const Gt="pdfjs_internal_id_";n.AnnotationPrefix=Gt},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var D,L,i,f,ue,H,xe,F,R,m,I,N,P,E,v,p,we,C,x,Ue,c,d;Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,Object.defineProperty(exports,"SVGGraphics",{enumerable:!0,get:function(){return _displaySvg.SVGGraphics}}),exports.build=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_displayNode_utils=__w_pdfjs_require__(10),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_displayFetch_stream=__w_pdfjs_require__(19),_displayNetwork=__w_pdfjs_require__(22),_displayNode_stream=__w_pdfjs_require__(23),_displaySvg=__w_pdfjs_require__(24),_xfa_text=__w_pdfjs_require__(25);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_util.isNodeJS?_displayNode_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_util.isNodeJS?_displayNode_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultFilterFactory=_util.isNodeJS?_displayNode_utils.NodeFilterFactory:_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;const DefaultStandardFontDataFactory=_util.isNodeJS?_displayNode_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;function getDocument(b){var $t,Vt;if(typeof b=="string"||b instanceof URL?b={url:b}:(0,_util.isArrayBuffer)(b)&&(b={data:b}),typeof b!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!b.url&&!b.data&&!b.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const l=new PDFDocumentLoadingTask,{docId:w}=l,g=b.url?getUrlProp(b.url):null,$=b.data?getDataProp(b.data):null,V=b.httpHeaders||null,S=b.withCredentials===!0,X=($t=b.password)!=null?$t:null,tt=b.range instanceof PDFDataRangeTransport?b.range:null,at=Number.isInteger(b.rangeChunkSize)&&b.rangeChunkSize>0?b.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let G=b.worker instanceof PDFWorker?b.worker:null;const ut=b.verbosity,yt=typeof b.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(b.docBaseUrl)?b.docBaseUrl:null,Tt=typeof b.cMapUrl=="string"?b.cMapUrl:null,wt=b.cMapPacked!==!1,k=b.CMapReaderFactory||DefaultCMapReaderFactory,s=typeof b.standardFontDataUrl=="string"?b.standardFontDataUrl:null,o=b.StandardFontDataFactory||DefaultStandardFontDataFactory,a=b.stopAtErrors!==!0,h=Number.isInteger(b.maxImageSize)&&b.maxImageSize>-1?b.maxImageSize:-1,u=b.isEvalSupported!==!1,T=typeof b.isOffscreenCanvasSupported=="boolean"?b.isOffscreenCanvasSupported:!_util.isNodeJS,O=Number.isInteger(b.canvasMaxAreaInBytes)?b.canvasMaxAreaInBytes:-1,U=typeof b.disableFontFace=="boolean"?b.disableFontFace:_util.isNodeJS,rt=b.fontExtraProperties===!0,nt=b.enableXfa===!0,lt=b.ownerDocument||globalThis.document,pt=b.disableRange===!0,mt=b.disableStream===!0,dt=b.disableAutoFetch===!0,kt=b.pdfBug===!0,Nt=tt?tt.length:(Vt=b.length)!=null?Vt:NaN,St=typeof b.useSystemFonts=="boolean"?b.useSystemFonts:!_util.isNodeJS&&!U,Ot=typeof b.useWorkerFetch=="boolean"?b.useWorkerFetch:k===_display_utils.DOMCMapReaderFactory&&o===_display_utils.DOMStandardFontDataFactory&&Tt&&s&&(0,_display_utils.isValidFetchUrl)(Tt,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(s,document.baseURI),bt=b.canvasFactory||new DefaultCanvasFactory({ownerDocument:lt}),it=b.filterFactory||new DefaultFilterFactory({docId:w,ownerDocument:lt}),st=null;(0,_util.setVerbosityLevel)(ut);const gt={canvasFactory:bt,filterFactory:it};if(Ot||(gt.cMapReaderFactory=new k({baseUrl:Tt,isCompressed:wt}),gt.standardFontDataFactory=new o({baseUrl:s})),!G){const Ht={verbosity:ut,port:_worker_options.GlobalWorkerOptions.workerPort};G=Ht.port?PDFWorker.fromPort(Ht):new PDFWorker(Ht),l._worker=G}const Pt={docId:w,apiVersion:"3.11.174",data:$,password:X,disableAutoFetch:dt,rangeChunkSize:at,length:Nt,docBaseUrl:yt,enableXfa:nt,evaluatorOptions:{maxImageSize:h,disableFontFace:U,ignoreErrors:a,isEvalSupported:u,isOffscreenCanvasSupported:T,canvasMaxAreaInBytes:O,fontExtraProperties:rt,useSystemFonts:St,cMapUrl:Ot?Tt:null,standardFontDataUrl:Ot?s:null}},Ct={ignoreErrors:a,isEvalSupported:u,disableFontFace:U,fontExtraProperties:rt,enableXfa:nt,ownerDocument:lt,disableAutoFetch:dt,pdfBug:kt,styleElement:st};return G.promise.then(function(){if(l.destroyed)throw new Error("Loading aborted");const Ht=_fetchDocument(G,Pt),Yt=new Promise(function(zt){let Gt;tt?Gt=new _transport_stream.PDFDataTransportStream({length:Nt,initialData:tt.initialData,progressiveDone:tt.progressiveDone,contentDispositionFilename:tt.contentDispositionFilename,disableRange:pt,disableStream:mt},tt):$||(Gt=(ft=>_util.isNodeJS?new _displayNode_stream.PDFNodeStream(ft):(0,_display_utils.isValidFetchUrl)(ft.url)?new _displayFetch_stream.PDFFetchStream(ft):new _displayNetwork.PDFNetworkStream(ft))({url:g,length:Nt,httpHeaders:V,withCredentials:S,rangeChunkSize:at,disableRange:pt,disableStream:mt})),zt(Gt)});return Promise.all([Ht,Yt]).then(function([zt,Gt]){if(l.destroyed)throw new Error("Loading aborted");const Xt=new _message_handler.MessageHandler(w,zt,G.port),ft=new WorkerTransport(Xt,l,Gt,Ct,gt);l._transport=ft,Xt.send("Ready",null)})}).catch(l._capability.reject),l}async function _fetchDocument(b,l){if(b.destroyed)throw new Error("Worker was destroyed");const w=await b.messageHandler.sendWithPromise("GetDocRequest",l,l.data?[l.data.buffer]:null);if(b.destroyed)throw new Error("Worker was destroyed");return w}function getUrlProp(b){if(b instanceof URL)return b.href;try{return new URL(b,window.location).href}catch(l){if(_util.isNodeJS&&typeof b=="string")return b}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(b){if(_util.isNodeJS&&typeof Buffer<"u"&&b instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(b instanceof Uint8Array&&b.byteLength===b.buffer.byteLength)return b;if(typeof b=="string")return(0,_util.stringToBytes)(b);if(typeof b=="object"&&!isNaN(b==null?void 0:b.length)||(0,_util.isArrayBuffer)(b))return new Uint8Array(b);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}const n=class n{constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId="d".concat(be(n,D)._++),this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var l,w,g;this.destroyed=!0;try{(l=this._worker)!=null&&l.port&&(this._worker._pendingDestroy=!0),await((w=this._transport)==null?void 0:w.destroy())}catch($){throw(g=this._worker)!=null&&g.port&&delete this._worker._pendingDestroy,$}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};D=new WeakMap,W(n,D,0);let PDFDocumentLoadingTask=n;exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(l,w,g=!1,$=null){this.length=l,this.initialData=w,this.progressiveDone=g,this.contentDispositionFilename=$,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(l){this._rangeListeners.push(l)}addProgressListener(l){this._progressListeners.push(l)}addProgressiveReadListener(l){this._progressiveReadListeners.push(l)}addProgressiveDoneListener(l){this._progressiveDoneListeners.push(l)}onDataRange(l,w){for(const g of this._rangeListeners)g(l,w)}onDataProgress(l,w){this._readyCapability.promise.then(()=>{for(const g of this._progressListeners)g(l,w)})}onDataProgressiveRead(l){this._readyCapability.promise.then(()=>{for(const w of this._progressiveReadListeners)w(l)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const l of this._progressiveDoneListeners)l()})}transportReady(){this._readyCapability.resolve()}requestDataRange(l,w){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(l,w){this._pdfInfo=l,this._transport=w,Object.defineProperty(this,"getJavaScript",{value:()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getJavaScript`, please use `PDFDocumentProxy.getJSActions` instead."),this.getJSActions().then(g=>{if(!g)return g;const $=[];for(const V in g)$.push(...g[V]);return $}))})}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(l){return this._transport.getPage(l)}getPageIndex(l){return this._transport.getPageIndex(l)}getDestinations(){return this._transport.getDestinations()}getDestination(l){return this._transport.getDestination(l)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(l=!1){return this._transport.startCleanup(l||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(l,w,g,$=!1){W(this,f);W(this,H);W(this,L,null);W(this,i,!1);this._pageIndex=l,this._pageInfo=w,this._transport=g,this._stats=$?new _display_utils.StatTimer:null,this._pdfBug=$,this.commonObjs=g.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:l,rotation:w=this.rotate,offsetX:g=0,offsetY:$=0,dontFlip:V=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:l,rotation:w,offsetX:g,offsetY:$,dontFlip:V})}getAnnotations({intent:l="display"}={}){const w=this._transport.getRenderingIntent(l);return this._transport.getAnnotations(this._pageIndex,w.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var l;return((l=this._transport._htmlForXfa)==null?void 0:l.children[this._pageIndex])||null}render({canvasContext:l,viewport:w,intent:g="display",annotationMode:$=_util.AnnotationMode.ENABLE,transform:V=null,background:S=null,optionalContentConfigPromise:X=null,annotationCanvasMap:tt=null,pageColors:at=null,printAnnotationStorage:G=null}){var o,a;(o=this._stats)==null||o.time("Overall");const ut=this._transport.getRenderingIntent(g,$,G);ot(this,i,!1),Y(this,H,xe).call(this),X||(X=this._transport.getOptionalContentConfig());let yt=this._intentStates.get(ut.cacheKey);yt||(yt=Object.create(null),this._intentStates.set(ut.cacheKey,yt)),yt.streamReaderCancelTimeout&&(clearTimeout(yt.streamReaderCancelTimeout),yt.streamReaderCancelTimeout=null);const Tt=!!(ut.renderingIntent&_util.RenderingIntentFlag.PRINT);yt.displayReadyCapability||(yt.displayReadyCapability=new _util.PromiseCapability,yt.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(a=this._stats)==null||a.time("Page Request"),this._pumpOperatorList(ut));const wt=h=>{var u,T;yt.renderTasks.delete(k),(this._maybeCleanupAfterRender||Tt)&&ot(this,i,!0),Y(this,f,ue).call(this,!Tt),h?(k.capability.reject(h),this._abortOperatorList({intentState:yt,reason:h instanceof Error?h:new Error(h)})):k.capability.resolve(),(u=this._stats)==null||u.timeEnd("Rendering"),(T=this._stats)==null||T.timeEnd("Overall")},k=new InternalRenderTask({callback:wt,params:{canvasContext:l,viewport:w,transform:V,background:S},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:tt,operatorList:yt.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!Tt,pdfBug:this._pdfBug,pageColors:at});(yt.renderTasks||(yt.renderTasks=new Set)).add(k);const s=k.task;return Promise.all([yt.displayReadyCapability.promise,X]).then(([h,u])=>{var T;if(this.destroyed){wt();return}(T=this._stats)==null||T.time("Rendering"),k.initializeGraphics({transparency:h,optionalContentConfig:u}),k.operatorListChanged()}).catch(wt),s}getOperatorList({intent:l="display",annotationMode:w=_util.AnnotationMode.ENABLE,printAnnotationStorage:g=null}={}){var tt;function $(){S.operatorList.lastChunk&&(S.opListReadCapability.resolve(S.operatorList),S.renderTasks.delete(X))}const V=this._transport.getRenderingIntent(l,w,g,!0);let S=this._intentStates.get(V.cacheKey);S||(S=Object.create(null),this._intentStates.set(V.cacheKey,S));let X;return S.opListReadCapability||(X=Object.create(null),X.operatorListChanged=$,S.opListReadCapability=new _util.PromiseCapability,(S.renderTasks||(S.renderTasks=new Set)).add(X),S.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(tt=this._stats)==null||tt.time("Page Request"),this._pumpOperatorList(V)),S.opListReadCapability.promise}streamTextContent({includeMarkedContent:l=!1,disableNormalization:w=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:l===!0,disableNormalization:w===!0},{highWaterMark:100,size($){return $.items.length}})}getTextContent(l={}){if(this._transport._htmlForXfa)return this.getXfa().then(g=>_xfa_text.XfaText.textContent(g));const w=this.streamTextContent(l);return new Promise(function(g,$){function V(){S.read().then(function({value:tt,done:at}){if(at){g(X);return}Object.assign(X.styles,tt.styles),X.items.push(...tt.items),V()},$)}const S=w.getReader(),X={items:[],styles:Object.create(null)};V()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const l=[];for(const w of this._intentStates.values())if(this._abortOperatorList({intentState:w,reason:new Error("Page was destroyed."),force:!0}),!w.opListReadCapability)for(const g of w.renderTasks)l.push(g.completed),g.cancel();return this.objs.clear(),ot(this,i,!1),Y(this,H,xe).call(this),Promise.all(l)}cleanup(l=!1){ot(this,i,!0);const w=Y(this,f,ue).call(this,!1);return l&&w&&this._stats&&(this._stats=new _display_utils.StatTimer),w}_startRenderPage(l,w){var $,V;const g=this._intentStates.get(w);g&&(($=this._stats)==null||$.timeEnd("Page Request"),(V=g.displayReadyCapability)==null||V.resolve(l))}_renderPageChunk(l,w){for(let g=0,$=l.length;g<$;g++)w.operatorList.fnArray.push(l.fnArray[g]),w.operatorList.argsArray.push(l.argsArray[g]);w.operatorList.lastChunk=l.lastChunk,w.operatorList.separateAnnots=l.separateAnnots;for(const g of w.renderTasks)g.operatorListChanged();l.lastChunk&&Y(this,f,ue).call(this,!0)}_pumpOperatorList({renderingIntent:l,cacheKey:w,annotationStorageSerializable:g}){const{map:$,transfers:V}=g,X=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:l,cacheKey:w,annotationStorage:$},V).getReader(),tt=this._intentStates.get(w);tt.streamReader=X;const at=()=>{X.read().then(({value:G,done:ut})=>{if(ut){tt.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(G,tt),at())},G=>{if(tt.streamReader=null,!this._transport.destroyed){if(tt.operatorList){tt.operatorList.lastChunk=!0;for(const ut of tt.renderTasks)ut.operatorListChanged();Y(this,f,ue).call(this,!0)}if(tt.displayReadyCapability)tt.displayReadyCapability.reject(G);else if(tt.opListReadCapability)tt.opListReadCapability.reject(G);else throw G}})};at()}_abortOperatorList({intentState:l,reason:w,force:g=!1}){if(l.streamReader){if(l.streamReaderCancelTimeout&&(clearTimeout(l.streamReaderCancelTimeout),l.streamReaderCancelTimeout=null),!g){if(l.renderTasks.size>0)return;if(w instanceof _display_utils.RenderingCancelledException){let $=RENDERING_CANCELLED_TIMEOUT;w.extraDelay>0&&w.extraDelay<1e3&&($+=w.extraDelay),l.streamReaderCancelTimeout=setTimeout(()=>{l.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:l,reason:w,force:!0})},$);return}}if(l.streamReader.cancel(new _util.AbortException(w.message)).catch(()=>{}),l.streamReader=null,!this._transport.destroyed){for(const[$,V]of this._intentStates)if(V===l){this._intentStates.delete($);break}this.cleanup()}}}get stats(){return this._stats}}L=new WeakMap,i=new WeakMap,f=new WeakSet,ue=function(l=!1){if(Y(this,H,xe).call(this),!t(this,i)||this.destroyed)return!1;if(l)return ot(this,L,setTimeout(()=>{ot(this,L,null),Y(this,f,ue).call(this,!1)},DELAYED_CLEANUP_TIMEOUT)),!1;for(const{renderTasks:w,operatorList:g}of this._intentStates.values())if(w.size>0||!g.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),ot(this,i,!1),!0},H=new WeakSet,xe=function(){t(this,L)&&(clearTimeout(t(this,L)),ot(this,L,null))},exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){W(this,F,new Set);W(this,R,Promise.resolve())}postMessage(l,w){const g={data:structuredClone(l,w?{transfer:w}:null)};t(this,R).then(()=>{for(const $ of t(this,F))$.call(this,g)})}addEventListener(l,w){t(this,F).add(w)}removeEventListener(l,w){t(this,F).delete(w)}terminate(){t(this,F).clear()}}F=new WeakMap,R=new WeakMap,exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_util.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const b=(m=document==null?void 0:document.currentScript)==null?void 0:m.src;b&&(PDFWorkerUtil.fallbackWorkerSrc=b.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(b,l){let w;try{if(w=new URL(b),!w.origin||w.origin==="null")return!1}catch($){return!1}const g=new URL(l,w);return w.origin===g.origin},PDFWorkerUtil.createCDNWrapper=function(b){const l='importScripts("'.concat(b,'");');return URL.createObjectURL(new Blob([l]))}}const _PDFWorker=class _PDFWorker{constructor({name:b=null,port:l=null,verbosity:w=(0,_util.getVerbosityLevel)()}={}){var g;if(this.name=b,this.destroyed=!1,this.verbosity=w,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,l){if((g=t(_PDFWorker,I))!=null&&g.has(l))throw new Error("Cannot use more than one PDFWorker per port.");(t(_PDFWorker,I)||ot(_PDFWorker,I,new WeakMap)).set(l,this),this._initializeFromPort(l);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(b){this._port=b,this._messageHandler=new _message_handler.MessageHandler("main","worker",b),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:b}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,b)||(b=PDFWorkerUtil.createCDNWrapper(new URL(b,window.location).href));const l=new Worker(b),w=new _message_handler.MessageHandler("main","worker",l),g=()=>{l.removeEventListener("error",$),w.destroy(),l.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},$=()=>{this._webWorker||g()};l.addEventListener("error",$),w.on("test",S=>{if(l.removeEventListener("error",$),this.destroyed){g();return}S?(this._messageHandler=w,this._port=l,this._webWorker=l,this._readyCapability.resolve(),w.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),w.destroy(),l.terminate())}),w.on("ready",S=>{if(l.removeEventListener("error",$),this.destroyed){g();return}try{V()}catch(X){this._setupFakeWorker()}});const V=()=>{const S=new Uint8Array;w.send("test",S,[S.buffer])};V();return}catch(l){(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(b=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const l=new LoopbackPort;this._port=l;const w="fake".concat(PDFWorkerUtil.fakeWorkerId++),g=new _message_handler.MessageHandler(w+"_worker",w,l);b.setup(g,l);const $=new _message_handler.MessageHandler(w,w+"_worker",l);this._messageHandler=$,this._readyCapability.resolve(),$.send("configure",{verbosity:this.verbosity})}).catch(b=>{this._readyCapability.reject(new Error('Setting up fake worker failed: "'.concat(b.message,'".')))})}destroy(){var b;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(b=t(_PDFWorker,I))==null||b.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(b){var w;if(!(b!=null&&b.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const l=(w=t(this,I))==null?void 0:w.get(b.port);if(l){if(l._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return l}return new _PDFWorker(b)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _util.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var b;try{return((b=globalThis.pdfjsWorker)==null?void 0:b.WorkerMessageHandler)||null}catch(l){return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_util.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};I=new WeakMap,W(_PDFWorker,I,void 0);let PDFWorker=_PDFWorker;exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(l,w,g,$,V){W(this,p);W(this,N,new Map);W(this,P,new Map);W(this,E,new Map);W(this,v,null);this.messageHandler=l,this.loadingTask=w,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:$.ownerDocument,styleElement:$.styleElement}),this._params=$,this.canvasFactory=V.canvasFactory,this.filterFactory=V.filterFactory,this.cMapReaderFactory=V.cMapReaderFactory,this.standardFontDataFactory=V.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=g,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(l,w=_util.AnnotationMode.ENABLE,g=null,$=!1){let V=_util.RenderingIntentFlag.DISPLAY,S=_annotation_storage.SerializableEmpty;switch(l){case"any":V=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":V=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)("getRenderingIntent - invalid intent: ".concat(l))}switch(w){case _util.AnnotationMode.DISABLE:V+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:V+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:V+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,S=(V&_util.RenderingIntentFlag.PRINT&&g instanceof _annotation_storage.PrintAnnotationStorage?g:this.annotationStorage).serializable;break;default:(0,_util.warn)("getRenderingIntent - invalid annotationMode: ".concat(w))}return $&&(V+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:V,cacheKey:"".concat(V,"_").concat(S.hash),annotationStorageSerializable:S}}destroy(){var g;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,(g=t(this,v))==null||g.reject(new Error("Worker was destroyed during onPassword callback"));const l=[];for(const $ of t(this,P).values())l.push($._destroy());t(this,P).clear(),t(this,E).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const w=this.messageHandler.sendWithPromise("Terminate",null);return l.push(w),Promise.all(l).then(()=>{var $;this.commonObjs.clear(),this.fontLoader.clear(),t(this,N).clear(),this.filterFactory.destroy(),($=this._networkStream)==null||$.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:l,loadingTask:w}=this;l.on("GetReader",(g,$)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=V=>{this._lastProgress={loaded:V.loaded,total:V.total}},$.onPull=()=>{this._fullReader.read().then(function({value:V,done:S}){if(S){$.close();return}(0,_util.assert)(V instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),$.enqueue(new Uint8Array(V),1,[V])}).catch(V=>{$.error(V)})},$.onCancel=V=>{this._fullReader.cancel(V),$.ready.catch(S=>{if(!this.destroyed)throw S})}}),l.on("ReaderHeadersReady",g=>{const $=new _util.PromiseCapability,V=this._fullReader;return V.headersReady.then(()=>{var S;(!V.isStreamingSupported||!V.isRangeSupported)&&(this._lastProgress&&((S=w.onProgress)==null||S.call(w,this._lastProgress)),V.onProgress=X=>{var tt;(tt=w.onProgress)==null||tt.call(w,{loaded:X.loaded,total:X.total})}),$.resolve({isStreamingSupported:V.isStreamingSupported,isRangeSupported:V.isRangeSupported,contentLength:V.contentLength})},$.reject),$.promise}),l.on("GetRangeReader",(g,$)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const V=this._networkStream.getRangeReader(g.begin,g.end);if(!V){$.close();return}$.onPull=()=>{V.read().then(function({value:S,done:X}){if(X){$.close();return}(0,_util.assert)(S instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),$.enqueue(new Uint8Array(S),1,[S])}).catch(S=>{$.error(S)})},$.onCancel=S=>{V.cancel(S),$.ready.catch(X=>{if(!this.destroyed)throw X})}}),l.on("GetDoc",({pdfInfo:g})=>{this._numPages=g.numPages,this._htmlForXfa=g.htmlForXfa,delete g.htmlForXfa,w._capability.resolve(new PDFDocumentProxy(g,this))}),l.on("DocException",function(g){let $;switch(g.name){case"PasswordException":$=new _util.PasswordException(g.message,g.code);break;case"InvalidPDFException":$=new _util.InvalidPDFException(g.message);break;case"MissingPDFException":$=new _util.MissingPDFException(g.message);break;case"UnexpectedResponseException":$=new _util.UnexpectedResponseException(g.message,g.status);break;case"UnknownErrorException":$=new _util.UnknownErrorException(g.message,g.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}w._capability.reject($)}),l.on("PasswordRequest",g=>{if(ot(this,v,new _util.PromiseCapability),w.onPassword){const $=V=>{V instanceof Error?t(this,v).reject(V):t(this,v).resolve({password:V})};try{w.onPassword($,g.code)}catch(V){t(this,v).reject(V)}}else t(this,v).reject(new _util.PasswordException(g.message,g.code));return t(this,v).promise}),l.on("DataLoaded",g=>{var $;($=w.onProgress)==null||$.call(w,{loaded:g.length,total:g.length}),this.downloadInfoCapability.resolve(g)}),l.on("StartRenderPage",g=>{if(this.destroyed)return;t(this,P).get(g.pageIndex)._startRenderPage(g.transparency,g.cacheKey)}),l.on("commonobj",([g,$,V])=>{var S;if(!this.destroyed&&!this.commonObjs.has(g))switch($){case"Font":const X=this._params;if("error"in V){const G=V.error;(0,_util.warn)("Error during font loading: ".concat(G)),this.commonObjs.resolve(g,G);break}const tt=X.pdfBug&&((S=globalThis.FontInspector)!=null&&S.enabled)?(G,ut)=>globalThis.FontInspector.fontAdded(G,ut):null,at=new _font_loader.FontFaceObject(V,{isEvalSupported:X.isEvalSupported,disableFontFace:X.disableFontFace,ignoreErrors:X.ignoreErrors,inspectFont:tt});this.fontLoader.bind(at).catch(G=>l.sendWithPromise("FontFallback",{id:g})).finally(()=>{!X.fontExtraProperties&&at.data&&(at.data=null),this.commonObjs.resolve(g,at)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(g,V);break;default:throw new Error("Got unknown common object type ".concat($))}}),l.on("obj",([g,$,V,S])=>{var tt;if(this.destroyed)return;const X=t(this,P).get($);if(!X.objs.has(g))switch(V){case"Image":if(X.objs.resolve(g,S),S){let at;if(S.bitmap){const{width:G,height:ut}=S;at=G*ut*4}else at=((tt=S.data)==null?void 0:tt.length)||0;at>_util.MAX_IMAGE_SIZE_TO_CACHE&&(X._maybeCleanupAfterRender=!0)}break;case"Pattern":X.objs.resolve(g,S);break;default:throw new Error("Got unknown object type ".concat(V))}}),l.on("DocProgress",g=>{var $;this.destroyed||($=w.onProgress)==null||$.call(w,{loaded:g.loaded,total:g.total})}),l.on("FetchBuiltInCMap",g=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(g):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),l.on("FetchStandardFontData",g=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(g):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var g,$;this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:l,transfers:w}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:l,filename:($=(g=this._fullReader)==null?void 0:g.filename)!=null?$:null},w).finally(()=>{this.annotationStorage.resetModified()})}getPage(l){if(!Number.isInteger(l)||l<=0||l>this._numPages)return Promise.reject(new Error("Invalid page request."));const w=l-1,g=t(this,E).get(w);if(g)return g;const $=this.messageHandler.sendWithPromise("GetPage",{pageIndex:w}).then(V=>{if(this.destroyed)throw new Error("Transport destroyed");const S=new PDFPageProxy(w,V,this,this._params.pdfBug);return t(this,P).set(w,S),S});return t(this,E).set(w,$),$}getPageIndex(l){return typeof l!="object"||l===null||!Number.isInteger(l.num)||l.num<0||!Number.isInteger(l.gen)||l.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:l.num,gen:l.gen})}getAnnotations(l,w){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:l,intent:w})}getFieldObjects(){return Y(this,p,we).call(this,"GetFieldObjects")}hasJSActions(){return Y(this,p,we).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(l){return typeof l!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:l})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return Y(this,p,we).call(this,"GetDocJSActions")}getPageJSActions(l){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:l})}getStructTree(l){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:l})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(l=>new _optional_content_config.OptionalContentConfig(l))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const l="GetMetadata",w=t(this,N).get(l);if(w)return w;const g=this.messageHandler.sendWithPromise(l,null).then($=>{var V,S,X,tt;return{info:$[0],metadata:$[1]?new _metadata.Metadata($[1]):null,contentDispositionFilename:(S=(V=this._fullReader)==null?void 0:V.filename)!=null?S:null,contentLength:(tt=(X=this._fullReader)==null?void 0:X.contentLength)!=null?tt:null}});return t(this,N).set(l,g),g}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(l=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const w of t(this,P).values())if(!w.cleanup())throw new Error("startCleanup: Page ".concat(w.pageNumber," is currently rendering."));this.commonObjs.clear(),l||this.fontLoader.clear(),t(this,N).clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:l,enableXfa:w}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:l,enableXfa:w})}}N=new WeakMap,P=new WeakMap,E=new WeakMap,v=new WeakMap,p=new WeakSet,we=function(l,w=null){const g=t(this,N).get(l);if(g)return g;const $=this.messageHandler.sendWithPromise(l,w);return t(this,N).set(l,$),$};class PDFObjects{constructor(){W(this,x);W(this,C,Object.create(null))}get(l,w=null){if(w){const $=Y(this,x,Ue).call(this,l);return $.capability.promise.then(()=>w($.data)),null}const g=t(this,C)[l];if(!(g!=null&&g.capability.settled))throw new Error("Requesting object that isn't resolved yet ".concat(l,"."));return g.data}has(l){const w=t(this,C)[l];return(w==null?void 0:w.capability.settled)||!1}resolve(l,w=null){const g=Y(this,x,Ue).call(this,l);g.data=w,g.capability.resolve()}clear(){var l;for(const w in t(this,C)){const{data:g}=t(this,C)[w];(l=g==null?void 0:g.bitmap)==null||l.close()}ot(this,C,Object.create(null))}}C=new WeakMap,x=new WeakSet,Ue=function(l){var w;return(w=t(this,C))[l]||(w[l]={capability:new _util.PromiseCapability,data:null})};class RenderTask{constructor(l){W(this,c,null);ot(this,c,l),this.onContinue=null}get promise(){return t(this,c).capability.promise}cancel(l=0){t(this,c).cancel(null,l)}get separateAnnots(){const{separateAnnots:l}=t(this,c).operatorList;if(!l)return!1;const{annotationCanvasMap:w}=t(this,c);return l.form||l.canvas&&(w==null?void 0:w.size)>0}}c=new WeakMap,exports.RenderTask=RenderTask;const M=class M{constructor({callback:l,params:w,objs:g,commonObjs:$,annotationCanvasMap:V,operatorList:S,pageIndex:X,canvasFactory:tt,filterFactory:at,useRequestAnimationFrame:G=!1,pdfBug:ut=!1,pageColors:yt=null}){this.callback=l,this.params=w,this.objs=g,this.commonObjs=$,this.annotationCanvasMap=V,this.operatorListIdx=null,this.operatorList=S,this._pageIndex=X,this.canvasFactory=tt,this.filterFactory=at,this._pdfBug=ut,this.pageColors=yt,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=G===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=w.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:l=!1,optionalContentConfig:w}){var X,tt;if(this.cancelled)return;if(this._canvas){if(t(M,d).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");t(M,d).add(this._canvas)}this._pdfBug&&((X=globalThis.StepperManager)!=null&&X.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:g,viewport:$,transform:V,background:S}=this.params;this.gfx=new _canvas.CanvasGraphics(g,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:w},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:V,viewport:$,transparency:l,background:S}),this.operatorListIdx=0,this.graphicsReady=!0,(tt=this.graphicsReadyCallback)==null||tt.call(this)}cancel(l=null,w=0){var g;this.running=!1,this.cancelled=!0,(g=this.gfx)==null||g.endDrawing(),t(M,d).delete(this._canvas),this.callback(l||new _display_utils.RenderingCancelledException("Rendering cancelled, page ".concat(this._pageIndex+1),w))}operatorListChanged(){var l;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(l=this.stepper)==null||l.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),t(M,d).delete(this._canvas),this.callback())))}};d=new WeakMap,W(M,d,new WeakSet);let InternalRenderTask=M;const version="3.11.174";exports.version=version;const build="ce8716743";exports.build=build},(D,n,L)=>{var R,m,I,En,P;Object.defineProperty(n,"__esModule",{value:!0}),n.SerializableEmpty=n.PrintAnnotationStorage=n.AnnotationStorage=void 0;var i=L(1),f=L(4),z=L(8);const H=Object.freeze({map:null,hash:"",transfers:void 0});n.SerializableEmpty=H;class ct{constructor(){W(this,I);W(this,R,!1);W(this,m,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(v,p){const y=t(this,m).get(v);return y===void 0?p:Object.assign(p,y)}getRawValue(v){return t(this,m).get(v)}remove(v){if(t(this,m).delete(v),t(this,m).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const p of t(this,m).values())if(p instanceof f.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(v,p){const y=t(this,m).get(v);let C=!1;if(y!==void 0)for(const[x,A]of Object.entries(p))y[x]!==A&&(C=!0,y[x]=A);else C=!0,t(this,m).set(v,p);C&&Y(this,I,En).call(this),p instanceof f.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(p.constructor._type)}has(v){return t(this,m).has(v)}getAll(){return t(this,m).size>0?(0,i.objectFromMap)(t(this,m)):null}setAll(v){for(const[p,y]of Object.entries(v))this.setValue(p,y)}get size(){return t(this,m).size}resetModified(){t(this,R)&&(ot(this,R,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new F(this)}get serializable(){if(t(this,m).size===0)return H;const v=new Map,p=new z.MurmurHash3_64,y=[],C=Object.create(null);let x=!1;for(const[A,c]of t(this,m)){const d=c instanceof f.AnnotationEditor?c.serialize(!1,C):c;d&&(v.set(A,d),p.update("".concat(A,":").concat(JSON.stringify(d))),x||(x=!!d.bitmap))}if(x)for(const A of v.values())A.bitmap&&y.push(A.bitmap);return v.size>0?{map:v,hash:p.hexdigest(),transfers:y}:H}}R=new WeakMap,m=new WeakMap,I=new WeakSet,En=function(){t(this,R)||(ot(this,R,!0),typeof this.onSetModified=="function"&&this.onSetModified())},n.AnnotationStorage=ct;class F extends ct{constructor(p){super();W(this,P,void 0);const{map:y,hash:C,transfers:x}=p.serializable,A=structuredClone(y,x?{transfer:x}:null);ot(this,P,{map:A,hash:C,transfers:x})}get print(){(0,i.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return t(this,P)}}P=new WeakMap,n.PrintAnnotationStorage=F},(D,n,L)=>{var F,R,m,I,N,P,E,v,p,y,C,x,A,c,d,We,b,He,w,$e,$,Ge,S,Sn,tt,Tn,G,xn,yt,Ve,wt,wn;Object.defineProperty(n,"__esModule",{value:!0}),n.AnnotationEditor=void 0;var i=L(5),f=L(1),z=L(6);const s=class s{constructor(a){W(this,d);W(this,b);W(this,$);W(this,S);W(this,tt);W(this,G);W(this,yt);W(this,wt);W(this,F,"");W(this,R,!1);W(this,m,null);W(this,I,null);W(this,N,null);W(this,P,!1);W(this,E,null);W(this,v,this.focusin.bind(this));W(this,p,this.focusout.bind(this));W(this,y,!1);W(this,C,!1);W(this,x,!1);se(this,"_initialOptions",Object.create(null));se(this,"_uiManager",null);se(this,"_focusEventsAllowed",!0);se(this,"_l10nPromise",null);W(this,A,!1);W(this,c,s._zIndex++);this.constructor===s&&(0,f.unreachable)("Cannot initialize AnnotationEditor."),this.parent=a.parent,this.id=a.id,this.width=this.height=null,this.pageIndex=a.parent.pageIndex,this.name=a.name,this.div=null,this._uiManager=a.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=a.isCentered,this._structTreeParentId=null;const{rotation:h,rawDims:{pageWidth:u,pageHeight:T,pageX:O,pageY:U}}=this.parent.viewport;this.rotation=h,this.pageRotation=(360+h-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[u,T],this.pageTranslation=[O,U];const[rt,nt]=this.parentDimensions;this.x=a.x/rt,this.y=a.y/nt,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,f.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(a){const h=new ct({id:a.parent.getNextId(),parent:a.parent,uiManager:a._uiManager});h.annotationElementId=a.annotationElementId,h.deleted=!0,h._uiManager.addToAnnotationStorage(h)}static initialize(a,h=null){if(s._l10nPromise||(s._l10nPromise=new Map(["editor_alt_text_button_label","editor_alt_text_edit_button_label","editor_alt_text_decorative_tooltip"].map(T=>[T,a.get(T)]))),h!=null&&h.strings)for(const T of h.strings)s._l10nPromise.set(T,a.get(T));if(s._borderLineWidth!==-1)return;const u=getComputedStyle(document.documentElement);s._borderLineWidth=parseFloat(u.getPropertyValue("--outline-width"))||0}static updateDefaultParams(a,h){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(a){return!1}static paste(a,h){(0,f.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return t(this,A)}set _isDraggable(a){var h;ot(this,A,a),(h=this.div)==null||h.classList.toggle("draggable",a)}center(){const[a,h]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*h/(a*2),this.y+=this.width*a/(h*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*h/(a*2),this.y-=this.width*a/(h*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(a){this._uiManager.addCommands(a)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=t(this,c)}setParent(a){a!==null&&(this.pageIndex=a.pageIndex,this.pageDimensions=a.pageDimensions),this.parent=a}focusin(a){this._focusEventsAllowed&&(t(this,y)?ot(this,y,!1):this.parent.setSelected(this))}focusout(a){var u;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const h=a.relatedTarget;h!=null&&h.closest("#".concat(this.id))||(a.preventDefault(),(u=this.parent)!=null&&u.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(a,h,u,T){const[O,U]=this.parentDimensions;[u,T]=this.screenToPageTranslation(u,T),this.x=(a+u)/O,this.y=(h+T)/U,this.fixAndSetPosition()}translate(a,h){Y(this,d,We).call(this,this.parentDimensions,a,h)}translateInPage(a,h){Y(this,d,We).call(this,this.pageDimensions,a,h),this.div.scrollIntoView({block:"nearest"})}drag(a,h){const[u,T]=this.parentDimensions;if(this.x+=a/u,this.y+=h/T,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:lt,y:pt}=this.div.getBoundingClientRect();this.parent.findNewParent(this,lt,pt)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:O,y:U}=this;const[rt,nt]=Y(this,b,He).call(this);O+=rt,U+=nt,this.div.style.left="".concat((100*O).toFixed(2),"%"),this.div.style.top="".concat((100*U).toFixed(2),"%"),this.div.scrollIntoView({block:"nearest"})}fixAndSetPosition(){const[a,h]=this.pageDimensions;let{x:u,y:T,width:O,height:U}=this;switch(O*=a,U*=h,u*=a,T*=h,this.rotation){case 0:u=Math.max(0,Math.min(a-O,u)),T=Math.max(0,Math.min(h-U,T));break;case 90:u=Math.max(0,Math.min(a-U,u)),T=Math.min(h,Math.max(O,T));break;case 180:u=Math.min(a,Math.max(O,u)),T=Math.min(h,Math.max(U,T));break;case 270:u=Math.min(a,Math.max(U,u)),T=Math.max(0,Math.min(h-O,T));break}this.x=u/=a,this.y=T/=h;const[rt,nt]=Y(this,b,He).call(this);u+=rt,T+=nt;const{style:lt}=this.div;lt.left="".concat((100*u).toFixed(2),"%"),lt.top="".concat((100*T).toFixed(2),"%"),this.moveInDOM()}screenToPageTranslation(a,h){var u;return Y(u=s,w,$e).call(u,a,h,this.parentRotation)}pageTranslationToScreen(a,h){var u;return Y(u=s,w,$e).call(u,a,h,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:a,pageDimensions:[h,u]}=this,T=h*a,O=u*a;return f.FeatureTest.isCSSRoundSupported?[Math.round(T),Math.round(O)]:[T,O]}setDims(a,h){var O;const[u,T]=this.parentDimensions;this.div.style.width="".concat((100*a/u).toFixed(2),"%"),t(this,P)||(this.div.style.height="".concat((100*h/T).toFixed(2),"%")),(O=t(this,m))==null||O.classList.toggle("small",a<s.SMALL_EDITOR_SIZE||h<s.SMALL_EDITOR_SIZE)}fixDims(){const{style:a}=this.div,{height:h,width:u}=a,T=u.endsWith("%"),O=!t(this,P)&&h.endsWith("%");if(T&&O)return;const[U,rt]=this.parentDimensions;T||(a.width="".concat((100*parseFloat(u)/U).toFixed(2),"%")),!t(this,P)&&!O&&(a.height="".concat((100*parseFloat(h)/rt).toFixed(2),"%"))}getInitialTranslation(){return[0,0]}async addAltTextButton(){if(t(this,m))return;const a=ot(this,m,document.createElement("button"));a.className="altText";const h=await s._l10nPromise.get("editor_alt_text_button_label");a.textContent=h,a.setAttribute("aria-label",h),a.tabIndex="0",a.addEventListener("contextmenu",z.noContextMenu),a.addEventListener("pointerdown",u=>u.stopPropagation()),a.addEventListener("click",u=>{u.preventDefault(),this._uiManager.editAltText(this)},{capture:!0}),a.addEventListener("keydown",u=>{u.target===a&&u.key==="Enter"&&(u.preventDefault(),this._uiManager.editAltText(this))}),Y(this,yt,Ve).call(this),this.div.append(a),s.SMALL_EDITOR_SIZE||(s.SMALL_EDITOR_SIZE=Math.min(128,Math.round(a.getBoundingClientRect().width*1.4)))}getClientDimensions(){return this.div.getBoundingClientRect()}get altTextData(){return{altText:t(this,F),decorative:t(this,R)}}set altTextData({altText:a,decorative:h}){t(this,F)===a&&t(this,R)===h||(ot(this,F,a),ot(this,R,h),Y(this,yt,Ve).call(this))}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",t(this,v)),this.div.addEventListener("focusout",t(this,p));const[a,h]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth="".concat((100*h/a).toFixed(2),"%"),this.div.style.maxHeight="".concat((100*a/h).toFixed(2),"%"));const[u,T]=this.getInitialTranslation();return this.translate(u,T),(0,i.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(a){const{isMac:h}=f.FeatureTest.platform;if(a.button!==0||a.ctrlKey&&h){a.preventDefault();return}ot(this,y,!0),Y(this,wt,wn).call(this,a)}moveInDOM(){var a;(a=this.parent)==null||a.moveEditorInDOM(this)}_setParentAndPosition(a,h,u){a.changeParent(this),this.x=h,this.y=u,this.fixAndSetPosition()}getRect(a,h){const u=this.parentScale,[T,O]=this.pageDimensions,[U,rt]=this.pageTranslation,nt=a/u,lt=h/u,pt=this.x*T,mt=this.y*O,dt=this.width*T,kt=this.height*O;switch(this.rotation){case 0:return[pt+nt+U,O-mt-lt-kt+rt,pt+nt+dt+U,O-mt-lt+rt];case 90:return[pt+lt+U,O-mt+nt+rt,pt+lt+kt+U,O-mt+nt+dt+rt];case 180:return[pt-nt-dt+U,O-mt+lt+rt,pt-nt+U,O-mt+lt+kt+rt];case 270:return[pt-lt-kt+U,O-mt-nt-dt+rt,pt-lt+U,O-mt-nt+rt];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(a,h){const[u,T,O,U]=a,rt=O-u,nt=U-T;switch(this.rotation){case 0:return[u,h-U,rt,nt];case 90:return[u,h-T,nt,rt];case 180:return[O,h-T,rt,nt];case 270:return[O,h-U,nt,rt];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){ot(this,x,!0)}disableEditMode(){ot(this,x,!1)}isInEditMode(){return t(this,x)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var a,h;(a=this.div)==null||a.addEventListener("focusin",t(this,v)),(h=this.div)==null||h.addEventListener("focusout",t(this,p))}serialize(a=!1,h=null){(0,f.unreachable)("An editor must be serializable")}static deserialize(a,h,u){const T=new this.prototype.constructor({parent:h,id:h.getNextId(),uiManager:u});T.rotation=a.rotation;const[O,U]=T.pageDimensions,[rt,nt,lt,pt]=T.getRectInCurrentCoords(a.rect,U);return T.x=rt/O,T.y=nt/U,T.width=lt/O,T.height=pt/U,T}remove(){var a;this.div.removeEventListener("focusin",t(this,v)),this.div.removeEventListener("focusout",t(this,p)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),(a=t(this,m))==null||a.remove(),ot(this,m,null),ot(this,I,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(Y(this,S,Sn).call(this),t(this,E).classList.remove("hidden"))}select(){var a;this.makeResizable(),(a=this.div)==null||a.classList.add("selectedEditor")}unselect(){var a,h,u;(a=t(this,E))==null||a.classList.add("hidden"),(h=this.div)==null||h.classList.remove("selectedEditor"),(u=this.div)!=null&&u.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus()}updateParams(a,h){}disableEditing(){t(this,m)&&(t(this,m).hidden=!0)}enableEditing(){t(this,m)&&(t(this,m).hidden=!1)}enterInEditMode(){}get contentDiv(){return this.div}get isEditing(){return t(this,C)}set isEditing(a){ot(this,C,a),this.parent&&(a?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(a,h){ot(this,P,!0);const u=a/h,{style:T}=this.div;T.aspectRatio=u,T.height="auto"}static get MIN_SIZE(){return 16}};F=new WeakMap,R=new WeakMap,m=new WeakMap,I=new WeakMap,N=new WeakMap,P=new WeakMap,E=new WeakMap,v=new WeakMap,p=new WeakMap,y=new WeakMap,C=new WeakMap,x=new WeakMap,A=new WeakMap,c=new WeakMap,d=new WeakSet,We=function([a,h],u,T){[u,T]=this.screenToPageTranslation(u,T),this.x+=u/a,this.y+=T/h,this.fixAndSetPosition()},b=new WeakSet,He=function(){const[a,h]=this.parentDimensions,{_borderLineWidth:u}=s,T=u/a,O=u/h;switch(this.rotation){case 90:return[-T,O];case 180:return[T,O];case 270:return[T,-O];default:return[-T,-O]}},w=new WeakSet,$e=function(a,h,u){switch(u){case 90:return[h,-a];case 180:return[-a,-h];case 270:return[-h,a];default:return[a,h]}},$=new WeakSet,Ge=function(a){switch(a){case 90:{const[h,u]=this.pageDimensions;return[0,-h/u,u/h,0]}case 180:return[-1,0,0,-1];case 270:{const[h,u]=this.pageDimensions;return[0,h/u,-u/h,0]}default:return[1,0,0,1]}},S=new WeakSet,Sn=function(){if(t(this,E))return;ot(this,E,document.createElement("div")),t(this,E).classList.add("resizers");const a=["topLeft","topRight","bottomRight","bottomLeft"];this._willKeepAspectRatio||a.push("topMiddle","middleRight","bottomMiddle","middleLeft");for(const h of a){const u=document.createElement("div");t(this,E).append(u),u.classList.add("resizer",h),u.addEventListener("pointerdown",Y(this,tt,Tn).bind(this,h)),u.addEventListener("contextmenu",z.noContextMenu)}this.div.prepend(t(this,E))},tt=new WeakSet,Tn=function(a,h){h.preventDefault();const{isMac:u}=f.FeatureTest.platform;if(h.button!==0||h.ctrlKey&&u)return;const T=Y(this,G,xn).bind(this,a),O=this._isDraggable;this._isDraggable=!1;const U={passive:!0,capture:!0};window.addEventListener("pointermove",T,U);const rt=this.x,nt=this.y,lt=this.width,pt=this.height,mt=this.parent.div.style.cursor,dt=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(h.target).cursor;const kt=()=>{this._isDraggable=O,window.removeEventListener("pointerup",kt),window.removeEventListener("blur",kt),window.removeEventListener("pointermove",T,U),this.parent.div.style.cursor=mt,this.div.style.cursor=dt;const Nt=this.x,St=this.y,Ot=this.width,bt=this.height;Nt===rt&&St===nt&&Ot===lt&&bt===pt||this.addCommands({cmd:()=>{this.width=Ot,this.height=bt,this.x=Nt,this.y=St;const[it,st]=this.parentDimensions;this.setDims(it*Ot,st*bt),this.fixAndSetPosition()},undo:()=>{this.width=lt,this.height=pt,this.x=rt,this.y=nt;const[it,st]=this.parentDimensions;this.setDims(it*lt,st*pt),this.fixAndSetPosition()},mustExec:!0})};window.addEventListener("pointerup",kt),window.addEventListener("blur",kt)},G=new WeakSet,xn=function(a,h){const[u,T]=this.parentDimensions,O=this.x,U=this.y,rt=this.width,nt=this.height,lt=s.MIN_SIZE/u,pt=s.MIN_SIZE/T,mt=At=>Math.round(At*1e4)/1e4,dt=Y(this,$,Ge).call(this,this.rotation),kt=(At,vt)=>[dt[0]*At+dt[2]*vt,dt[1]*At+dt[3]*vt],Nt=Y(this,$,Ge).call(this,360-this.rotation),St=(At,vt)=>[Nt[0]*At+Nt[2]*vt,Nt[1]*At+Nt[3]*vt];let Ot,bt,it=!1,st=!1;switch(a){case"topLeft":it=!0,Ot=(At,vt)=>[0,0],bt=(At,vt)=>[At,vt];break;case"topMiddle":Ot=(At,vt)=>[At/2,0],bt=(At,vt)=>[At/2,vt];break;case"topRight":it=!0,Ot=(At,vt)=>[At,0],bt=(At,vt)=>[0,vt];break;case"middleRight":st=!0,Ot=(At,vt)=>[At,vt/2],bt=(At,vt)=>[0,vt/2];break;case"bottomRight":it=!0,Ot=(At,vt)=>[At,vt],bt=(At,vt)=>[0,0];break;case"bottomMiddle":Ot=(At,vt)=>[At/2,vt],bt=(At,vt)=>[At/2,0];break;case"bottomLeft":it=!0,Ot=(At,vt)=>[0,vt],bt=(At,vt)=>[At,0];break;case"middleLeft":st=!0,Ot=(At,vt)=>[0,vt/2],bt=(At,vt)=>[At,vt/2];break}const gt=Ot(rt,nt),Pt=bt(rt,nt);let Ct=kt(...Pt);const $t=mt(O+Ct[0]),Vt=mt(U+Ct[1]);let Ht=1,Yt=1,[zt,Gt]=this.screenToPageTranslation(h.movementX,h.movementY);if([zt,Gt]=St(zt/u,Gt/T),it){const At=Math.hypot(rt,nt);Ht=Yt=Math.max(Math.min(Math.hypot(Pt[0]-gt[0]-zt,Pt[1]-gt[1]-Gt)/At,1/rt,1/nt),lt/rt,pt/nt)}else st?Ht=Math.max(lt,Math.min(1,Math.abs(Pt[0]-gt[0]-zt)))/rt:Yt=Math.max(pt,Math.min(1,Math.abs(Pt[1]-gt[1]-Gt)))/nt;const Xt=mt(rt*Ht),ft=mt(nt*Yt);Ct=kt(...bt(Xt,ft));const et=$t-Ct[0],K=Vt-Ct[1];this.width=Xt,this.height=ft,this.x=et,this.y=K,this.setDims(u*Xt,T*ft),this.fixAndSetPosition()},yt=new WeakSet,Ve=async function(){var u;const a=t(this,m);if(!a)return;if(!t(this,F)&&!t(this,R)){a.classList.remove("done"),(u=t(this,I))==null||u.remove();return}s._l10nPromise.get("editor_alt_text_edit_button_label").then(T=>{a.setAttribute("aria-label",T)});let h=t(this,I);if(!h){ot(this,I,h=document.createElement("span")),h.className="tooltip",h.setAttribute("role","tooltip");const T=h.id="alt-text-tooltip-".concat(this.id);a.setAttribute("aria-describedby",T);const O=100;a.addEventListener("mouseenter",()=>{ot(this,N,setTimeout(()=>{ot(this,N,null),t(this,I).classList.add("show"),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"alt_text_tooltip"}}})},O))}),a.addEventListener("mouseleave",()=>{var U;clearTimeout(t(this,N)),ot(this,N,null),(U=t(this,I))==null||U.classList.remove("show")})}a.classList.add("done"),h.innerText=t(this,R)?await s._l10nPromise.get("editor_alt_text_decorative_tooltip"):t(this,F),h.parentNode||a.append(h)},wt=new WeakSet,wn=function(a){if(!this._isDraggable)return;const h=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let u,T;h&&(u={passive:!0,capture:!0},T=U=>{const[rt,nt]=this.screenToPageTranslation(U.movementX,U.movementY);this._uiManager.dragSelectedEditors(rt,nt)},window.addEventListener("pointermove",T,u));const O=()=>{if(window.removeEventListener("pointerup",O),window.removeEventListener("blur",O),h&&window.removeEventListener("pointermove",T,u),ot(this,y,!1),!this._uiManager.endDragSession()){const{isMac:U}=f.FeatureTest.platform;a.ctrlKey&&!U||a.shiftKey||a.metaKey&&U?this.parent.toggleSelected(this):this.parent.setSelected(this)}};window.addEventListener("pointerup",O),window.addEventListener("blur",O)},W(s,w),se(s,"_borderLineWidth",-1),se(s,"_colorManager",new i.ColorManager),se(s,"_zIndex",1),se(s,"SMALL_EDITOR_SIZE",0);let H=s;n.AnnotationEditor=H;class ct extends H{constructor(a){super(a),this.annotationElementId=a.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},(D,n,L)=>{var P,E,v,p,y,ze,A,c,d,M,b,Pn,g,$,V,S,X,tt,at,G,ut,yt,Tt,wt,k,s,o,a,h,u,T,O,U,rt,nt,lt,pt,mt,dt,kt,Nt,St,Ot,bt,it,st,gt,Cn,Ct,Xe,Vt,qe,Yt,Pe,Gt,Ye,ft,Ke,K,oe,vt,ye,ee,Rn,xt,kn,Ft,Je,Ut,_e,Et,Qe;Object.defineProperty(n,"__esModule",{value:!0}),n.KeyboardManager=n.CommandManager=n.ColorManager=n.AnnotationEditorUIManager=void 0,n.bindEvents=z,n.opacityToHex=H;var i=L(1),f=L(6);function z(j,e,_){for(const B of _)e.addEventListener(B,j[B].bind(j))}function H(j){return Math.round(Math.min(255,Math.max(1,255*j))).toString(16).padStart(2,"0")}class ct{constructor(){W(this,P,0)}getId(){return"".concat(i.AnnotationEditorPrefix).concat(be(this,P)._++)}}P=new WeakMap;const x=class x{constructor(){W(this,y);W(this,E,(0,i.getUuid)());W(this,v,0);W(this,p,null)}static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',B=new OffscreenCanvas(1,3).getContext("2d"),q=new Image;q.src=e;const J=q.decode().then(()=>(B.drawImage(q,0,0,1,1,0,0,1,3),new Uint32Array(B.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,i.shadow)(this,"_isSVGFittingCanvas",J)}async getFromFile(e){const{lastModified:_,name:B,size:q,type:J}=e;return Y(this,y,ze).call(this,"".concat(_,"_").concat(B,"_").concat(q,"_").concat(J),e)}async getFromUrl(e){return Y(this,y,ze).call(this,e,e)}async getFromId(e){t(this,p)||ot(this,p,new Map);const _=t(this,p).get(e);return _?_.bitmap?(_.refCounter+=1,_):_.file?this.getFromFile(_.file):this.getFromUrl(_.url):null}getSvgUrl(e){const _=t(this,p).get(e);return _!=null&&_.isSvg?_.svgUrl:null}deleteId(e){t(this,p)||ot(this,p,new Map);const _=t(this,p).get(e);_&&(_.refCounter-=1,_.refCounter===0&&(_.bitmap=null))}isValidId(e){return e.startsWith("image_".concat(t(this,E),"_"))}};E=new WeakMap,v=new WeakMap,p=new WeakMap,y=new WeakSet,ze=async function(e,_){t(this,p)||ot(this,p,new Map);let B=t(this,p).get(e);if(B===null)return null;if(B!=null&&B.bitmap)return B.refCounter+=1,B;try{B||(B={bitmap:null,id:"image_".concat(t(this,E),"_").concat(be(this,v)._++),refCounter:0,isSvg:!1});let q;if(typeof _=="string"){B.url=_;const J=await fetch(_);if(!J.ok)throw new Error(J.statusText);q=await J.blob()}else q=B.file=_;if(q.type==="image/svg+xml"){const J=x._isSVGFittingCanvas,ht=new FileReader,_t=new Image,Rt=new Promise((Mt,qt)=>{_t.onload=()=>{B.bitmap=_t,B.isSvg=!0,Mt()},ht.onload=async()=>{const Dt=B.svgUrl=ht.result;_t.src=await J?"".concat(Dt,"#svgView(preserveAspectRatio(none))"):Dt},_t.onerror=ht.onerror=qt});ht.readAsDataURL(q),await Rt}else B.bitmap=await createImageBitmap(q);B.refCounter=1}catch(q){console.error(q),B=null}return t(this,p).set(e,B),B&&t(this,p).set(B.id,B),B};let F=x;class R{constructor(e=128){W(this,A,[]);W(this,c,!1);W(this,d,void 0);W(this,M,-1);ot(this,d,e)}add({cmd:e,undo:_,mustExec:B,type:q=NaN,overwriteIfSameType:J=!1,keepUndo:ht=!1}){if(B&&e(),t(this,c))return;const _t={cmd:e,undo:_,type:q};if(t(this,M)===-1){t(this,A).length>0&&(t(this,A).length=0),ot(this,M,0),t(this,A).push(_t);return}if(J&&t(this,A)[t(this,M)].type===q){ht&&(_t.undo=t(this,A)[t(this,M)].undo),t(this,A)[t(this,M)]=_t;return}const Rt=t(this,M)+1;Rt===t(this,d)?t(this,A).splice(0,1):(ot(this,M,Rt),Rt<t(this,A).length&&t(this,A).splice(Rt)),t(this,A).push(_t)}undo(){t(this,M)!==-1&&(ot(this,c,!0),t(this,A)[t(this,M)].undo(),ot(this,c,!1),ot(this,M,t(this,M)-1))}redo(){t(this,M)<t(this,A).length-1&&(ot(this,M,t(this,M)+1),ot(this,c,!0),t(this,A)[t(this,M)].cmd(),ot(this,c,!1))}hasSomethingToUndo(){return t(this,M)!==-1}hasSomethingToRedo(){return t(this,M)<t(this,A).length-1}destroy(){ot(this,A,null)}}A=new WeakMap,c=new WeakMap,d=new WeakMap,M=new WeakMap,n.CommandManager=R;class m{constructor(e){W(this,b);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:_}=i.FeatureTest.platform;for(const[B,q,J={}]of e)for(const ht of B){const _t=ht.startsWith("mac+");_&&_t?(this.callbacks.set(ht.slice(4),{callback:q,options:J}),this.allKeys.add(ht.split("+").at(-1))):!_&&!_t&&(this.callbacks.set(ht,{callback:q,options:J}),this.allKeys.add(ht.split("+").at(-1)))}}exec(e,_){if(!this.allKeys.has(_.key))return;const B=this.callbacks.get(Y(this,b,Pn).call(this,_));if(!B)return;const{callback:q,options:{bubbles:J=!1,args:ht=[],checker:_t=null}}=B;_t&&!_t(e,_)||(q.bind(e,...ht)(),J||(_.stopPropagation(),_.preventDefault()))}}b=new WeakSet,Pn=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const _=this.buffer.join("+");return this.buffer.length=0,_},n.KeyboardManager=m;const w=class w{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return(0,f.getColorValues)(e),(0,i.shadow)(this,"_colors",e)}convert(e){const _=(0,f.getRGB)(e);if(!window.matchMedia("(forced-colors: active)").matches)return _;for(const[B,q]of this._colors)if(q.every((J,ht)=>J===_[ht]))return w._colorsMapping.get(B);return _}getHexCode(e){const _=this._colors.get(e);return _?i.Util.makeHexColor(..._):e}};se(w,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let I=w;n.ColorManager=I;const jt=class jt{constructor(e,_,B,q,J,ht){W(this,gt);W(this,Ct);W(this,Vt);W(this,Yt);W(this,Gt);W(this,ft);W(this,K);W(this,vt);W(this,ee);W(this,xt);W(this,Ft);W(this,Ut);W(this,Et);W(this,g,null);W(this,$,new Map);W(this,V,new Map);W(this,S,null);W(this,X,null);W(this,tt,new R);W(this,at,0);W(this,G,new Set);W(this,ut,null);W(this,yt,null);W(this,Tt,new Set);W(this,wt,null);W(this,k,new ct);W(this,s,!1);W(this,o,!1);W(this,a,null);W(this,h,i.AnnotationEditorType.NONE);W(this,u,new Set);W(this,T,null);W(this,O,this.blur.bind(this));W(this,U,this.focus.bind(this));W(this,rt,this.copy.bind(this));W(this,nt,this.cut.bind(this));W(this,lt,this.paste.bind(this));W(this,pt,this.keydown.bind(this));W(this,mt,this.onEditingAction.bind(this));W(this,dt,this.onPageChanging.bind(this));W(this,kt,this.onScaleChanging.bind(this));W(this,Nt,this.onRotationChanging.bind(this));W(this,St,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});W(this,Ot,[0,0]);W(this,bt,null);W(this,it,null);W(this,st,null);ot(this,it,e),ot(this,st,_),ot(this,S,B),this._eventBus=q,this._eventBus._on("editingaction",t(this,mt)),this._eventBus._on("pagechanging",t(this,dt)),this._eventBus._on("scalechanging",t(this,kt)),this._eventBus._on("rotationchanging",t(this,Nt)),ot(this,X,J.annotationStorage),ot(this,wt,J.filterFactory),ot(this,T,ht),this.viewParameters={realScale:f.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}static get _keyboardManager(){const e=jt.prototype,_=J=>{const{activeElement:ht}=document;return ht&&t(J,it).contains(ht)&&J.hasSomethingToControl()},B=this.TRANSLATE_SMALL,q=this.TRANSLATE_BIG;return(0,i.shadow)(this,"_keyboardManager",new m([[["ctrl+a","mac+meta+a"],e.selectAll],[["ctrl+z","mac+meta+z"],e.undo],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-B,0],checker:_}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-q,0],checker:_}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[B,0],checker:_}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[q,0],checker:_}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-B],checker:_}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-q],checker:_}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,B],checker:_}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,q],checker:_}]]))}destroy(){Y(this,Yt,Pe).call(this),Y(this,Ct,Xe).call(this),this._eventBus._off("editingaction",t(this,mt)),this._eventBus._off("pagechanging",t(this,dt)),this._eventBus._off("scalechanging",t(this,kt)),this._eventBus._off("rotationchanging",t(this,Nt));for(const e of t(this,V).values())e.destroy();t(this,V).clear(),t(this,$).clear(),t(this,Tt).clear(),ot(this,g,null),t(this,u).clear(),t(this,tt).destroy(),t(this,S).destroy()}get hcmFilter(){return(0,i.shadow)(this,"hcmFilter",t(this,T)?t(this,wt).addHCMFilter(t(this,T).foreground,t(this,T).background):"none")}get direction(){return(0,i.shadow)(this,"direction",getComputedStyle(t(this,it)).direction)}editAltText(e){var _;(_=t(this,S))==null||_.editAltText(this,e)}onPageChanging({pageNumber:e}){ot(this,at,e-1)}focusMainContainer(){t(this,it).focus()}findParent(e,_){for(const B of t(this,V).values()){const{x:q,y:J,width:ht,height:_t}=B.div.getBoundingClientRect();if(e>=q&&e<=q+ht&&_>=J&&_<=J+_t)return B}return null}disableUserSelect(e=!1){t(this,st).classList.toggle("noUserSelect",e)}addShouldRescale(e){t(this,Tt).add(e)}removeShouldRescale(e){t(this,Tt).delete(e)}onScaleChanging({scale:e}){this.commitOrRemove(),this.viewParameters.realScale=e*f.PixelsPerInch.PDF_TO_CSS_UNITS;for(const _ of t(this,Tt))_.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}addToAnnotationStorage(e){!e.isEmpty()&&t(this,X)&&!t(this,X).has(e.id)&&t(this,X).setValue(e.id,e)}blur(){if(!this.hasSelection)return;const{activeElement:e}=document;for(const _ of t(this,u))if(_.div.contains(e)){ot(this,a,[_,e]),_._focusEventsAllowed=!1;break}}focus(){if(!t(this,a))return;const[e,_]=t(this,a);ot(this,a,null),_.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0}),_.focus()}addEditListeners(){Y(this,Vt,qe).call(this),Y(this,Gt,Ye).call(this)}removeEditListeners(){Y(this,Yt,Pe).call(this),Y(this,ft,Ke).call(this)}copy(e){var B;if(e.preventDefault(),(B=t(this,g))==null||B.commitOrRemove(),!this.hasSelection)return;const _=[];for(const q of t(this,u)){const J=q.serialize(!0);J&&_.push(J)}_.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(_))}cut(e){this.copy(e),this.delete()}paste(e){e.preventDefault();const{clipboardData:_}=e;for(const J of _.items)for(const ht of t(this,yt))if(ht.isHandlingMimeForPasting(J.type)){ht.paste(J,this.currentLayer);return}let B=_.getData("application/pdfjs");if(!B)return;try{B=JSON.parse(B)}catch(J){(0,i.warn)('paste: "'.concat(J.message,'".'));return}if(!Array.isArray(B))return;this.unselectAll();const q=this.currentLayer;try{const J=[];for(const Rt of B){const Mt=q.deserialize(Rt);if(!Mt)return;J.push(Mt)}const ht=()=>{for(const Rt of J)Y(this,Ft,Je).call(this,Rt);Y(this,Et,Qe).call(this,J)},_t=()=>{for(const Rt of J)Rt.remove()};this.addCommands({cmd:ht,undo:_t,mustExec:!0})}catch(J){(0,i.warn)('paste: "'.concat(J.message,'".'))}}keydown(e){var _;(_=this.getActive())!=null&&_.shouldGetKeyboardEvents()||jt._keyboardManager.exec(this,e)}onEditingAction(e){["undo","redo","delete","selectAll"].includes(e.name)&&this[e.name]()}setEditingState(e){e?(Y(this,gt,Cn).call(this),Y(this,Vt,qe).call(this),Y(this,Gt,Ye).call(this),Y(this,K,oe).call(this,{isEditing:t(this,h)!==i.AnnotationEditorType.NONE,isEmpty:Y(this,Ut,_e).call(this),hasSomethingToUndo:t(this,tt).hasSomethingToUndo(),hasSomethingToRedo:t(this,tt).hasSomethingToRedo(),hasSelectedEditor:!1})):(Y(this,Ct,Xe).call(this),Y(this,Yt,Pe).call(this),Y(this,ft,Ke).call(this),Y(this,K,oe).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!t(this,yt)){ot(this,yt,e);for(const _ of t(this,yt))Y(this,vt,ye).call(this,_.defaultPropertiesToUpdate)}}getId(){return t(this,k).getId()}get currentLayer(){return t(this,V).get(t(this,at))}getLayer(e){return t(this,V).get(e)}get currentPageIndex(){return t(this,at)}addLayer(e){t(this,V).set(e.pageIndex,e),t(this,s)?e.enable():e.disable()}removeLayer(e){t(this,V).delete(e.pageIndex)}updateMode(e,_=null){if(t(this,h)!==e){if(ot(this,h,e),e===i.AnnotationEditorType.NONE){this.setEditingState(!1),Y(this,xt,kn).call(this);return}this.setEditingState(!0),Y(this,ee,Rn).call(this),this.unselectAll();for(const B of t(this,V).values())B.updateMode(e);if(_){for(const B of t(this,$).values())if(B.annotationElementId===_){this.setSelected(B),B.enterInEditMode();break}}}}updateToolbar(e){e!==t(this,h)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:e})}updateParams(e,_){if(t(this,yt)){if(e===i.AnnotationEditorParamsType.CREATE){this.currentLayer.addNewEditor(e);return}for(const B of t(this,u))B.updateParams(e,_);for(const B of t(this,yt))B.updateDefaultParams(e,_)}}enableWaiting(e=!1){if(t(this,o)!==e){ot(this,o,e);for(const _ of t(this,V).values())e?_.disableClick():_.enableClick(),_.div.classList.toggle("waiting",e)}}getEditors(e){const _=[];for(const B of t(this,$).values())B.pageIndex===e&&_.push(B);return _}getEditor(e){return t(this,$).get(e)}addEditor(e){t(this,$).set(e.id,e)}removeEditor(e){var _;t(this,$).delete(e.id),this.unselect(e),(!e.annotationElementId||!t(this,G).has(e.annotationElementId))&&((_=t(this,X))==null||_.remove(e.id))}addDeletedAnnotationElement(e){t(this,G).add(e.annotationElementId),e.deleted=!0}isDeletedAnnotationElement(e){return t(this,G).has(e)}removeDeletedAnnotationElement(e){t(this,G).delete(e.annotationElementId),e.deleted=!1}setActiveEditor(e){t(this,g)!==e&&(ot(this,g,e),e&&Y(this,vt,ye).call(this,e.propertiesToUpdate))}toggleSelected(e){if(t(this,u).has(e)){t(this,u).delete(e),e.unselect(),Y(this,K,oe).call(this,{hasSelectedEditor:this.hasSelection});return}t(this,u).add(e),e.select(),Y(this,vt,ye).call(this,e.propertiesToUpdate),Y(this,K,oe).call(this,{hasSelectedEditor:!0})}setSelected(e){for(const _ of t(this,u))_!==e&&_.unselect();t(this,u).clear(),t(this,u).add(e),e.select(),Y(this,vt,ye).call(this,e.propertiesToUpdate),Y(this,K,oe).call(this,{hasSelectedEditor:!0})}isSelected(e){return t(this,u).has(e)}unselect(e){e.unselect(),t(this,u).delete(e),Y(this,K,oe).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return t(this,u).size!==0}undo(){t(this,tt).undo(),Y(this,K,oe).call(this,{hasSomethingToUndo:t(this,tt).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:Y(this,Ut,_e).call(this)})}redo(){t(this,tt).redo(),Y(this,K,oe).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:t(this,tt).hasSomethingToRedo(),isEmpty:Y(this,Ut,_e).call(this)})}addCommands(e){t(this,tt).add(e),Y(this,K,oe).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:Y(this,Ut,_e).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const e=[...t(this,u)],_=()=>{for(const q of e)q.remove()},B=()=>{for(const q of e)Y(this,Ft,Je).call(this,q)};this.addCommands({cmd:_,undo:B,mustExec:!0})}commitOrRemove(){var e;(e=t(this,g))==null||e.commitOrRemove()}hasSomethingToControl(){return t(this,g)||this.hasSelection}selectAll(){for(const e of t(this,u))e.commit();Y(this,Et,Qe).call(this,t(this,$).values())}unselectAll(){if(t(this,g)){t(this,g).commitOrRemove();return}if(this.hasSelection){for(const e of t(this,u))e.unselect();t(this,u).clear(),Y(this,K,oe).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,_,B=!1){if(B||this.commitOrRemove(),!this.hasSelection)return;t(this,Ot)[0]+=e,t(this,Ot)[1]+=_;const[q,J]=t(this,Ot),ht=[...t(this,u)],_t=1e3;t(this,bt)&&clearTimeout(t(this,bt)),ot(this,bt,setTimeout(()=>{ot(this,bt,null),t(this,Ot)[0]=t(this,Ot)[1]=0,this.addCommands({cmd:()=>{for(const Rt of ht)t(this,$).has(Rt.id)&&Rt.translateInPage(q,J)},undo:()=>{for(const Rt of ht)t(this,$).has(Rt.id)&&Rt.translateInPage(-q,-J)},mustExec:!1})},_t));for(const Rt of ht)Rt.translateInPage(e,_)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),ot(this,ut,new Map);for(const e of t(this,u))t(this,ut).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!t(this,ut))return!1;this.disableUserSelect(!1);const e=t(this,ut);ot(this,ut,null);let _=!1;for(const[{x:q,y:J,pageIndex:ht},_t]of e)_t.newX=q,_t.newY=J,_t.newPageIndex=ht,_||(_=q!==_t.savedX||J!==_t.savedY||ht!==_t.savedPageIndex);if(!_)return!1;const B=(q,J,ht,_t)=>{if(t(this,$).has(q.id)){const Rt=t(this,V).get(_t);Rt?q._setParentAndPosition(Rt,J,ht):(q.pageIndex=_t,q.x=J,q.y=ht)}};return this.addCommands({cmd:()=>{for(const[q,{newX:J,newY:ht,newPageIndex:_t}]of e)B(q,J,ht,_t)},undo:()=>{for(const[q,{savedX:J,savedY:ht,savedPageIndex:_t}]of e)B(q,J,ht,_t)},mustExec:!0}),!0}dragSelectedEditors(e,_){if(t(this,ut))for(const B of t(this,ut).keys())B.drag(e,_)}rebuild(e){if(e.parent===null){const _=this.getLayer(e.pageIndex);_?(_.changeParent(e),_.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}isActive(e){return t(this,g)===e}getActive(){return t(this,g)}getMode(){return t(this,h)}get imageManager(){return(0,i.shadow)(this,"imageManager",new F)}};g=new WeakMap,$=new WeakMap,V=new WeakMap,S=new WeakMap,X=new WeakMap,tt=new WeakMap,at=new WeakMap,G=new WeakMap,ut=new WeakMap,yt=new WeakMap,Tt=new WeakMap,wt=new WeakMap,k=new WeakMap,s=new WeakMap,o=new WeakMap,a=new WeakMap,h=new WeakMap,u=new WeakMap,T=new WeakMap,O=new WeakMap,U=new WeakMap,rt=new WeakMap,nt=new WeakMap,lt=new WeakMap,pt=new WeakMap,mt=new WeakMap,dt=new WeakMap,kt=new WeakMap,Nt=new WeakMap,St=new WeakMap,Ot=new WeakMap,bt=new WeakMap,it=new WeakMap,st=new WeakMap,gt=new WeakSet,Cn=function(){window.addEventListener("focus",t(this,U)),window.addEventListener("blur",t(this,O))},Ct=new WeakSet,Xe=function(){window.removeEventListener("focus",t(this,U)),window.removeEventListener("blur",t(this,O))},Vt=new WeakSet,qe=function(){window.addEventListener("keydown",t(this,pt),{capture:!0})},Yt=new WeakSet,Pe=function(){window.removeEventListener("keydown",t(this,pt),{capture:!0})},Gt=new WeakSet,Ye=function(){document.addEventListener("copy",t(this,rt)),document.addEventListener("cut",t(this,nt)),document.addEventListener("paste",t(this,lt))},ft=new WeakSet,Ke=function(){document.removeEventListener("copy",t(this,rt)),document.removeEventListener("cut",t(this,nt)),document.removeEventListener("paste",t(this,lt))},K=new WeakSet,oe=function(e){Object.entries(e).some(([B,q])=>t(this,St)[B]!==q)&&this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(t(this,St),e)})},vt=new WeakSet,ye=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},ee=new WeakSet,Rn=function(){if(!t(this,s)){ot(this,s,!0);for(const e of t(this,V).values())e.enable()}},xt=new WeakSet,kn=function(){if(this.unselectAll(),t(this,s)){ot(this,s,!1);for(const e of t(this,V).values())e.disable()}},Ft=new WeakSet,Je=function(e){const _=t(this,V).get(e.pageIndex);_?_.addOrRebuild(e):this.addEditor(e)},Ut=new WeakSet,_e=function(){if(t(this,$).size===0)return!0;if(t(this,$).size===1)for(const e of t(this,$).values())return e.isEmpty();return!1},Et=new WeakSet,Qe=function(e){t(this,u).clear();for(const _ of e)_.isEmpty()||(t(this,u).add(_),_.select());Y(this,K,oe).call(this,{hasSelectedEditor:!0})},se(jt,"TRANSLATE_SMALL",1),se(jt,"TRANSLATE_BIG",10);let N=jt;n.AnnotationEditorUIManager=N},(D,n,L)=>{var at,G,ut,yt,Tt,wt,k,s,o,a,h,u,fe,O,pe,rt,Ze,lt,Ce,mt,Re,kt,Ae,St,ve;Object.defineProperty(n,"__esModule",{value:!0}),n.StatTimer=n.RenderingCancelledException=n.PixelsPerInch=n.PageViewport=n.PDFDateString=n.DOMStandardFontDataFactory=n.DOMSVGFactory=n.DOMFilterFactory=n.DOMCanvasFactory=n.DOMCMapReaderFactory=void 0,n.deprecated=M,n.getColorValues=$,n.getCurrentTransform=V,n.getCurrentTransformInverse=S,n.getFilenameFromUrl=y,n.getPdfFilenameFromUrl=C,n.getRGB=g,n.getXfaPageViewport=w,n.isDataScheme=v,n.isPdfFile=p,n.isValidFetchUrl=A,n.loadScript=d,n.noContextMenu=c,n.setLayerDimensions=X;var i=L(7),f=L(1);const z="http://www.w3.org/2000/svg",tt=class tt{};se(tt,"CSS",96),se(tt,"PDF",72),se(tt,"PDF_TO_CSS_UNITS",tt.CSS/tt.PDF);let H=tt;n.PixelsPerInch=H;class ct extends i.BaseFilterFactory{constructor({docId:st,ownerDocument:gt=globalThis.document}={}){super();W(this,u);W(this,O);W(this,rt);W(this,lt);W(this,mt);W(this,kt);W(this,St);W(this,at,void 0);W(this,G,void 0);W(this,ut,void 0);W(this,yt,void 0);W(this,Tt,void 0);W(this,wt,void 0);W(this,k,void 0);W(this,s,void 0);W(this,o,void 0);W(this,a,void 0);W(this,h,0);ot(this,ut,st),ot(this,yt,gt)}addFilter(st){if(!st)return"none";let gt=t(this,u,fe).get(st);if(gt)return gt;let Pt,Ct,$t,Vt;if(st.length===1){const Gt=st[0],Xt=new Array(256);for(let ft=0;ft<256;ft++)Xt[ft]=Gt[ft]/255;Vt=Pt=Ct=$t=Xt.join(",")}else{const[Gt,Xt,ft]=st,et=new Array(256),K=new Array(256),At=new Array(256);for(let vt=0;vt<256;vt++)et[vt]=Gt[vt]/255,K[vt]=Xt[vt]/255,At[vt]=ft[vt]/255;Pt=et.join(","),Ct=K.join(","),$t=At.join(","),Vt="".concat(Pt).concat(Ct).concat($t)}if(gt=t(this,u,fe).get(Vt),gt)return t(this,u,fe).set(st,gt),gt;const Ht="g_".concat(t(this,ut),"_transfer_map_").concat(be(this,h)._++),Yt="url(#".concat(Ht,")");t(this,u,fe).set(st,Yt),t(this,u,fe).set(Vt,Yt);const zt=Y(this,lt,Ce).call(this,Ht);return Y(this,kt,Ae).call(this,Pt,Ct,$t,zt),Yt}addHCMFilter(st,gt){var Xt;const Pt="".concat(st,"-").concat(gt);if(t(this,wt)===Pt)return t(this,k);if(ot(this,wt,Pt),ot(this,k,"none"),(Xt=t(this,Tt))==null||Xt.remove(),!st||!gt)return t(this,k);const Ct=Y(this,St,ve).call(this,st);st=f.Util.makeHexColor(...Ct);const $t=Y(this,St,ve).call(this,gt);if(gt=f.Util.makeHexColor(...$t),t(this,O,pe).style.color="",st==="#000000"&&gt==="#ffffff"||st===gt)return t(this,k);const Vt=new Array(256);for(let ft=0;ft<=255;ft++){const et=ft/255;Vt[ft]=et<=.03928?et/12.92:((et+.055)/1.055)**2.4}const Ht=Vt.join(","),Yt="g_".concat(t(this,ut),"_hcm_filter"),zt=ot(this,s,Y(this,lt,Ce).call(this,Yt));Y(this,kt,Ae).call(this,Ht,Ht,Ht,zt),Y(this,rt,Ze).call(this,zt);const Gt=(ft,et)=>{const K=Ct[ft]/255,At=$t[ft]/255,vt=new Array(et+1);for(let ne=0;ne<=et;ne++)vt[ne]=K+ne/et*(At-K);return vt.join(",")};return Y(this,kt,Ae).call(this,Gt(0,5),Gt(1,5),Gt(2,5),zt),ot(this,k,"url(#".concat(Yt,")")),t(this,k)}addHighlightHCMFilter(st,gt,Pt,Ct){var At;const $t="".concat(st,"-").concat(gt,"-").concat(Pt,"-").concat(Ct);if(t(this,o)===$t)return t(this,a);if(ot(this,o,$t),ot(this,a,"none"),(At=t(this,s))==null||At.remove(),!st||!gt)return t(this,a);const[Vt,Ht]=[st,gt].map(Y(this,St,ve).bind(this));let Yt=Math.round(.2126*Vt[0]+.7152*Vt[1]+.0722*Vt[2]),zt=Math.round(.2126*Ht[0]+.7152*Ht[1]+.0722*Ht[2]),[Gt,Xt]=[Pt,Ct].map(Y(this,St,ve).bind(this));zt<Yt&&([Yt,zt,Gt,Xt]=[zt,Yt,Xt,Gt]),t(this,O,pe).style.color="";const ft=(vt,ne,ee)=>{const Z=new Array(256),xt=(zt-Yt)/ee,It=vt/255,Ft=(ne-vt)/(255*ee);let Bt=0;for(let Ut=0;Ut<=ee;Ut++){const Zt=Math.round(Yt+Ut*xt),Et=It+Ut*Ft;for(let Jt=Bt;Jt<=Zt;Jt++)Z[Jt]=Et;Bt=Zt+1}for(let Ut=Bt;Ut<256;Ut++)Z[Ut]=Z[Bt-1];return Z.join(",")},et="g_".concat(t(this,ut),"_hcm_highlight_filter"),K=ot(this,s,Y(this,lt,Ce).call(this,et));return Y(this,rt,Ze).call(this,K),Y(this,kt,Ae).call(this,ft(Gt[0],Xt[0],5),ft(Gt[1],Xt[1],5),ft(Gt[2],Xt[2],5),K),ot(this,a,"url(#".concat(et,")")),t(this,a)}destroy(st=!1){st&&(t(this,k)||t(this,a))||(t(this,G)&&(t(this,G).parentNode.parentNode.remove(),ot(this,G,null)),t(this,at)&&(t(this,at).clear(),ot(this,at,null)),ot(this,h,0))}}at=new WeakMap,G=new WeakMap,ut=new WeakMap,yt=new WeakMap,Tt=new WeakMap,wt=new WeakMap,k=new WeakMap,s=new WeakMap,o=new WeakMap,a=new WeakMap,h=new WeakMap,u=new WeakSet,fe=function(){return t(this,at)||ot(this,at,new Map)},O=new WeakSet,pe=function(){if(!t(this,G)){const st=t(this,yt).createElement("div"),{style:gt}=st;gt.visibility="hidden",gt.contain="strict",gt.width=gt.height=0,gt.position="absolute",gt.top=gt.left=0,gt.zIndex=-1;const Pt=t(this,yt).createElementNS(z,"svg");Pt.setAttribute("width",0),Pt.setAttribute("height",0),ot(this,G,t(this,yt).createElementNS(z,"defs")),st.append(Pt),Pt.append(t(this,G)),t(this,yt).body.append(st)}return t(this,G)},rt=new WeakSet,Ze=function(st){const gt=t(this,yt).createElementNS(z,"feColorMatrix");gt.setAttribute("type","matrix"),gt.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),st.append(gt)},lt=new WeakSet,Ce=function(st){const gt=t(this,yt).createElementNS(z,"filter");return gt.setAttribute("color-interpolation-filters","sRGB"),gt.setAttribute("id",st),t(this,O,pe).append(gt),gt},mt=new WeakSet,Re=function(st,gt,Pt){const Ct=t(this,yt).createElementNS(z,gt);Ct.setAttribute("type","discrete"),Ct.setAttribute("tableValues",Pt),st.append(Ct)},kt=new WeakSet,Ae=function(st,gt,Pt,Ct){const $t=t(this,yt).createElementNS(z,"feComponentTransfer");Ct.append($t),Y(this,mt,Re).call(this,$t,"feFuncR",st),Y(this,mt,Re).call(this,$t,"feFuncG",gt),Y(this,mt,Re).call(this,$t,"feFuncB",Pt)},St=new WeakSet,ve=function(st){return t(this,O,pe).style.color=st,g(getComputedStyle(t(this,O,pe)).getPropertyValue("color"))},n.DOMFilterFactory=ct;class F extends i.BaseCanvasFactory{constructor({ownerDocument:it=globalThis.document}={}){super(),this._document=it}_createCanvas(it,st){const gt=this._document.createElement("canvas");return gt.width=it,gt.height=st,gt}}n.DOMCanvasFactory=F;async function R(bt,it=!1){if(A(bt,document.baseURI)){const st=await fetch(bt);if(!st.ok)throw new Error(st.statusText);return it?new Uint8Array(await st.arrayBuffer()):(0,f.stringToBytes)(await st.text())}return new Promise((st,gt)=>{const Pt=new XMLHttpRequest;Pt.open("GET",bt,!0),it&&(Pt.responseType="arraybuffer"),Pt.onreadystatechange=()=>{if(Pt.readyState===XMLHttpRequest.DONE){if(Pt.status===200||Pt.status===0){let Ct;if(it&&Pt.response?Ct=new Uint8Array(Pt.response):!it&&Pt.responseText&&(Ct=(0,f.stringToBytes)(Pt.responseText)),Ct){st(Ct);return}}gt(new Error(Pt.statusText))}},Pt.send(null)})}class m extends i.BaseCMapReaderFactory{_fetchData(it,st){return R(it,this.isCompressed).then(gt=>({cMapData:gt,compressionType:st}))}}n.DOMCMapReaderFactory=m;class I extends i.BaseStandardFontDataFactory{_fetchData(it){return R(it,!0)}}n.DOMStandardFontDataFactory=I;class N extends i.BaseSVGFactory{_createSVG(it){return document.createElementNS(z,it)}}n.DOMSVGFactory=N;class P{constructor({viewBox:it,scale:st,rotation:gt,offsetX:Pt=0,offsetY:Ct=0,dontFlip:$t=!1}){this.viewBox=it,this.scale=st,this.rotation=gt,this.offsetX=Pt,this.offsetY=Ct;const Vt=(it[2]+it[0])/2,Ht=(it[3]+it[1])/2;let Yt,zt,Gt,Xt;switch(gt%=360,gt<0&&(gt+=360),gt){case 180:Yt=-1,zt=0,Gt=0,Xt=1;break;case 90:Yt=0,zt=1,Gt=1,Xt=0;break;case 270:Yt=0,zt=-1,Gt=-1,Xt=0;break;case 0:Yt=1,zt=0,Gt=0,Xt=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}$t&&(Gt=-Gt,Xt=-Xt);let ft,et,K,At;Yt===0?(ft=Math.abs(Ht-it[1])*st+Pt,et=Math.abs(Vt-it[0])*st+Ct,K=(it[3]-it[1])*st,At=(it[2]-it[0])*st):(ft=Math.abs(Vt-it[0])*st+Pt,et=Math.abs(Ht-it[1])*st+Ct,K=(it[2]-it[0])*st,At=(it[3]-it[1])*st),this.transform=[Yt*st,zt*st,Gt*st,Xt*st,ft-Yt*st*Vt-Gt*st*Ht,et-zt*st*Vt-Xt*st*Ht],this.width=K,this.height=At}get rawDims(){const{viewBox:it}=this;return(0,f.shadow)(this,"rawDims",{pageWidth:it[2]-it[0],pageHeight:it[3]-it[1],pageX:it[0],pageY:it[1]})}clone({scale:it=this.scale,rotation:st=this.rotation,offsetX:gt=this.offsetX,offsetY:Pt=this.offsetY,dontFlip:Ct=!1}={}){return new P({viewBox:this.viewBox.slice(),scale:it,rotation:st,offsetX:gt,offsetY:Pt,dontFlip:Ct})}convertToViewportPoint(it,st){return f.Util.applyTransform([it,st],this.transform)}convertToViewportRectangle(it){const st=f.Util.applyTransform([it[0],it[1]],this.transform),gt=f.Util.applyTransform([it[2],it[3]],this.transform);return[st[0],st[1],gt[0],gt[1]]}convertToPdfPoint(it,st){return f.Util.applyInverseTransform([it,st],this.transform)}}n.PageViewport=P;class E extends f.BaseException{constructor(it,st=0){super(it,"RenderingCancelledException"),this.extraDelay=st}}n.RenderingCancelledException=E;function v(bt){const it=bt.length;let st=0;for(;st<it&&bt[st].trim()==="";)st++;return bt.substring(st,st+5).toLowerCase()==="data:"}function p(bt){return typeof bt=="string"&&/\.pdf$/i.test(bt)}function y(bt,it=!1){return it||([bt]=bt.split(/[#?]/,1)),bt.substring(bt.lastIndexOf("/")+1)}function C(bt,it="document.pdf"){if(typeof bt!="string")return it;if(v(bt))return(0,f.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),it;const st=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,gt=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,Pt=st.exec(bt);let Ct=gt.exec(Pt[1])||gt.exec(Pt[2])||gt.exec(Pt[3]);if(Ct&&(Ct=Ct[0],Ct.includes("%")))try{Ct=gt.exec(decodeURIComponent(Ct))[0]}catch($t){}return Ct||it}class x{constructor(){se(this,"started",Object.create(null));se(this,"times",[])}time(it){it in this.started&&(0,f.warn)("Timer is already running for ".concat(it)),this.started[it]=Date.now()}timeEnd(it){it in this.started||(0,f.warn)("Timer has not been started for ".concat(it)),this.times.push({name:it,start:this.started[it],end:Date.now()}),delete this.started[it]}toString(){const it=[];let st=0;for(const{name:gt}of this.times)st=Math.max(gt.length,st);for(const{name:gt,start:Pt,end:Ct}of this.times)it.push("".concat(gt.padEnd(st)," ").concat(Ct-Pt,"ms\n"));return it.join("")}}n.StatTimer=x;function A(bt,it){try{const{protocol:st}=it?new URL(bt,it):new URL(bt);return st==="http:"||st==="https:"}catch(st){return!1}}function c(bt){bt.preventDefault()}function d(bt,it=!1){return new Promise((st,gt)=>{const Pt=document.createElement("script");Pt.src=bt,Pt.onload=function(Ct){it&&Pt.remove(),st(Ct)},Pt.onerror=function(){gt(new Error("Cannot load script at: ".concat(Pt.src)))},(document.head||document.documentElement).append(Pt)})}function M(bt){console.log("Deprecated API usage: "+bt)}let b;class l{static toDateObject(it){if(!it||typeof it!="string")return null;b||(b=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const st=b.exec(it);if(!st)return null;const gt=parseInt(st[1],10);let Pt=parseInt(st[2],10);Pt=Pt>=1&&Pt<=12?Pt-1:0;let Ct=parseInt(st[3],10);Ct=Ct>=1&&Ct<=31?Ct:1;let $t=parseInt(st[4],10);$t=$t>=0&&$t<=23?$t:0;let Vt=parseInt(st[5],10);Vt=Vt>=0&&Vt<=59?Vt:0;let Ht=parseInt(st[6],10);Ht=Ht>=0&&Ht<=59?Ht:0;const Yt=st[7]||"Z";let zt=parseInt(st[8],10);zt=zt>=0&&zt<=23?zt:0;let Gt=parseInt(st[9],10)||0;return Gt=Gt>=0&&Gt<=59?Gt:0,Yt==="-"?($t+=zt,Vt+=Gt):Yt==="+"&&($t-=zt,Vt-=Gt),new Date(Date.UTC(gt,Pt,Ct,$t,Vt,Ht))}}n.PDFDateString=l;function w(bt,{scale:it=1,rotation:st=0}){const{width:gt,height:Pt}=bt.attributes.style,Ct=[0,0,parseInt(gt),parseInt(Pt)];return new P({viewBox:Ct,scale:it,rotation:st})}function g(bt){if(bt.startsWith("#")){const it=parseInt(bt.slice(1),16);return[(it&16711680)>>16,(it&65280)>>8,it&255]}return bt.startsWith("rgb(")?bt.slice(4,-1).split(",").map(it=>parseInt(it)):bt.startsWith("rgba(")?bt.slice(5,-1).split(",").map(it=>parseInt(it)).slice(0,3):((0,f.warn)('Not a valid color format: "'.concat(bt,'"')),[0,0,0])}function $(bt){const it=document.createElement("span");it.style.visibility="hidden",document.body.append(it);for(const st of bt.keys()){it.style.color=st;const gt=window.getComputedStyle(it).color;bt.set(st,g(gt))}it.remove()}function V(bt){const{a:it,b:st,c:gt,d:Pt,e:Ct,f:$t}=bt.getTransform();return[it,st,gt,Pt,Ct,$t]}function S(bt){const{a:it,b:st,c:gt,d:Pt,e:Ct,f:$t}=bt.getTransform().invertSelf();return[it,st,gt,Pt,Ct,$t]}function X(bt,it,st=!1,gt=!0){if(it instanceof P){const{pageWidth:Pt,pageHeight:Ct}=it.rawDims,{style:$t}=bt,Vt=f.FeatureTest.isCSSRoundSupported,Ht="var(--scale-factor) * ".concat(Pt,"px"),Yt="var(--scale-factor) * ".concat(Ct,"px"),zt=Vt?"round(".concat(Ht,", 1px)"):"calc(".concat(Ht,")"),Gt=Vt?"round(".concat(Yt,", 1px)"):"calc(".concat(Yt,")");!st||it.rotation%180===0?($t.width=zt,$t.height=Gt):($t.width=Gt,$t.height=zt)}gt&&bt.setAttribute("data-main-rotation",it.rotation)}},(D,n,L)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.BaseStandardFontDataFactory=n.BaseSVGFactory=n.BaseFilterFactory=n.BaseCanvasFactory=n.BaseCMapReaderFactory=void 0;var i=L(1);class f{constructor(){this.constructor===f&&(0,i.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(m){return"none"}addHCMFilter(m,I){return"none"}addHighlightHCMFilter(m,I,N,P){return"none"}destroy(m=!1){}}n.BaseFilterFactory=f;class z{constructor(){this.constructor===z&&(0,i.unreachable)("Cannot initialize BaseCanvasFactory.")}create(m,I){if(m<=0||I<=0)throw new Error("Invalid canvas size");const N=this._createCanvas(m,I);return{canvas:N,context:N.getContext("2d")}}reset(m,I,N){if(!m.canvas)throw new Error("Canvas is not specified");if(I<=0||N<=0)throw new Error("Invalid canvas size");m.canvas.width=I,m.canvas.height=N}destroy(m){if(!m.canvas)throw new Error("Canvas is not specified");m.canvas.width=0,m.canvas.height=0,m.canvas=null,m.context=null}_createCanvas(m,I){(0,i.unreachable)("Abstract method `_createCanvas` called.")}}n.BaseCanvasFactory=z;class H{constructor({baseUrl:m=null,isCompressed:I=!0}){this.constructor===H&&(0,i.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=m,this.isCompressed=I}async fetch({name:m}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!m)throw new Error("CMap name must be specified.");const I=this.baseUrl+m+(this.isCompressed?".bcmap":""),N=this.isCompressed?i.CMapCompressionType.BINARY:i.CMapCompressionType.NONE;return this._fetchData(I,N).catch(P=>{throw new Error("Unable to load ".concat(this.isCompressed?"binary ":"","CMap at: ").concat(I))})}_fetchData(m,I){(0,i.unreachable)("Abstract method `_fetchData` called.")}}n.BaseCMapReaderFactory=H;class ct{constructor({baseUrl:m=null}){this.constructor===ct&&(0,i.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=m}async fetch({filename:m}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!m)throw new Error("Font filename must be specified.");const I="".concat(this.baseUrl).concat(m);return this._fetchData(I).catch(N=>{throw new Error("Unable to load font data at: ".concat(I))})}_fetchData(m){(0,i.unreachable)("Abstract method `_fetchData` called.")}}n.BaseStandardFontDataFactory=ct;class F{constructor(){this.constructor===F&&(0,i.unreachable)("Cannot initialize BaseSVGFactory.")}create(m,I,N=!1){if(m<=0||I<=0)throw new Error("Invalid SVG dimensions");const P=this._createSVG("svg:svg");return P.setAttribute("version","1.1"),N||(P.setAttribute("width","".concat(m,"px")),P.setAttribute("height","".concat(I,"px"))),P.setAttribute("preserveAspectRatio","none"),P.setAttribute("viewBox","0 0 ".concat(m," ").concat(I)),P}createElement(m){if(typeof m!="string")throw new Error("Invalid SVG element type");return this._createSVG(m)}_createSVG(m){(0,i.unreachable)("Abstract method `_createSVG` called.")}}n.BaseSVGFactory=F},(D,n,L)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.MurmurHash3_64=void 0;var i=L(1);const f=3285377520,z=4294901760,H=65535;class ct{constructor(R){this.h1=R?R&4294967295:f,this.h2=R?R&4294967295:f}update(R){let m,I;if(typeof R=="string"){m=new Uint8Array(R.length*2),I=0;for(let M=0,b=R.length;M<b;M++){const l=R.charCodeAt(M);l<=255?m[I++]=l:(m[I++]=l>>>8,m[I++]=l&255)}}else if((0,i.isArrayBuffer)(R))m=R.slice(),I=m.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const N=I>>2,P=I-N*4,E=new Uint32Array(m.buffer,0,N);let v=0,p=0,y=this.h1,C=this.h2;const x=3432918353,A=461845907,c=x&H,d=A&H;for(let M=0;M<N;M++)M&1?(v=E[M],v=v*x&z|v*c&H,v=v<<15|v>>>17,v=v*A&z|v*d&H,y^=v,y=y<<13|y>>>19,y=y*5+3864292196):(p=E[M],p=p*x&z|p*c&H,p=p<<15|p>>>17,p=p*A&z|p*d&H,C^=p,C=C<<13|C>>>19,C=C*5+3864292196);switch(v=0,P){case 3:v^=m[N*4+2]<<16;case 2:v^=m[N*4+1]<<8;case 1:v^=m[N*4],v=v*x&z|v*c&H,v=v<<15|v>>>17,v=v*A&z|v*d&H,N&1?y^=v:C^=v}this.h1=y,this.h2=C}hexdigest(){let R=this.h1,m=this.h2;return R^=m>>>1,R=R*3981806797&z|R*36045&H,m=m*4283543511&z|((m<<16|R>>>16)*2950163797&z)>>>16,R^=m>>>1,R=R*444984403&z|R*60499&H,m=m*3301882366&z|((m<<16|R>>>16)*3120437893&z)>>>16,R^=m>>>1,(R>>>0).toString(16).padStart(8,"0")+(m>>>0).toString(16).padStart(8,"0")}}n.MurmurHash3_64=ct},(D,n,L)=>{var H;Object.defineProperty(n,"__esModule",{value:!0}),n.FontLoader=n.FontFaceObject=void 0;var i=L(1);class f{constructor({ownerDocument:F=globalThis.document,styleElement:R=null}){W(this,H,new Set);this._document=F,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(F){this.nativeFontFaces.add(F),this._document.fonts.add(F)}removeNativeFontFace(F){this.nativeFontFaces.delete(F),this._document.fonts.delete(F)}insertRule(F){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const R=this.styleElement.sheet;R.insertRule(F,R.cssRules.length)}clear(){for(const F of this.nativeFontFaces)this._document.fonts.delete(F);this.nativeFontFaces.clear(),t(this,H).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(F){if(!(!F||t(this,H).has(F.loadedName))){if((0,i.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:R,src:m,style:I}=F,N=new FontFace(R,m,I);this.addNativeFontFace(N);try{await N.load(),t(this,H).add(R)}catch(P){(0,i.warn)("Cannot load system font: ".concat(F.baseFontName,", installing it could help to improve PDF rendering.")),this.removeNativeFontFace(N)}return}(0,i.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(F){if(F.attached||F.missingFile&&!F.systemFontInfo)return;if(F.attached=!0,F.systemFontInfo){await this.loadSystemFont(F.systemFontInfo);return}if(this.isFontLoadingAPISupported){const m=F.createNativeFontFace();if(m){this.addNativeFontFace(m);try{await m.loaded}catch(I){throw(0,i.warn)("Failed to load font '".concat(m.family,"': '").concat(I,"'.")),F.disableFontFace=!0,I}}return}const R=F.createFontFaceRule();if(R){if(this.insertRule(R),this.isSyncFontLoadingSupported)return;await new Promise(m=>{const I=this._queueLoadingCallback(m);this._prepareFontLoadEvent(F,I)})}}get isFontLoadingAPISupported(){var R;const F=!!((R=this._document)!=null&&R.fonts);return(0,i.shadow)(this,"isFontLoadingAPISupported",F)}get isSyncFontLoadingSupported(){let F=!1;return(i.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(F=!0),(0,i.shadow)(this,"isSyncFontLoadingSupported",F)}_queueLoadingCallback(F){function R(){for((0,i.assert)(!I.done,"completeRequest() cannot be called twice."),I.done=!0;m.length>0&&m[0].done;){const N=m.shift();setTimeout(N.callback,0)}}const{loadingRequests:m}=this,I={done:!1,complete:R,callback:F};return m.push(I),I}get _loadTestFont(){const F=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,i.shadow)(this,"_loadTestFont",F)}_prepareFontLoadEvent(F,R){function m(g,$){return g.charCodeAt($)<<24|g.charCodeAt($+1)<<16|g.charCodeAt($+2)<<8|g.charCodeAt($+3)&255}function I(g,$,V,S){const X=g.substring(0,$),tt=g.substring($+V);return X+S+tt}let N,P;const E=this._document.createElement("canvas");E.width=1,E.height=1;const v=E.getContext("2d");let p=0;function y(g,$){if(++p>30){(0,i.warn)("Load test font never loaded."),$();return}if(v.font="30px "+g,v.fillText(".",0,20),v.getImageData(0,0,1,1).data[3]>0){$();return}setTimeout(y.bind(null,g,$))}const C="lt".concat(Date.now()).concat(this.loadTestFontId++);let x=this._loadTestFont;x=I(x,976,C.length,C);const c=16,d=1482184792;let M=m(x,c);for(N=0,P=C.length-3;N<P;N+=4)M=M-d+m(C,N)|0;N<C.length&&(M=M-d+m(C+"XXX",N)|0),x=I(x,c,4,(0,i.string32)(M));const b="url(data:font/opentype;base64,".concat(btoa(x),");"),l='@font-face {font-family:"'.concat(C,'";src:').concat(b,"}");this.insertRule(l);const w=this._document.createElement("div");w.style.visibility="hidden",w.style.width=w.style.height="10px",w.style.position="absolute",w.style.top=w.style.left="0px";for(const g of[F.loadedName,C]){const $=this._document.createElement("span");$.textContent="Hi",$.style.fontFamily=g,w.append($)}this._document.body.append(w),y(C,()=>{w.remove(),R.complete()})}}H=new WeakMap,n.FontLoader=f;class z{constructor(F,{isEvalSupported:R=!0,disableFontFace:m=!1,ignoreErrors:I=!1,inspectFont:N=null}){this.compiledGlyphs=Object.create(null);for(const P in F)this[P]=F[P];this.isEvalSupported=R!==!1,this.disableFontFace=m===!0,this.ignoreErrors=I===!0,this._inspectFont=N}createNativeFontFace(){var R;if(!this.data||this.disableFontFace)return null;let F;if(!this.cssFontInfo)F=new FontFace(this.loadedName,this.data,{});else{const m={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(m.style="oblique ".concat(this.cssFontInfo.italicAngle,"deg")),F=new FontFace(this.cssFontInfo.fontFamily,this.data,m)}return(R=this._inspectFont)==null||R.call(this,this),F}createFontFaceRule(){var I;if(!this.data||this.disableFontFace)return null;const F=(0,i.bytesToString)(this.data),R="url(data:".concat(this.mimetype,";base64,").concat(btoa(F),");");let m;if(!this.cssFontInfo)m='@font-face {font-family:"'.concat(this.loadedName,'";src:').concat(R,"}");else{let N="font-weight: ".concat(this.cssFontInfo.fontWeight,";");this.cssFontInfo.italicAngle&&(N+="font-style: oblique ".concat(this.cssFontInfo.italicAngle,"deg;")),m='@font-face {font-family:"'.concat(this.cssFontInfo.fontFamily,'";').concat(N,"src:").concat(R,"}")}return(I=this._inspectFont)==null||I.call(this,this,R),m}getPathGenerator(F,R){if(this.compiledGlyphs[R]!==void 0)return this.compiledGlyphs[R];let m;try{m=F.get(this.loadedName+"_path_"+R)}catch(I){if(!this.ignoreErrors)throw I;return(0,i.warn)('getPathGenerator - ignoring character: "'.concat(I,'".')),this.compiledGlyphs[R]=function(N,P){}}if(this.isEvalSupported&&i.FeatureTest.isEvalSupported){const I=[];for(const N of m){const P=N.args!==void 0?N.args.join(","):"";I.push("c.",N.cmd,"(",P,");\n")}return this.compiledGlyphs[R]=new Function("c","size",I.join(""))}return this.compiledGlyphs[R]=function(I,N){for(const P of m)P.cmd==="scale"&&(P.args=[N,-N]),I[P.cmd].apply(I,P.args)}}}n.FontFaceObject=z},(D,n,L)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.NodeStandardFontDataFactory=n.NodeFilterFactory=n.NodeCanvasFactory=n.NodeCMapReaderFactory=void 0;var i=L(7);L(1);const f=function(R){return new Promise((m,I)=>{require$$5.readFile(R,(P,E)=>{if(P||!E){I(new Error(P));return}m(new Uint8Array(E))})})};class z extends i.BaseFilterFactory{}n.NodeFilterFactory=z;class H extends i.BaseCanvasFactory{_createCanvas(m,I){return require$$5.createCanvas(m,I)}}n.NodeCanvasFactory=H;class ct extends i.BaseCMapReaderFactory{_fetchData(m,I){return f(m).then(N=>({cMapData:N,compressionType:I}))}}n.NodeCMapReaderFactory=ct;class F extends i.BaseStandardFontDataFactory{_fetchData(m){return f(m)}}n.NodeStandardFontDataFactory=F},(D,n,L)=>{var G,tn,yt,en;Object.defineProperty(n,"__esModule",{value:!0}),n.CanvasGraphics=void 0;var i=L(1),f=L(6),z=L(12),H=L(13);const ct=16,F=100,R=4096,m=15,I=10,N=1e3,P=16;function E(k,s){if(k._removeMirroring)throw new Error("Context is already forwarding operations.");k.__originalSave=k.save,k.__originalRestore=k.restore,k.__originalRotate=k.rotate,k.__originalScale=k.scale,k.__originalTranslate=k.translate,k.__originalTransform=k.transform,k.__originalSetTransform=k.setTransform,k.__originalResetTransform=k.resetTransform,k.__originalClip=k.clip,k.__originalMoveTo=k.moveTo,k.__originalLineTo=k.lineTo,k.__originalBezierCurveTo=k.bezierCurveTo,k.__originalRect=k.rect,k.__originalClosePath=k.closePath,k.__originalBeginPath=k.beginPath,k._removeMirroring=()=>{k.save=k.__originalSave,k.restore=k.__originalRestore,k.rotate=k.__originalRotate,k.scale=k.__originalScale,k.translate=k.__originalTranslate,k.transform=k.__originalTransform,k.setTransform=k.__originalSetTransform,k.resetTransform=k.__originalResetTransform,k.clip=k.__originalClip,k.moveTo=k.__originalMoveTo,k.lineTo=k.__originalLineTo,k.bezierCurveTo=k.__originalBezierCurveTo,k.rect=k.__originalRect,k.closePath=k.__originalClosePath,k.beginPath=k.__originalBeginPath,delete k._removeMirroring},k.save=function(){s.save(),this.__originalSave()},k.restore=function(){s.restore(),this.__originalRestore()},k.translate=function(a,h){s.translate(a,h),this.__originalTranslate(a,h)},k.scale=function(a,h){s.scale(a,h),this.__originalScale(a,h)},k.transform=function(a,h,u,T,O,U){s.transform(a,h,u,T,O,U),this.__originalTransform(a,h,u,T,O,U)},k.setTransform=function(a,h,u,T,O,U){s.setTransform(a,h,u,T,O,U),this.__originalSetTransform(a,h,u,T,O,U)},k.resetTransform=function(){s.resetTransform(),this.__originalResetTransform()},k.rotate=function(a){s.rotate(a),this.__originalRotate(a)},k.clip=function(a){s.clip(a),this.__originalClip(a)},k.moveTo=function(o,a){s.moveTo(o,a),this.__originalMoveTo(o,a)},k.lineTo=function(o,a){s.lineTo(o,a),this.__originalLineTo(o,a)},k.bezierCurveTo=function(o,a,h,u,T,O){s.bezierCurveTo(o,a,h,u,T,O),this.__originalBezierCurveTo(o,a,h,u,T,O)},k.rect=function(o,a,h,u){s.rect(o,a,h,u),this.__originalRect(o,a,h,u)},k.closePath=function(){s.closePath(),this.__originalClosePath()},k.beginPath=function(){s.beginPath(),this.__originalBeginPath()}}class v{constructor(s){this.canvasFactory=s,this.cache=Object.create(null)}getCanvas(s,o,a){let h;return this.cache[s]!==void 0?(h=this.cache[s],this.canvasFactory.reset(h,o,a)):(h=this.canvasFactory.create(o,a),this.cache[s]=h),h}delete(s){delete this.cache[s]}clear(){for(const s in this.cache){const o=this.cache[s];this.canvasFactory.destroy(o),delete this.cache[s]}}}function p(k,s,o,a,h,u,T,O,U,rt){const[nt,lt,pt,mt,dt,kt]=(0,f.getCurrentTransform)(k);if(lt===0&&pt===0){const Ot=T*nt+dt,bt=Math.round(Ot),it=O*mt+kt,st=Math.round(it),gt=(T+U)*nt+dt,Pt=Math.abs(Math.round(gt)-bt)||1,Ct=(O+rt)*mt+kt,$t=Math.abs(Math.round(Ct)-st)||1;return k.setTransform(Math.sign(nt),0,0,Math.sign(mt),bt,st),k.drawImage(s,o,a,h,u,0,0,Pt,$t),k.setTransform(nt,lt,pt,mt,dt,kt),[Pt,$t]}if(nt===0&&mt===0){const Ot=O*pt+dt,bt=Math.round(Ot),it=T*lt+kt,st=Math.round(it),gt=(O+rt)*pt+dt,Pt=Math.abs(Math.round(gt)-bt)||1,Ct=(T+U)*lt+kt,$t=Math.abs(Math.round(Ct)-st)||1;return k.setTransform(0,Math.sign(lt),Math.sign(pt),0,bt,st),k.drawImage(s,o,a,h,u,0,0,$t,Pt),k.setTransform(nt,lt,pt,mt,dt,kt),[$t,Pt]}k.drawImage(s,o,a,h,u,T,O,U,rt);const Nt=Math.hypot(nt,lt),St=Math.hypot(pt,mt);return[Nt*U,St*rt]}function y(k){const{width:s,height:o}=k;if(s>N||o>N)return null;const a=1e3,h=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),u=s+1;let T=new Uint8Array(u*(o+1)),O,U,rt;const nt=s+7&-8;let lt=new Uint8Array(nt*o),pt=0;for(const St of k.data){let Ot=128;for(;Ot>0;)lt[pt++]=St&Ot?0:255,Ot>>=1}let mt=0;for(pt=0,lt[pt]!==0&&(T[0]=1,++mt),U=1;U<s;U++)lt[pt]!==lt[pt+1]&&(T[U]=lt[pt]?2:1,++mt),pt++;for(lt[pt]!==0&&(T[U]=2,++mt),O=1;O<o;O++){pt=O*nt,rt=O*u,lt[pt-nt]!==lt[pt]&&(T[rt]=lt[pt]?1:8,++mt);let St=(lt[pt]?4:0)+(lt[pt-nt]?8:0);for(U=1;U<s;U++)St=(St>>2)+(lt[pt+1]?4:0)+(lt[pt-nt+1]?8:0),h[St]&&(T[rt+U]=h[St],++mt),pt++;if(lt[pt-nt]!==lt[pt]&&(T[rt+U]=lt[pt]?2:4,++mt),mt>a)return null}for(pt=nt*(o-1),rt=O*u,lt[pt]!==0&&(T[rt]=8,++mt),U=1;U<s;U++)lt[pt]!==lt[pt+1]&&(T[rt+U]=lt[pt]?4:8,++mt),pt++;if(lt[pt]!==0&&(T[rt+U]=4,++mt),mt>a)return null;const dt=new Int32Array([0,u,-1,0,-u,0,0,0,1]),kt=new Path2D;for(O=0;mt&&O<=o;O++){let St=O*u;const Ot=St+s;for(;St<Ot&&!T[St];)St++;if(St===Ot)continue;kt.moveTo(St%u,O);const bt=St;let it=T[St];do{const st=dt[it];do St+=st;while(!T[St]);const gt=T[St];gt!==5&&gt!==10?(it=gt,T[St]=0):(it=gt&51*it>>4,T[St]&=it>>2|it<<2),kt.lineTo(St%u,St/u|0),T[St]||--mt}while(bt!==St);--O}return lt=null,T=null,function(St){St.save(),St.scale(1/s,-1/o),St.translate(0,-o),St.fill(kt),St.beginPath(),St.restore()}}class C{constructor(s,o){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=i.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=i.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=i.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,s,o])}clone(){const s=Object.create(this);return s.clipBox=this.clipBox.slice(),s}setCurrentPoint(s,o){this.x=s,this.y=o}updatePathMinMax(s,o,a){[o,a]=i.Util.applyTransform([o,a],s),this.minX=Math.min(this.minX,o),this.minY=Math.min(this.minY,a),this.maxX=Math.max(this.maxX,o),this.maxY=Math.max(this.maxY,a)}updateRectMinMax(s,o){const a=i.Util.applyTransform(o,s),h=i.Util.applyTransform(o.slice(2),s);this.minX=Math.min(this.minX,a[0],h[0]),this.minY=Math.min(this.minY,a[1],h[1]),this.maxX=Math.max(this.maxX,a[0],h[0]),this.maxY=Math.max(this.maxY,a[1],h[1])}updateScalingPathMinMax(s,o){i.Util.scaleMinMax(s,o),this.minX=Math.min(this.minX,o[0]),this.maxX=Math.max(this.maxX,o[1]),this.minY=Math.min(this.minY,o[2]),this.maxY=Math.max(this.maxY,o[3])}updateCurvePathMinMax(s,o,a,h,u,T,O,U,rt,nt){const lt=i.Util.bezierBoundingBox(o,a,h,u,T,O,U,rt);if(nt){nt[0]=Math.min(nt[0],lt[0],lt[2]),nt[1]=Math.max(nt[1],lt[0],lt[2]),nt[2]=Math.min(nt[2],lt[1],lt[3]),nt[3]=Math.max(nt[3],lt[1],lt[3]);return}this.updateRectMinMax(s,lt)}getPathBoundingBox(s=z.PathType.FILL,o=null){const a=[this.minX,this.minY,this.maxX,this.maxY];if(s===z.PathType.STROKE){o||(0,i.unreachable)("Stroke bounding box must include transform.");const h=i.Util.singularValueDecompose2dScale(o),u=h[0]*this.lineWidth/2,T=h[1]*this.lineWidth/2;a[0]-=u,a[1]-=T,a[2]+=u,a[3]+=T}return a}updateClipFromPath(){const s=i.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(s||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(s){this.clipBox=s,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(s=z.PathType.FILL,o=null){return i.Util.intersect(this.clipBox,this.getPathBoundingBox(s,o))}}function x(k,s){if(typeof ImageData<"u"&&s instanceof ImageData){k.putImageData(s,0,0);return}const o=s.height,a=s.width,h=o%P,u=(o-h)/P,T=h===0?u:u+1,O=k.createImageData(a,P);let U=0,rt;const nt=s.data,lt=O.data;let pt,mt,dt,kt;if(s.kind===i.ImageKind.GRAYSCALE_1BPP){const Nt=nt.byteLength,St=new Uint32Array(lt.buffer,0,lt.byteLength>>2),Ot=St.length,bt=a+7>>3,it=4294967295,st=i.FeatureTest.isLittleEndian?4278190080:255;for(pt=0;pt<T;pt++){for(dt=pt<u?P:h,rt=0,mt=0;mt<dt;mt++){const gt=Nt-U;let Pt=0;const Ct=gt>bt?a:gt*8-7,$t=Ct&-8;let Vt=0,Ht=0;for(;Pt<$t;Pt+=8)Ht=nt[U++],St[rt++]=Ht&128?it:st,St[rt++]=Ht&64?it:st,St[rt++]=Ht&32?it:st,St[rt++]=Ht&16?it:st,St[rt++]=Ht&8?it:st,St[rt++]=Ht&4?it:st,St[rt++]=Ht&2?it:st,St[rt++]=Ht&1?it:st;for(;Pt<Ct;Pt++)Vt===0&&(Ht=nt[U++],Vt=128),St[rt++]=Ht&Vt?it:st,Vt>>=1}for(;rt<Ot;)St[rt++]=0;k.putImageData(O,0,pt*P)}}else if(s.kind===i.ImageKind.RGBA_32BPP){for(mt=0,kt=a*P*4,pt=0;pt<u;pt++)lt.set(nt.subarray(U,U+kt)),U+=kt,k.putImageData(O,0,mt),mt+=P;pt<T&&(kt=a*h*4,lt.set(nt.subarray(U,U+kt)),k.putImageData(O,0,mt))}else if(s.kind===i.ImageKind.RGB_24BPP)for(dt=P,kt=a*dt,pt=0;pt<T;pt++){for(pt>=u&&(dt=h,kt=a*dt),rt=0,mt=kt;mt--;)lt[rt++]=nt[U++],lt[rt++]=nt[U++],lt[rt++]=nt[U++],lt[rt++]=255;k.putImageData(O,0,pt*P)}else throw new Error("bad image kind: ".concat(s.kind))}function A(k,s){if(s.bitmap){k.drawImage(s.bitmap,0,0);return}const o=s.height,a=s.width,h=o%P,u=(o-h)/P,T=h===0?u:u+1,O=k.createImageData(a,P);let U=0;const rt=s.data,nt=O.data;for(let lt=0;lt<T;lt++){const pt=lt<u?P:h;({srcPos:U}=(0,H.convertBlackAndWhiteToRGBA)({src:rt,srcPos:U,dest:nt,width:a,height:pt,nonBlackColor:0})),k.putImageData(O,0,lt*P)}}function c(k,s){const o=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const a of o)k[a]!==void 0&&(s[a]=k[a]);k.setLineDash!==void 0&&(s.setLineDash(k.getLineDash()),s.lineDashOffset=k.lineDashOffset)}function d(k){if(k.strokeStyle=k.fillStyle="#000000",k.fillRule="nonzero",k.globalAlpha=1,k.lineWidth=1,k.lineCap="butt",k.lineJoin="miter",k.miterLimit=10,k.globalCompositeOperation="source-over",k.font="10px sans-serif",k.setLineDash!==void 0&&(k.setLineDash([]),k.lineDashOffset=0),!i.isNodeJS){const{filter:s}=k;s!=="none"&&s!==""&&(k.filter="none")}}function M(k,s,o,a){const h=k.length;for(let u=3;u<h;u+=4){const T=k[u];if(T===0)k[u-3]=s,k[u-2]=o,k[u-1]=a;else if(T<255){const O=255-T;k[u-3]=k[u-3]*T+s*O>>8,k[u-2]=k[u-2]*T+o*O>>8,k[u-1]=k[u-1]*T+a*O>>8}}}function b(k,s,o){const a=k.length,h=1/255;for(let u=3;u<a;u+=4){const T=o?o[k[u]]:k[u];s[u]=s[u]*T*h|0}}function l(k,s,o){const a=k.length;for(let h=3;h<a;h+=4){const u=k[h-3]*77+k[h-2]*152+k[h-1]*28;s[h]=o?s[h]*o[u>>8]>>8:s[h]*u>>16}}function w(k,s,o,a,h,u,T,O,U,rt,nt){const lt=!!u,pt=lt?u[0]:0,mt=lt?u[1]:0,dt=lt?u[2]:0,kt=h==="Luminosity"?l:b,St=Math.min(a,Math.ceil(1048576/o));for(let Ot=0;Ot<a;Ot+=St){const bt=Math.min(St,a-Ot),it=k.getImageData(O-rt,Ot+(U-nt),o,bt),st=s.getImageData(O,Ot+U,o,bt);lt&&M(it.data,pt,mt,dt),kt(it.data,st.data,T),s.putImageData(st,O,Ot+U)}}function g(k,s,o,a){const h=a[0],u=a[1],T=a[2]-h,O=a[3]-u;T===0||O===0||(w(s.context,o,T,O,s.subtype,s.backdrop,s.transferMap,h,u,s.offsetX,s.offsetY),k.save(),k.globalAlpha=1,k.globalCompositeOperation="source-over",k.setTransform(1,0,0,1,0,0),k.drawImage(o.canvas,0,0),k.restore())}function $(k,s){const o=i.Util.singularValueDecompose2dScale(k);o[0]=Math.fround(o[0]),o[1]=Math.fround(o[1]);const a=Math.fround((globalThis.devicePixelRatio||1)*f.PixelsPerInch.PDF_TO_CSS_UNITS);return s!==void 0?s:o[0]<=a||o[1]<=a}const V=["butt","round","square"],S=["miter","round","bevel"],X={},tt={},wt=class wt{constructor(s,o,a,h,u,{optionalContentConfig:T,markedContentStack:O=null},U,rt){W(this,G);W(this,yt);this.ctx=s,this.current=new C(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=o,this.objs=a,this.canvasFactory=h,this.filterFactory=u,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=O||[],this.optionalContentConfig=T,this.cachedCanvases=new v(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=U,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=rt,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(s,o=null){return typeof s=="string"?s.startsWith("g_")?this.commonObjs.get(s):this.objs.get(s):o}beginDrawing({transform:s,viewport:o,transparency:a=!1,background:h=null}){const u=this.ctx.canvas.width,T=this.ctx.canvas.height,O=this.ctx.fillStyle;if(this.ctx.fillStyle=h||"#ffffff",this.ctx.fillRect(0,0,u,T),this.ctx.fillStyle=O,a){const U=this.cachedCanvases.getCanvas("transparent",u,T);this.compositeCtx=this.ctx,this.transparentCanvas=U.canvas,this.ctx=U.context,this.ctx.save(),this.ctx.transform(...(0,f.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),d(this.ctx),s&&(this.ctx.transform(...s),this.outputScaleX=s[0],this.outputScaleY=s[0]),this.ctx.transform(...o.transform),this.viewportScale=o.scale,this.baseTransform=(0,f.getCurrentTransform)(this.ctx)}executeOperatorList(s,o,a,h){const u=s.argsArray,T=s.fnArray;let O=o||0;const U=u.length;if(U===O)return O;const rt=U-O>I&&typeof a=="function",nt=rt?Date.now()+m:0;let lt=0;const pt=this.commonObjs,mt=this.objs;let dt;for(;;){if(h!==void 0&&O===h.nextBreakPoint)return h.breakIt(O,a),O;if(dt=T[O],dt!==i.OPS.dependency)this[dt].apply(this,u[O]);else for(const kt of u[O]){const Nt=kt.startsWith("g_")?pt:mt;if(!Nt.has(kt))return Nt.get(kt,a),O}if(O++,O===U)return O;if(rt&&++lt>I){if(Date.now()>nt)return a(),O;lt=0}}}endDrawing(){Y(this,G,tn).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const s of this._cachedBitmapsMap.values()){for(const o of s.values())typeof HTMLCanvasElement<"u"&&o instanceof HTMLCanvasElement&&(o.width=o.height=0);s.clear()}this._cachedBitmapsMap.clear(),Y(this,yt,en).call(this)}_scaleImage(s,o){const a=s.width,h=s.height;let u=Math.max(Math.hypot(o[0],o[1]),1),T=Math.max(Math.hypot(o[2],o[3]),1),O=a,U=h,rt="prescale1",nt,lt;for(;u>2&&O>1||T>2&&U>1;){let pt=O,mt=U;u>2&&O>1&&(pt=O>=16384?Math.floor(O/2)-1||1:Math.ceil(O/2),u/=O/pt),T>2&&U>1&&(mt=U>=16384?Math.floor(U/2)-1||1:Math.ceil(U)/2,T/=U/mt),nt=this.cachedCanvases.getCanvas(rt,pt,mt),lt=nt.context,lt.clearRect(0,0,pt,mt),lt.drawImage(s,0,0,O,U,0,0,pt,mt),s=nt.canvas,O=pt,U=mt,rt=rt==="prescale1"?"prescale2":"prescale1"}return{img:s,paintWidth:O,paintHeight:U}}_createMaskCanvas(s){const o=this.ctx,{width:a,height:h}=s,u=this.current.fillColor,T=this.current.patternFill,O=(0,f.getCurrentTransform)(o);let U,rt,nt,lt;if((s.bitmap||s.data)&&s.count>1){const Pt=s.bitmap||s.data.buffer;rt=JSON.stringify(T?O:[O.slice(0,4),u]),U=this._cachedBitmapsMap.get(Pt),U||(U=new Map,this._cachedBitmapsMap.set(Pt,U));const Ct=U.get(rt);if(Ct&&!T){const $t=Math.round(Math.min(O[0],O[2])+O[4]),Vt=Math.round(Math.min(O[1],O[3])+O[5]);return{canvas:Ct,offsetX:$t,offsetY:Vt}}nt=Ct}nt||(lt=this.cachedCanvases.getCanvas("maskCanvas",a,h),A(lt.context,s));let pt=i.Util.transform(O,[1/a,0,0,-1/h,0,0]);pt=i.Util.transform(pt,[1,0,0,1,0,-h]);const mt=i.Util.applyTransform([0,0],pt),dt=i.Util.applyTransform([a,h],pt),kt=i.Util.normalizeRect([mt[0],mt[1],dt[0],dt[1]]),Nt=Math.round(kt[2]-kt[0])||1,St=Math.round(kt[3]-kt[1])||1,Ot=this.cachedCanvases.getCanvas("fillCanvas",Nt,St),bt=Ot.context,it=Math.min(mt[0],dt[0]),st=Math.min(mt[1],dt[1]);bt.translate(-it,-st),bt.transform(...pt),nt||(nt=this._scaleImage(lt.canvas,(0,f.getCurrentTransformInverse)(bt)),nt=nt.img,U&&T&&U.set(rt,nt)),bt.imageSmoothingEnabled=$((0,f.getCurrentTransform)(bt),s.interpolate),p(bt,nt,0,0,nt.width,nt.height,0,0,a,h),bt.globalCompositeOperation="source-in";const gt=i.Util.transform((0,f.getCurrentTransformInverse)(bt),[1,0,0,1,-it,-st]);return bt.fillStyle=T?u.getPattern(o,this,gt,z.PathType.FILL):u,bt.fillRect(0,0,a,h),U&&!T&&(this.cachedCanvases.delete("fillCanvas"),U.set(rt,Ot.canvas)),{canvas:Ot.canvas,offsetX:Math.round(it),offsetY:Math.round(st)}}setLineWidth(s){s!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=s,this.ctx.lineWidth=s}setLineCap(s){this.ctx.lineCap=V[s]}setLineJoin(s){this.ctx.lineJoin=S[s]}setMiterLimit(s){this.ctx.miterLimit=s}setDash(s,o){const a=this.ctx;a.setLineDash!==void 0&&(a.setLineDash(s),a.lineDashOffset=o)}setRenderingIntent(s){}setFlatness(s){}setGState(s){for(const[o,a]of s)switch(o){case"LW":this.setLineWidth(a);break;case"LC":this.setLineCap(a);break;case"LJ":this.setLineJoin(a);break;case"ML":this.setMiterLimit(a);break;case"D":this.setDash(a[0],a[1]);break;case"RI":this.setRenderingIntent(a);break;case"FL":this.setFlatness(a);break;case"Font":this.setFont(a[0],a[1]);break;case"CA":this.current.strokeAlpha=a;break;case"ca":this.current.fillAlpha=a,this.ctx.globalAlpha=a;break;case"BM":this.ctx.globalCompositeOperation=a;break;case"SMask":this.current.activeSMask=a?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(a);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const s=this.inSMaskMode;this.current.activeSMask&&!s?this.beginSMaskMode():!this.current.activeSMask&&s&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const s=this.ctx.canvas.width,o=this.ctx.canvas.height,a="smaskGroupAt"+this.groupLevel,h=this.cachedCanvases.getCanvas(a,s,o);this.suspendedCtx=this.ctx,this.ctx=h.context;const u=this.ctx;u.setTransform(...(0,f.getCurrentTransform)(this.suspendedCtx)),c(this.suspendedCtx,u),E(u,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),c(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(s){if(!this.current.activeSMask)return;s?(s[0]=Math.floor(s[0]),s[1]=Math.floor(s[1]),s[2]=Math.ceil(s[2]),s[3]=Math.ceil(s[3])):s=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const o=this.current.activeSMask,a=this.suspendedCtx;g(a,o,this.ctx,s),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(c(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const s=this.current;this.stateStack.push(s),this.current=s.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),c(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(s,o,a,h,u,T){this.ctx.transform(s,o,a,h,u,T),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(s,o,a){const h=this.ctx,u=this.current;let T=u.x,O=u.y,U,rt;const nt=(0,f.getCurrentTransform)(h),lt=nt[0]===0&&nt[3]===0||nt[1]===0&&nt[2]===0,pt=lt?a.slice(0):null;for(let mt=0,dt=0,kt=s.length;mt<kt;mt++)switch(s[mt]|0){case i.OPS.rectangle:T=o[dt++],O=o[dt++];const Nt=o[dt++],St=o[dt++],Ot=T+Nt,bt=O+St;h.moveTo(T,O),Nt===0||St===0?h.lineTo(Ot,bt):(h.lineTo(Ot,O),h.lineTo(Ot,bt),h.lineTo(T,bt)),lt||u.updateRectMinMax(nt,[T,O,Ot,bt]),h.closePath();break;case i.OPS.moveTo:T=o[dt++],O=o[dt++],h.moveTo(T,O),lt||u.updatePathMinMax(nt,T,O);break;case i.OPS.lineTo:T=o[dt++],O=o[dt++],h.lineTo(T,O),lt||u.updatePathMinMax(nt,T,O);break;case i.OPS.curveTo:U=T,rt=O,T=o[dt+4],O=o[dt+5],h.bezierCurveTo(o[dt],o[dt+1],o[dt+2],o[dt+3],T,O),u.updateCurvePathMinMax(nt,U,rt,o[dt],o[dt+1],o[dt+2],o[dt+3],T,O,pt),dt+=6;break;case i.OPS.curveTo2:U=T,rt=O,h.bezierCurveTo(T,O,o[dt],o[dt+1],o[dt+2],o[dt+3]),u.updateCurvePathMinMax(nt,U,rt,T,O,o[dt],o[dt+1],o[dt+2],o[dt+3],pt),T=o[dt+2],O=o[dt+3],dt+=4;break;case i.OPS.curveTo3:U=T,rt=O,T=o[dt+2],O=o[dt+3],h.bezierCurveTo(o[dt],o[dt+1],T,O,T,O),u.updateCurvePathMinMax(nt,U,rt,o[dt],o[dt+1],T,O,T,O,pt),dt+=4;break;case i.OPS.closePath:h.closePath();break}lt&&u.updateScalingPathMinMax(nt,pt),u.setCurrentPoint(T,O)}closePath(){this.ctx.closePath()}stroke(s=!0){const o=this.ctx,a=this.current.strokeColor;o.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof a=="object"&&(a!=null&&a.getPattern)?(o.save(),o.strokeStyle=a.getPattern(o,this,(0,f.getCurrentTransformInverse)(o),z.PathType.STROKE),this.rescaleAndStroke(!1),o.restore()):this.rescaleAndStroke(!0)),s&&this.consumePath(this.current.getClippedPathBoundingBox()),o.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(s=!0){const o=this.ctx,a=this.current.fillColor,h=this.current.patternFill;let u=!1;h&&(o.save(),o.fillStyle=a.getPattern(o,this,(0,f.getCurrentTransformInverse)(o),z.PathType.FILL),u=!0);const T=this.current.getClippedPathBoundingBox();this.contentVisible&&T!==null&&(this.pendingEOFill?(o.fill("evenodd"),this.pendingEOFill=!1):o.fill()),u&&o.restore(),s&&this.consumePath(T)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=X}eoClip(){this.pendingClip=tt}beginText(){this.current.textMatrix=i.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const s=this.pendingTextPaths,o=this.ctx;if(s===void 0){o.beginPath();return}o.save(),o.beginPath();for(const a of s)o.setTransform(...a.transform),o.translate(a.x,a.y),a.addToPath(o,a.fontSize);o.restore(),o.clip(),o.beginPath(),delete this.pendingTextPaths}setCharSpacing(s){this.current.charSpacing=s}setWordSpacing(s){this.current.wordSpacing=s}setHScale(s){this.current.textHScale=s/100}setLeading(s){this.current.leading=-s}setFont(s,o){var nt;const a=this.commonObjs.get(s),h=this.current;if(!a)throw new Error("Can't find font for ".concat(s));if(h.fontMatrix=a.fontMatrix||i.FONT_IDENTITY_MATRIX,(h.fontMatrix[0]===0||h.fontMatrix[3]===0)&&(0,i.warn)("Invalid font matrix for font "+s),o<0?(o=-o,h.fontDirection=-1):h.fontDirection=1,this.current.font=a,this.current.fontSize=o,a.isType3Font)return;const u=a.loadedName||"sans-serif",T=((nt=a.systemFontInfo)==null?void 0:nt.css)||'"'.concat(u,'", ').concat(a.fallbackName);let O="normal";a.black?O="900":a.bold&&(O="bold");const U=a.italic?"italic":"normal";let rt=o;o<ct?rt=ct:o>F&&(rt=F),this.current.fontSizeScale=o/rt,this.ctx.font="".concat(U," ").concat(O," ").concat(rt,"px ").concat(T)}setTextRenderingMode(s){this.current.textRenderingMode=s}setTextRise(s){this.current.textRise=s}moveText(s,o){this.current.x=this.current.lineX+=s,this.current.y=this.current.lineY+=o}setLeadingMoveText(s,o){this.setLeading(-o),this.moveText(s,o)}setTextMatrix(s,o,a,h,u,T){this.current.textMatrix=[s,o,a,h,u,T],this.current.textMatrixScale=Math.hypot(s,o),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(s,o,a,h){const u=this.ctx,T=this.current,O=T.font,U=T.textRenderingMode,rt=T.fontSize/T.fontSizeScale,nt=U&i.TextRenderingMode.FILL_STROKE_MASK,lt=!!(U&i.TextRenderingMode.ADD_TO_PATH_FLAG),pt=T.patternFill&&!O.missingFile;let mt;(O.disableFontFace||lt||pt)&&(mt=O.getPathGenerator(this.commonObjs,s)),O.disableFontFace||pt?(u.save(),u.translate(o,a),u.beginPath(),mt(u,rt),h&&u.setTransform(...h),(nt===i.TextRenderingMode.FILL||nt===i.TextRenderingMode.FILL_STROKE)&&u.fill(),(nt===i.TextRenderingMode.STROKE||nt===i.TextRenderingMode.FILL_STROKE)&&u.stroke(),u.restore()):((nt===i.TextRenderingMode.FILL||nt===i.TextRenderingMode.FILL_STROKE)&&u.fillText(s,o,a),(nt===i.TextRenderingMode.STROKE||nt===i.TextRenderingMode.FILL_STROKE)&&u.strokeText(s,o,a)),lt&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,f.getCurrentTransform)(u),x:o,y:a,fontSize:rt,addToPath:mt})}get isFontSubpixelAAEnabled(){const{context:s}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);s.scale(1.5,1),s.fillText("I",0,10);const o=s.getImageData(0,0,10,10).data;let a=!1;for(let h=3;h<o.length;h+=4)if(o[h]>0&&o[h]<255){a=!0;break}return(0,i.shadow)(this,"isFontSubpixelAAEnabled",a)}showText(s){const o=this.current,a=o.font;if(a.isType3Font)return this.showType3Text(s);const h=o.fontSize;if(h===0)return;const u=this.ctx,T=o.fontSizeScale,O=o.charSpacing,U=o.wordSpacing,rt=o.fontDirection,nt=o.textHScale*rt,lt=s.length,pt=a.vertical,mt=pt?1:-1,dt=a.defaultVMetrics,kt=h*o.fontMatrix[0],Nt=o.textRenderingMode===i.TextRenderingMode.FILL&&!a.disableFontFace&&!o.patternFill;u.save(),u.transform(...o.textMatrix),u.translate(o.x,o.y+o.textRise),rt>0?u.scale(nt,-1):u.scale(nt,1);let St;if(o.patternFill){u.save();const gt=o.fillColor.getPattern(u,this,(0,f.getCurrentTransformInverse)(u),z.PathType.FILL);St=(0,f.getCurrentTransform)(u),u.restore(),u.fillStyle=gt}let Ot=o.lineWidth;const bt=o.textMatrixScale;if(bt===0||Ot===0){const gt=o.textRenderingMode&i.TextRenderingMode.FILL_STROKE_MASK;(gt===i.TextRenderingMode.STROKE||gt===i.TextRenderingMode.FILL_STROKE)&&(Ot=this.getSinglePixelWidth())}else Ot/=bt;if(T!==1&&(u.scale(T,T),Ot/=T),u.lineWidth=Ot,a.isInvalidPDFjsFont){const gt=[];let Pt=0;for(const Ct of s)gt.push(Ct.unicode),Pt+=Ct.width;u.fillText(gt.join(""),0,0),o.x+=Pt*kt*nt,u.restore(),this.compose();return}let it=0,st;for(st=0;st<lt;++st){const gt=s[st];if(typeof gt=="number"){it+=mt*gt*h/1e3;continue}let Pt=!1;const Ct=(gt.isSpace?U:0)+O,$t=gt.fontChar,Vt=gt.accent;let Ht,Yt,zt=gt.width;if(pt){const Xt=gt.vmetric||dt,ft=-(gt.vmetric?Xt[1]:zt*.5)*kt,et=Xt[2]*kt;zt=Xt?-Xt[0]:zt,Ht=ft/T,Yt=(it+et)/T}else Ht=it/T,Yt=0;if(a.remeasure&&zt>0){const Xt=u.measureText($t).width*1e3/h*T;if(zt<Xt&&this.isFontSubpixelAAEnabled){const ft=zt/Xt;Pt=!0,u.save(),u.scale(ft,1),Ht/=ft}else zt!==Xt&&(Ht+=(zt-Xt)/2e3*h/T)}if(this.contentVisible&&(gt.isInFont||a.missingFile)){if(Nt&&!Vt)u.fillText($t,Ht,Yt);else if(this.paintChar($t,Ht,Yt,St),Vt){const Xt=Ht+h*Vt.offset.x/T,ft=Yt-h*Vt.offset.y/T;this.paintChar(Vt.fontChar,Xt,ft,St)}}const Gt=pt?zt*kt-Ct*rt:zt*kt+Ct*rt;it+=Gt,Pt&&u.restore()}pt?o.y-=it:o.x+=it*nt,u.restore(),this.compose()}showType3Text(s){const o=this.ctx,a=this.current,h=a.font,u=a.fontSize,T=a.fontDirection,O=h.vertical?1:-1,U=a.charSpacing,rt=a.wordSpacing,nt=a.textHScale*T,lt=a.fontMatrix||i.FONT_IDENTITY_MATRIX,pt=s.length,mt=a.textRenderingMode===i.TextRenderingMode.INVISIBLE;let dt,kt,Nt,St;if(!(mt||u===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,o.save(),o.transform(...a.textMatrix),o.translate(a.x,a.y),o.scale(nt,T),dt=0;dt<pt;++dt){if(kt=s[dt],typeof kt=="number"){St=O*kt*u/1e3,this.ctx.translate(St,0),a.x+=St*nt;continue}const Ot=(kt.isSpace?rt:0)+U,bt=h.charProcOperatorList[kt.operatorListId];if(!bt){(0,i.warn)('Type3 character "'.concat(kt.operatorListId,'" is not available.'));continue}this.contentVisible&&(this.processingType3=kt,this.save(),o.scale(u,u),o.transform(...lt),this.executeOperatorList(bt),this.restore()),Nt=i.Util.applyTransform([kt.width,0],lt)[0]*u+Ot,o.translate(Nt,0),a.x+=Nt*nt}o.restore(),this.processingType3=null}}setCharWidth(s,o){}setCharWidthAndBounds(s,o,a,h,u,T){this.ctx.rect(a,h,u-a,T-h),this.ctx.clip(),this.endPath()}getColorN_Pattern(s){let o;if(s[0]==="TilingPattern"){const a=s[1],h=this.baseTransform||(0,f.getCurrentTransform)(this.ctx),u={createCanvasGraphics:T=>new wt(T,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};o=new z.TilingPattern(s,a,this.ctx,u,h)}else o=this._getPattern(s[1],s[2]);return o}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(s,o,a){const h=i.Util.makeHexColor(s,o,a);this.ctx.strokeStyle=h,this.current.strokeColor=h}setFillRGBColor(s,o,a){const h=i.Util.makeHexColor(s,o,a);this.ctx.fillStyle=h,this.current.fillColor=h,this.current.patternFill=!1}_getPattern(s,o=null){let a;return this.cachedPatterns.has(s)?a=this.cachedPatterns.get(s):(a=(0,z.getShadingPattern)(this.getObject(s)),this.cachedPatterns.set(s,a)),o&&(a.matrix=o),a}shadingFill(s){if(!this.contentVisible)return;const o=this.ctx;this.save();const a=this._getPattern(s);o.fillStyle=a.getPattern(o,this,(0,f.getCurrentTransformInverse)(o),z.PathType.SHADING);const h=(0,f.getCurrentTransformInverse)(o);if(h){const{width:u,height:T}=o.canvas,[O,U,rt,nt]=i.Util.getAxialAlignedBoundingBox([0,0,u,T],h);this.ctx.fillRect(O,U,rt-O,nt-U)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,i.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,i.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(s,o){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(s)&&s.length===6&&this.transform(...s),this.baseTransform=(0,f.getCurrentTransform)(this.ctx),o)){const a=o[2]-o[0],h=o[3]-o[1];this.ctx.rect(o[0],o[1],a,h),this.current.updateRectMinMax((0,f.getCurrentTransform)(this.ctx),o),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(s){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const o=this.ctx;s.isolated||(0,i.info)("TODO: Support non-isolated groups."),s.knockout&&(0,i.warn)("Knockout groups not supported.");const a=(0,f.getCurrentTransform)(o);if(s.matrix&&o.transform(...s.matrix),!s.bbox)throw new Error("Bounding box is required.");let h=i.Util.getAxialAlignedBoundingBox(s.bbox,(0,f.getCurrentTransform)(o));const u=[0,0,o.canvas.width,o.canvas.height];h=i.Util.intersect(h,u)||[0,0,0,0];const T=Math.floor(h[0]),O=Math.floor(h[1]);let U=Math.max(Math.ceil(h[2])-T,1),rt=Math.max(Math.ceil(h[3])-O,1),nt=1,lt=1;U>R&&(nt=U/R,U=R),rt>R&&(lt=rt/R,rt=R),this.current.startNewPathAndClipBox([0,0,U,rt]);let pt="groupAt"+this.groupLevel;s.smask&&(pt+="_smask_"+this.smaskCounter++%2);const mt=this.cachedCanvases.getCanvas(pt,U,rt),dt=mt.context;dt.scale(1/nt,1/lt),dt.translate(-T,-O),dt.transform(...a),s.smask?this.smaskStack.push({canvas:mt.canvas,context:dt,offsetX:T,offsetY:O,scaleX:nt,scaleY:lt,subtype:s.smask.subtype,backdrop:s.smask.backdrop,transferMap:s.smask.transferMap||null,startTransformInverse:null}):(o.setTransform(1,0,0,1,0,0),o.translate(T,O),o.scale(nt,lt),o.save()),c(o,dt),this.ctx=dt,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(o),this.groupLevel++}endGroup(s){if(!this.contentVisible)return;this.groupLevel--;const o=this.ctx,a=this.groupStack.pop();if(this.ctx=a,this.ctx.imageSmoothingEnabled=!1,s.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const h=(0,f.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...h);const u=i.Util.getAxialAlignedBoundingBox([0,0,o.canvas.width,o.canvas.height],h);this.ctx.drawImage(o.canvas,0,0),this.ctx.restore(),this.compose(u)}}beginAnnotation(s,o,a,h,u){if(Y(this,G,tn).call(this),d(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(o)&&o.length===4){const T=o[2]-o[0],O=o[3]-o[1];if(u&&this.annotationCanvasMap){a=a.slice(),a[4]-=o[0],a[5]-=o[1],o=o.slice(),o[0]=o[1]=0,o[2]=T,o[3]=O;const[U,rt]=i.Util.singularValueDecompose2dScale((0,f.getCurrentTransform)(this.ctx)),{viewportScale:nt}=this,lt=Math.ceil(T*this.outputScaleX*nt),pt=Math.ceil(O*this.outputScaleY*nt);this.annotationCanvas=this.canvasFactory.create(lt,pt);const{canvas:mt,context:dt}=this.annotationCanvas;this.annotationCanvasMap.set(s,mt),this.annotationCanvas.savedCtx=this.ctx,this.ctx=dt,this.ctx.save(),this.ctx.setTransform(U,0,0,-rt,0,O*rt),d(this.ctx)}else d(this.ctx),this.ctx.rect(o[0],o[1],T,O),this.ctx.clip(),this.endPath()}this.current=new C(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...a),this.transform(...h)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),Y(this,yt,en).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(s){if(!this.contentVisible)return;const o=s.count;s=this.getObject(s.data,s),s.count=o;const a=this.ctx,h=this.processingType3;if(h&&(h.compiled===void 0&&(h.compiled=y(s)),h.compiled)){h.compiled(a);return}const u=this._createMaskCanvas(s),T=u.canvas;a.save(),a.setTransform(1,0,0,1,0,0),a.drawImage(T,u.offsetX,u.offsetY),a.restore(),this.compose()}paintImageMaskXObjectRepeat(s,o,a=0,h=0,u,T){if(!this.contentVisible)return;s=this.getObject(s.data,s);const O=this.ctx;O.save();const U=(0,f.getCurrentTransform)(O);O.transform(o,a,h,u,0,0);const rt=this._createMaskCanvas(s);O.setTransform(1,0,0,1,rt.offsetX-U[4],rt.offsetY-U[5]);for(let nt=0,lt=T.length;nt<lt;nt+=2){const pt=i.Util.transform(U,[o,a,h,u,T[nt],T[nt+1]]),[mt,dt]=i.Util.applyTransform([0,0],pt);O.drawImage(rt.canvas,mt,dt)}O.restore(),this.compose()}paintImageMaskXObjectGroup(s){if(!this.contentVisible)return;const o=this.ctx,a=this.current.fillColor,h=this.current.patternFill;for(const u of s){const{data:T,width:O,height:U,transform:rt}=u,nt=this.cachedCanvases.getCanvas("maskCanvas",O,U),lt=nt.context;lt.save();const pt=this.getObject(T,u);A(lt,pt),lt.globalCompositeOperation="source-in",lt.fillStyle=h?a.getPattern(lt,this,(0,f.getCurrentTransformInverse)(o),z.PathType.FILL):a,lt.fillRect(0,0,O,U),lt.restore(),o.save(),o.transform(...rt),o.scale(1,-1),p(o,nt.canvas,0,0,O,U,0,-1,1,1),o.restore()}this.compose()}paintImageXObject(s){if(!this.contentVisible)return;const o=this.getObject(s);if(!o){(0,i.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(o)}paintImageXObjectRepeat(s,o,a,h){if(!this.contentVisible)return;const u=this.getObject(s);if(!u){(0,i.warn)("Dependent image isn't ready yet");return}const T=u.width,O=u.height,U=[];for(let rt=0,nt=h.length;rt<nt;rt+=2)U.push({transform:[o,0,0,a,h[rt],h[rt+1]],x:0,y:0,w:T,h:O});this.paintInlineImageXObjectGroup(u,U)}applyTransferMapsToCanvas(s){return this.current.transferMaps!=="none"&&(s.filter=this.current.transferMaps,s.drawImage(s.canvas,0,0),s.filter="none"),s.canvas}applyTransferMapsToBitmap(s){if(this.current.transferMaps==="none")return s.bitmap;const{bitmap:o,width:a,height:h}=s,u=this.cachedCanvases.getCanvas("inlineImage",a,h),T=u.context;return T.filter=this.current.transferMaps,T.drawImage(o,0,0),T.filter="none",u.canvas}paintInlineImageXObject(s){if(!this.contentVisible)return;const o=s.width,a=s.height,h=this.ctx;if(this.save(),!i.isNodeJS){const{filter:O}=h;O!=="none"&&O!==""&&(h.filter="none")}h.scale(1/o,-1/a);let u;if(s.bitmap)u=this.applyTransferMapsToBitmap(s);else if(typeof HTMLElement=="function"&&s instanceof HTMLElement||!s.data)u=s;else{const U=this.cachedCanvases.getCanvas("inlineImage",o,a).context;x(U,s),u=this.applyTransferMapsToCanvas(U)}const T=this._scaleImage(u,(0,f.getCurrentTransformInverse)(h));h.imageSmoothingEnabled=$((0,f.getCurrentTransform)(h),s.interpolate),p(h,T.img,0,0,T.paintWidth,T.paintHeight,0,-a,o,a),this.compose(),this.restore()}paintInlineImageXObjectGroup(s,o){if(!this.contentVisible)return;const a=this.ctx;let h;if(s.bitmap)h=s.bitmap;else{const u=s.width,T=s.height,U=this.cachedCanvases.getCanvas("inlineImage",u,T).context;x(U,s),h=this.applyTransferMapsToCanvas(U)}for(const u of o)a.save(),a.transform(...u.transform),a.scale(1,-1),p(a,h,u.x,u.y,u.w,u.h,0,-1,1,1),a.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(s){}markPointProps(s,o){}beginMarkedContent(s){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(s,o){s==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(o)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(s){const o=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(s);const a=this.ctx;this.pendingClip&&(o||(this.pendingClip===tt?a.clip("evenodd"):a.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),a.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const s=(0,f.getCurrentTransform)(this.ctx);if(s[1]===0&&s[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(s[0]),Math.abs(s[3]));else{const o=Math.abs(s[0]*s[3]-s[2]*s[1]),a=Math.hypot(s[0],s[2]),h=Math.hypot(s[1],s[3]);this._cachedGetSinglePixelWidth=Math.max(a,h)/o}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:s}=this.current,{a:o,b:a,c:h,d:u}=this.ctx.getTransform();let T,O;if(a===0&&h===0){const U=Math.abs(o),rt=Math.abs(u);if(U===rt)if(s===0)T=O=1/U;else{const nt=U*s;T=O=nt<1?1/nt:1}else if(s===0)T=1/U,O=1/rt;else{const nt=U*s,lt=rt*s;T=nt<1?1/nt:1,O=lt<1?1/lt:1}}else{const U=Math.abs(o*u-a*h),rt=Math.hypot(o,a),nt=Math.hypot(h,u);if(s===0)T=nt/U,O=rt/U;else{const lt=s*U;T=nt>lt?nt/lt:1,O=rt>lt?rt/lt:1}}this._cachedScaleForStroking[0]=T,this._cachedScaleForStroking[1]=O}return this._cachedScaleForStroking}rescaleAndStroke(s){const{ctx:o}=this,{lineWidth:a}=this.current,[h,u]=this.getScaleForStroking();if(o.lineWidth=a||1,h===1&&u===1){o.stroke();return}const T=o.getLineDash();if(s&&o.save(),o.scale(h,u),T.length>0){const O=Math.max(h,u);o.setLineDash(T.map(U=>U/O)),o.lineDashOffset/=O}o.stroke(),s&&o.restore()}isContentVisible(){for(let s=this.markedContentStack.length-1;s>=0;s--)if(!this.markedContentStack[s].visible)return!1;return!0}};G=new WeakSet,tn=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},yt=new WeakSet,en=function(){if(this.pageColors){const s=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(s!=="none"){const o=this.ctx.filter;this.ctx.filter=s,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=o}}};let at=wt;n.CanvasGraphics=at;for(const k in i.OPS)at.prototype[k]!==void 0&&(at.prototype[i.OPS[k]]=at.prototype[k])},(D,n,L)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.TilingPattern=n.PathType=void 0,n.getShadingPattern=P;var i=L(1),f=L(6);const z={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};n.PathType=z;function H(y,C){if(!C)return;const x=C[2]-C[0],A=C[3]-C[1],c=new Path2D;c.rect(C[0],C[1],x,A),y.clip(c)}class ct{constructor(){this.constructor===ct&&(0,i.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,i.unreachable)("Abstract method `getPattern` called.")}}class F extends ct{constructor(C){super(),this._type=C[1],this._bbox=C[2],this._colorStops=C[3],this._p0=C[4],this._p1=C[5],this._r0=C[6],this._r1=C[7],this.matrix=null}_createGradient(C){let x;this._type==="axial"?x=C.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(x=C.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const A of this._colorStops)x.addColorStop(A[0],A[1]);return x}getPattern(C,x,A,c){let d;if(c===z.STROKE||c===z.FILL){const M=x.current.getClippedPathBoundingBox(c,(0,f.getCurrentTransform)(C))||[0,0,0,0],b=Math.ceil(M[2]-M[0])||1,l=Math.ceil(M[3]-M[1])||1,w=x.cachedCanvases.getCanvas("pattern",b,l,!0),g=w.context;g.clearRect(0,0,g.canvas.width,g.canvas.height),g.beginPath(),g.rect(0,0,g.canvas.width,g.canvas.height),g.translate(-M[0],-M[1]),A=i.Util.transform(A,[1,0,0,1,M[0],M[1]]),g.transform(...x.baseTransform),this.matrix&&g.transform(...this.matrix),H(g,this._bbox),g.fillStyle=this._createGradient(g),g.fill(),d=C.createPattern(w.canvas,"no-repeat");const $=new DOMMatrix(A);d.setTransform($)}else H(C,this._bbox),d=this._createGradient(C);return d}}function R(y,C,x,A,c,d,M,b){const l=C.coords,w=C.colors,g=y.data,$=y.width*4;let V;l[x+1]>l[A+1]&&(V=x,x=A,A=V,V=d,d=M,M=V),l[A+1]>l[c+1]&&(V=A,A=c,c=V,V=M,M=b,b=V),l[x+1]>l[A+1]&&(V=x,x=A,A=V,V=d,d=M,M=V);const S=(l[x]+C.offsetX)*C.scaleX,X=(l[x+1]+C.offsetY)*C.scaleY,tt=(l[A]+C.offsetX)*C.scaleX,at=(l[A+1]+C.offsetY)*C.scaleY,G=(l[c]+C.offsetX)*C.scaleX,ut=(l[c+1]+C.offsetY)*C.scaleY;if(X>=ut)return;const yt=w[d],Tt=w[d+1],wt=w[d+2],k=w[M],s=w[M+1],o=w[M+2],a=w[b],h=w[b+1],u=w[b+2],T=Math.round(X),O=Math.round(ut);let U,rt,nt,lt,pt,mt,dt,kt;for(let Nt=T;Nt<=O;Nt++){if(Nt<at){const st=Nt<X?0:(X-Nt)/(X-at);U=S-(S-tt)*st,rt=yt-(yt-k)*st,nt=Tt-(Tt-s)*st,lt=wt-(wt-o)*st}else{let st;Nt>ut?st=1:at===ut?st=0:st=(at-Nt)/(at-ut),U=tt-(tt-G)*st,rt=k-(k-a)*st,nt=s-(s-h)*st,lt=o-(o-u)*st}let St;Nt<X?St=0:Nt>ut?St=1:St=(X-Nt)/(X-ut),pt=S-(S-G)*St,mt=yt-(yt-a)*St,dt=Tt-(Tt-h)*St,kt=wt-(wt-u)*St;const Ot=Math.round(Math.min(U,pt)),bt=Math.round(Math.max(U,pt));let it=$*Nt+Ot*4;for(let st=Ot;st<=bt;st++)St=(U-st)/(U-pt),St<0?St=0:St>1&&(St=1),g[it++]=rt-(rt-mt)*St|0,g[it++]=nt-(nt-dt)*St|0,g[it++]=lt-(lt-kt)*St|0,g[it++]=255}}function m(y,C,x){const A=C.coords,c=C.colors;let d,M;switch(C.type){case"lattice":const b=C.verticesPerRow,l=Math.floor(A.length/b)-1,w=b-1;for(d=0;d<l;d++){let g=d*b;for(let $=0;$<w;$++,g++)R(y,x,A[g],A[g+1],A[g+b],c[g],c[g+1],c[g+b]),R(y,x,A[g+b+1],A[g+1],A[g+b],c[g+b+1],c[g+1],c[g+b])}break;case"triangles":for(d=0,M=A.length;d<M;d+=3)R(y,x,A[d],A[d+1],A[d+2],c[d],c[d+1],c[d+2]);break;default:throw new Error("illegal figure")}}class I extends ct{constructor(C){super(),this._coords=C[2],this._colors=C[3],this._figures=C[4],this._bounds=C[5],this._bbox=C[7],this._background=C[8],this.matrix=null}_createMeshCanvas(C,x,A){const b=Math.floor(this._bounds[0]),l=Math.floor(this._bounds[1]),w=Math.ceil(this._bounds[2])-b,g=Math.ceil(this._bounds[3])-l,$=Math.min(Math.ceil(Math.abs(w*C[0]*1.1)),3e3),V=Math.min(Math.ceil(Math.abs(g*C[1]*1.1)),3e3),S=w/$,X=g/V,tt={coords:this._coords,colors:this._colors,offsetX:-b,offsetY:-l,scaleX:1/S,scaleY:1/X},at=$+2*2,G=V+2*2,ut=A.getCanvas("mesh",at,G,!1),yt=ut.context,Tt=yt.createImageData($,V);if(x){const k=Tt.data;for(let s=0,o=k.length;s<o;s+=4)k[s]=x[0],k[s+1]=x[1],k[s+2]=x[2],k[s+3]=255}for(const k of this._figures)m(Tt,k,tt);return yt.putImageData(Tt,2,2),{canvas:ut.canvas,offsetX:b-2*S,offsetY:l-2*X,scaleX:S,scaleY:X}}getPattern(C,x,A,c){H(C,this._bbox);let d;if(c===z.SHADING)d=i.Util.singularValueDecompose2dScale((0,f.getCurrentTransform)(C));else if(d=i.Util.singularValueDecompose2dScale(x.baseTransform),this.matrix){const b=i.Util.singularValueDecompose2dScale(this.matrix);d=[d[0]*b[0],d[1]*b[1]]}const M=this._createMeshCanvas(d,c===z.SHADING?null:this._background,x.cachedCanvases);return c!==z.SHADING&&(C.setTransform(...x.baseTransform),this.matrix&&C.transform(...this.matrix)),C.translate(M.offsetX,M.offsetY),C.scale(M.scaleX,M.scaleY),C.createPattern(M.canvas,"no-repeat")}}class N extends ct{getPattern(){return"hotpink"}}function P(y){switch(y[0]){case"RadialAxial":return new F(y);case"Mesh":return new I(y);case"Dummy":return new N}throw new Error("Unknown IR type: ".concat(y[0]))}const E={COLORED:1,UNCOLORED:2},p=class p{constructor(C,x,A,c,d){this.operatorList=C[2],this.matrix=C[3]||[1,0,0,1,0,0],this.bbox=C[4],this.xstep=C[5],this.ystep=C[6],this.paintType=C[7],this.tilingType=C[8],this.color=x,this.ctx=A,this.canvasGraphicsFactory=c,this.baseTransform=d}createPatternCanvas(C){const x=this.operatorList,A=this.bbox,c=this.xstep,d=this.ystep,M=this.paintType,b=this.tilingType,l=this.color,w=this.canvasGraphicsFactory;(0,i.info)("TilingType: "+b);const g=A[0],$=A[1],V=A[2],S=A[3],X=i.Util.singularValueDecompose2dScale(this.matrix),tt=i.Util.singularValueDecompose2dScale(this.baseTransform),at=[X[0]*tt[0],X[1]*tt[1]],G=this.getSizeAndScale(c,this.ctx.canvas.width,at[0]),ut=this.getSizeAndScale(d,this.ctx.canvas.height,at[1]),yt=C.cachedCanvases.getCanvas("pattern",G.size,ut.size,!0),Tt=yt.context,wt=w.createCanvasGraphics(Tt);wt.groupLevel=C.groupLevel,this.setFillAndStrokeStyleToContext(wt,M,l);let k=g,s=$,o=V,a=S;return g<0&&(k=0,o+=Math.abs(g)),$<0&&(s=0,a+=Math.abs($)),Tt.translate(-(G.scale*k),-(ut.scale*s)),wt.transform(G.scale,0,0,ut.scale,0,0),Tt.save(),this.clipBbox(wt,k,s,o,a),wt.baseTransform=(0,f.getCurrentTransform)(wt.ctx),wt.executeOperatorList(x),wt.endDrawing(),{canvas:yt.canvas,scaleX:G.scale,scaleY:ut.scale,offsetX:k,offsetY:s}}getSizeAndScale(C,x,A){C=Math.abs(C);const c=Math.max(p.MAX_PATTERN_SIZE,x);let d=Math.ceil(C*A);return d>=c?d=c:A=d/C,{scale:A,size:d}}clipBbox(C,x,A,c,d){const M=c-x,b=d-A;C.ctx.rect(x,A,M,b),C.current.updateRectMinMax((0,f.getCurrentTransform)(C.ctx),[x,A,c,d]),C.clip(),C.endPath()}setFillAndStrokeStyleToContext(C,x,A){const c=C.ctx,d=C.current;switch(x){case E.COLORED:const M=this.ctx;c.fillStyle=M.fillStyle,c.strokeStyle=M.strokeStyle,d.fillColor=M.fillStyle,d.strokeColor=M.strokeStyle;break;case E.UNCOLORED:const b=i.Util.makeHexColor(A[0],A[1],A[2]);c.fillStyle=b,c.strokeStyle=b,d.fillColor=b,d.strokeColor=b;break;default:throw new i.FormatError("Unsupported paint type: ".concat(x))}}getPattern(C,x,A,c){let d=A;c!==z.SHADING&&(d=i.Util.transform(d,x.baseTransform),this.matrix&&(d=i.Util.transform(d,this.matrix)));const M=this.createPatternCanvas(x);let b=new DOMMatrix(d);b=b.translate(M.offsetX,M.offsetY),b=b.scale(1/M.scaleX,1/M.scaleY);const l=C.createPattern(M.canvas,"repeat");return l.setTransform(b),l}};se(p,"MAX_PATTERN_SIZE",3e3);let v=p;n.TilingPattern=v},(D,n,L)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.convertBlackAndWhiteToRGBA=z,n.convertToRGBA=f,n.grayToRGBA=ct;var i=L(1);function f(F){switch(F.kind){case i.ImageKind.GRAYSCALE_1BPP:return z(F);case i.ImageKind.RGB_24BPP:return H(F)}return null}function z({src:F,srcPos:R=0,dest:m,width:I,height:N,nonBlackColor:P=4294967295,inverseDecode:E=!1}){const v=i.FeatureTest.isLittleEndian?4278190080:255,[p,y]=E?[P,v]:[v,P],C=I>>3,x=I&7,A=F.length;m=new Uint32Array(m.buffer);let c=0;for(let d=0;d<N;d++){for(const b=R+C;R<b;R++){const l=R<A?F[R]:255;m[c++]=l&128?y:p,m[c++]=l&64?y:p,m[c++]=l&32?y:p,m[c++]=l&16?y:p,m[c++]=l&8?y:p,m[c++]=l&4?y:p,m[c++]=l&2?y:p,m[c++]=l&1?y:p}if(x===0)continue;const M=R<A?F[R++]:255;for(let b=0;b<x;b++)m[c++]=M&1<<7-b?y:p}return{srcPos:R,destPos:c}}function H({src:F,srcPos:R=0,dest:m,destPos:I=0,width:N,height:P}){let E=0;const v=F.length>>2,p=new Uint32Array(F.buffer,R,v);if(i.FeatureTest.isLittleEndian){for(;E<v-2;E+=3,I+=4){const y=p[E],C=p[E+1],x=p[E+2];m[I]=y|4278190080,m[I+1]=y>>>24|C<<8|4278190080,m[I+2]=C>>>16|x<<16|4278190080,m[I+3]=x>>>8|4278190080}for(let y=E*4,C=F.length;y<C;y+=3)m[I++]=F[y]|F[y+1]<<8|F[y+2]<<16|4278190080}else{for(;E<v-2;E+=3,I+=4){const y=p[E],C=p[E+1],x=p[E+2];m[I]=y|255,m[I+1]=y<<24|C>>>8|255,m[I+2]=C<<16|x>>>16|255,m[I+3]=x<<8|255}for(let y=E*4,C=F.length;y<C;y+=3)m[I++]=F[y]<<24|F[y+1]<<16|F[y+2]<<8|255}return{srcPos:R,destPos:I}}function ct(F,R){if(i.FeatureTest.isLittleEndian)for(let m=0,I=F.length;m<I;m++)R[m]=F[m]*65793|4278190080;else for(let m=0,I=F.length;m<I;m++)R[m]=F[m]*16843008|255}},(D,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.GlobalWorkerOptions=void 0;const L=Object.create(null);n.GlobalWorkerOptions=L,L.workerPort=null,L.workerSrc=""},(D,n,L)=>{var F,Fn,m,Mn,N,ke;Object.defineProperty(n,"__esModule",{value:!0}),n.MessageHandler=void 0;var i=L(1);const f={UNKNOWN:0,DATA:1,ERROR:2},z={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function H(E){switch(E instanceof Error||typeof E=="object"&&E!==null||(0,i.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),E.name){case"AbortException":return new i.AbortException(E.message);case"MissingPDFException":return new i.MissingPDFException(E.message);case"PasswordException":return new i.PasswordException(E.message,E.code);case"UnexpectedResponseException":return new i.UnexpectedResponseException(E.message,E.status);case"UnknownErrorException":return new i.UnknownErrorException(E.message,E.details);default:return new i.UnknownErrorException(E.message,E.toString())}}class ct{constructor(v,p,y){W(this,F);W(this,m);W(this,N);this.sourceName=v,this.targetName=p,this.comObj=y,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=C=>{const x=C.data;if(x.targetName!==this.sourceName)return;if(x.stream){Y(this,m,Mn).call(this,x);return}if(x.callback){const c=x.callbackId,d=this.callbackCapabilities[c];if(!d)throw new Error("Cannot resolve callback ".concat(c));if(delete this.callbackCapabilities[c],x.callback===f.DATA)d.resolve(x.data);else if(x.callback===f.ERROR)d.reject(H(x.reason));else throw new Error("Unexpected callback case");return}const A=this.actionHandler[x.action];if(!A)throw new Error("Unknown action from worker: ".concat(x.action));if(x.callbackId){const c=this.sourceName,d=x.sourceName;new Promise(function(M){M(A(x.data))}).then(function(M){y.postMessage({sourceName:c,targetName:d,callback:f.DATA,callbackId:x.callbackId,data:M})},function(M){y.postMessage({sourceName:c,targetName:d,callback:f.ERROR,callbackId:x.callbackId,reason:H(M)})});return}if(x.streamId){Y(this,F,Fn).call(this,x);return}A(x.data)},y.addEventListener("message",this._onComObjOnMessage)}on(v,p){const y=this.actionHandler;if(y[v])throw new Error('There is already an actionName called "'.concat(v,'"'));y[v]=p}send(v,p,y){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:v,data:p},y)}sendWithPromise(v,p,y){const C=this.callbackId++,x=new i.PromiseCapability;this.callbackCapabilities[C]=x;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:v,callbackId:C,data:p},y)}catch(A){x.reject(A)}return x.promise}sendWithStream(v,p,y,C){const x=this.streamId++,A=this.sourceName,c=this.targetName,d=this.comObj;return new ReadableStream({start:M=>{const b=new i.PromiseCapability;return this.streamControllers[x]={controller:M,startCall:b,pullCall:null,cancelCall:null,isClosed:!1},d.postMessage({sourceName:A,targetName:c,action:v,streamId:x,data:p,desiredSize:M.desiredSize},C),b.promise},pull:M=>{const b=new i.PromiseCapability;return this.streamControllers[x].pullCall=b,d.postMessage({sourceName:A,targetName:c,stream:z.PULL,streamId:x,desiredSize:M.desiredSize}),b.promise},cancel:M=>{(0,i.assert)(M instanceof Error,"cancel must have a valid reason");const b=new i.PromiseCapability;return this.streamControllers[x].cancelCall=b,this.streamControllers[x].isClosed=!0,d.postMessage({sourceName:A,targetName:c,stream:z.CANCEL,streamId:x,reason:H(M)}),b.promise}},y)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}F=new WeakSet,Fn=function(v){const p=v.streamId,y=this.sourceName,C=v.sourceName,x=this.comObj,A=this,c=this.actionHandler[v.action],d={enqueue(M,b=1,l){if(this.isCancelled)return;const w=this.desiredSize;this.desiredSize-=b,w>0&&this.desiredSize<=0&&(this.sinkCapability=new i.PromiseCapability,this.ready=this.sinkCapability.promise),x.postMessage({sourceName:y,targetName:C,stream:z.ENQUEUE,streamId:p,chunk:M},l)},close(){this.isCancelled||(this.isCancelled=!0,x.postMessage({sourceName:y,targetName:C,stream:z.CLOSE,streamId:p}),delete A.streamSinks[p])},error(M){(0,i.assert)(M instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,x.postMessage({sourceName:y,targetName:C,stream:z.ERROR,streamId:p,reason:H(M)}))},sinkCapability:new i.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:v.desiredSize,ready:null};d.sinkCapability.resolve(),d.ready=d.sinkCapability.promise,this.streamSinks[p]=d,new Promise(function(M){M(c(v.data,d))}).then(function(){x.postMessage({sourceName:y,targetName:C,stream:z.START_COMPLETE,streamId:p,success:!0})},function(M){x.postMessage({sourceName:y,targetName:C,stream:z.START_COMPLETE,streamId:p,reason:H(M)})})},m=new WeakSet,Mn=function(v){const p=v.streamId,y=this.sourceName,C=v.sourceName,x=this.comObj,A=this.streamControllers[p],c=this.streamSinks[p];switch(v.stream){case z.START_COMPLETE:v.success?A.startCall.resolve():A.startCall.reject(H(v.reason));break;case z.PULL_COMPLETE:v.success?A.pullCall.resolve():A.pullCall.reject(H(v.reason));break;case z.PULL:if(!c){x.postMessage({sourceName:y,targetName:C,stream:z.PULL_COMPLETE,streamId:p,success:!0});break}c.desiredSize<=0&&v.desiredSize>0&&c.sinkCapability.resolve(),c.desiredSize=v.desiredSize,new Promise(function(d){var M;d((M=c.onPull)==null?void 0:M.call(c))}).then(function(){x.postMessage({sourceName:y,targetName:C,stream:z.PULL_COMPLETE,streamId:p,success:!0})},function(d){x.postMessage({sourceName:y,targetName:C,stream:z.PULL_COMPLETE,streamId:p,reason:H(d)})});break;case z.ENQUEUE:if((0,i.assert)(A,"enqueue should have stream controller"),A.isClosed)break;A.controller.enqueue(v.chunk);break;case z.CLOSE:if((0,i.assert)(A,"close should have stream controller"),A.isClosed)break;A.isClosed=!0,A.controller.close(),Y(this,N,ke).call(this,A,p);break;case z.ERROR:(0,i.assert)(A,"error should have stream controller"),A.controller.error(H(v.reason)),Y(this,N,ke).call(this,A,p);break;case z.CANCEL_COMPLETE:v.success?A.cancelCall.resolve():A.cancelCall.reject(H(v.reason)),Y(this,N,ke).call(this,A,p);break;case z.CANCEL:if(!c)break;new Promise(function(d){var M;d((M=c.onCancel)==null?void 0:M.call(c,H(v.reason)))}).then(function(){x.postMessage({sourceName:y,targetName:C,stream:z.CANCEL_COMPLETE,streamId:p,success:!0})},function(d){x.postMessage({sourceName:y,targetName:C,stream:z.CANCEL_COMPLETE,streamId:p,reason:H(d)})}),c.sinkCapability.reject(H(v.reason)),c.isCancelled=!0,delete this.streamSinks[p];break;default:throw new Error("Unexpected stream case")}},N=new WeakSet,ke=async function(v,p){var y,C,x;await Promise.allSettled([(y=v.startCall)==null?void 0:y.promise,(C=v.pullCall)==null?void 0:C.promise,(x=v.cancelCall)==null?void 0:x.promise]),delete this.streamControllers[p]},n.MessageHandler=ct},(D,n,L)=>{var z,H;Object.defineProperty(n,"__esModule",{value:!0}),n.Metadata=void 0;var i=L(1);class f{constructor({parsedData:F,rawData:R}){W(this,z,void 0);W(this,H,void 0);ot(this,z,F),ot(this,H,R)}getRaw(){return t(this,H)}get(F){var R;return(R=t(this,z).get(F))!=null?R:null}getAll(){return(0,i.objectFromMap)(t(this,z))}has(F){return t(this,z).has(F)}}z=new WeakMap,H=new WeakMap,n.Metadata=f},(D,n,L)=>{var F,R,m,I,N,P,nn;Object.defineProperty(n,"__esModule",{value:!0}),n.OptionalContentConfig=void 0;var i=L(1),f=L(8);const z=Symbol("INTERNAL");class H{constructor(p,y){W(this,F,!0);this.name=p,this.intent=y}get visible(){return t(this,F)}_setVisible(p,y){p!==z&&(0,i.unreachable)("Internal method `_setVisible` called."),ot(this,F,y)}}F=new WeakMap;class ct{constructor(p){W(this,P);W(this,R,null);W(this,m,new Map);W(this,I,null);W(this,N,null);if(this.name=null,this.creator=null,p!==null){this.name=p.name,this.creator=p.creator,ot(this,N,p.order);for(const y of p.groups)t(this,m).set(y.id,new H(y.name,y.intent));if(p.baseState==="OFF")for(const y of t(this,m).values())y._setVisible(z,!1);for(const y of p.on)t(this,m).get(y)._setVisible(z,!0);for(const y of p.off)t(this,m).get(y)._setVisible(z,!1);ot(this,I,this.getHash())}}isVisible(p){if(t(this,m).size===0)return!0;if(!p)return(0,i.warn)("Optional content group not defined."),!0;if(p.type==="OCG")return t(this,m).has(p.id)?t(this,m).get(p.id).visible:((0,i.warn)("Optional content group not found: ".concat(p.id)),!0);if(p.type==="OCMD"){if(p.expression)return Y(this,P,nn).call(this,p.expression);if(!p.policy||p.policy==="AnyOn"){for(const y of p.ids){if(!t(this,m).has(y))return(0,i.warn)("Optional content group not found: ".concat(y)),!0;if(t(this,m).get(y).visible)return!0}return!1}else if(p.policy==="AllOn"){for(const y of p.ids){if(!t(this,m).has(y))return(0,i.warn)("Optional content group not found: ".concat(y)),!0;if(!t(this,m).get(y).visible)return!1}return!0}else if(p.policy==="AnyOff"){for(const y of p.ids){if(!t(this,m).has(y))return(0,i.warn)("Optional content group not found: ".concat(y)),!0;if(!t(this,m).get(y).visible)return!0}return!1}else if(p.policy==="AllOff"){for(const y of p.ids){if(!t(this,m).has(y))return(0,i.warn)("Optional content group not found: ".concat(y)),!0;if(t(this,m).get(y).visible)return!1}return!0}return(0,i.warn)("Unknown optional content policy ".concat(p.policy,".")),!0}return(0,i.warn)("Unknown group type ".concat(p.type,".")),!0}setVisibility(p,y=!0){if(!t(this,m).has(p)){(0,i.warn)("Optional content group not found: ".concat(p));return}t(this,m).get(p)._setVisible(z,!!y),ot(this,R,null)}get hasInitialVisibility(){return t(this,I)===null||this.getHash()===t(this,I)}getOrder(){return t(this,m).size?t(this,N)?t(this,N).slice():[...t(this,m).keys()]:null}getGroups(){return t(this,m).size>0?(0,i.objectFromMap)(t(this,m)):null}getGroup(p){return t(this,m).get(p)||null}getHash(){if(t(this,R)!==null)return t(this,R);const p=new f.MurmurHash3_64;for(const[y,C]of t(this,m))p.update("".concat(y,":").concat(C.visible));return ot(this,R,p.hexdigest())}}R=new WeakMap,m=new WeakMap,I=new WeakMap,N=new WeakMap,P=new WeakSet,nn=function(p){const y=p.length;if(y<2)return!0;const C=p[0];for(let x=1;x<y;x++){const A=p[x];let c;if(Array.isArray(A))c=Y(this,P,nn).call(this,A);else if(t(this,m).has(A))c=t(this,m).get(A).visible;else return(0,i.warn)("Optional content group not found: ".concat(A)),!0;switch(C){case"And":if(!c)return!1;break;case"Or":if(c)return!0;break;case"Not":return!c;default:return!0}}return C==="And"},n.OptionalContentConfig=ct},(D,n,L)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.PDFDataTransportStream=void 0;var i=L(1),f=L(6);class z{constructor({length:R,initialData:m,progressiveDone:I=!1,contentDispositionFilename:N=null,disableRange:P=!1,disableStream:E=!1},v){if((0,i.assert)(v,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=I,this._contentDispositionFilename=N,(m==null?void 0:m.length)>0){const p=m instanceof Uint8Array&&m.byteLength===m.buffer.byteLength?m.buffer:new Uint8Array(m).buffer;this._queuedChunks.push(p)}this._pdfDataRangeTransport=v,this._isStreamingSupported=!E,this._isRangeSupported=!P,this._contentLength=R,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((p,y)=>{this._onReceiveData({begin:p,chunk:y})}),this._pdfDataRangeTransport.addProgressListener((p,y)=>{this._onProgress({loaded:p,total:y})}),this._pdfDataRangeTransport.addProgressiveReadListener(p=>{this._onReceiveData({chunk:p})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:R,chunk:m}){const I=m instanceof Uint8Array&&m.byteLength===m.buffer.byteLength?m.buffer:new Uint8Array(m).buffer;if(R===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(I):this._queuedChunks.push(I);else{const N=this._rangeReaders.some(function(P){return P._begin!==R?!1:(P._enqueue(I),!0)});(0,i.assert)(N,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var R,m;return(m=(R=this._fullRequestReader)==null?void 0:R._loaded)!=null?m:0}_onProgress(R){var m,I,N,P;R.total===void 0?(I=(m=this._rangeReaders[0])==null?void 0:m.onProgress)==null||I.call(m,{loaded:R.loaded}):(P=(N=this._fullRequestReader)==null?void 0:N.onProgress)==null||P.call(N,{loaded:R.loaded,total:R.total})}_onProgressiveDone(){var R;(R=this._fullRequestReader)==null||R.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(R){const m=this._rangeReaders.indexOf(R);m>=0&&this._rangeReaders.splice(m,1)}getFullReader(){(0,i.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const R=this._queuedChunks;return this._queuedChunks=null,new H(this,R,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(R,m){if(m<=this._progressiveDataLength)return null;const I=new ct(this,R,m);return this._pdfDataRangeTransport.requestDataRange(R,m),this._rangeReaders.push(I),I}cancelAllRequests(R){var m;(m=this._fullRequestReader)==null||m.cancel(R);for(const I of this._rangeReaders.slice(0))I.cancel(R);this._pdfDataRangeTransport.abort()}}n.PDFDataTransportStream=z;class H{constructor(R,m,I=!1,N=null){this._stream=R,this._done=I||!1,this._filename=(0,f.isPdfFile)(N)?N:null,this._queuedChunks=m||[],this._loaded=0;for(const P of this._queuedChunks)this._loaded+=P.byteLength;this._requests=[],this._headersReady=Promise.resolve(),R._fullRequestReader=this,this.onProgress=null}_enqueue(R){this._done||(this._requests.length>0?this._requests.shift().resolve({value:R,done:!1}):this._queuedChunks.push(R),this._loaded+=R.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const R=new i.PromiseCapability;return this._requests.push(R),R.promise}cancel(R){this._done=!0;for(const m of this._requests)m.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class ct{constructor(R,m,I){this._stream=R,this._begin=m,this._end=I,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(R){if(!this._done){if(this._requests.length===0)this._queuedChunk=R;else{this._requests.shift().resolve({value:R,done:!1});for(const I of this._requests)I.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const m=this._queuedChunk;return this._queuedChunk=null,{value:m,done:!1}}if(this._done)return{value:void 0,done:!0};const R=new i.PromiseCapability;return this._requests.push(R),R.promise}cancel(R){this._done=!0;for(const m of this._requests)m.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(D,n,L)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.PDFFetchStream=void 0;var i=L(1),f=L(20);function z(I,N,P){return{method:"GET",headers:I,signal:P.signal,mode:"cors",credentials:N?"include":"same-origin",redirect:"follow"}}function H(I){const N=new Headers;for(const P in I){const E=I[P];E!==void 0&&N.append(P,E)}return N}function ct(I){return I instanceof Uint8Array?I.buffer:I instanceof ArrayBuffer?I:((0,i.warn)("getArrayBuffer - unexpected data format: ".concat(I)),new Uint8Array(I).buffer)}class F{constructor(N){this.source=N,this.isHttp=/^https?:/i.test(N.url),this.httpHeaders=this.isHttp&&N.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var N,P;return(P=(N=this._fullRequestReader)==null?void 0:N._loaded)!=null?P:0}getFullReader(){return(0,i.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new R(this),this._fullRequestReader}getRangeReader(N,P){if(P<=this._progressiveDataLength)return null;const E=new m(this,N,P);return this._rangeRequestReaders.push(E),E}cancelAllRequests(N){var P;(P=this._fullRequestReader)==null||P.cancel(N);for(const E of this._rangeRequestReaders.slice(0))E.cancel(N)}}n.PDFFetchStream=F;class R{constructor(N){this._stream=N,this._reader=null,this._loaded=0,this._filename=null;const P=N.source;this._withCredentials=P.withCredentials||!1,this._contentLength=P.length,this._headersCapability=new i.PromiseCapability,this._disableRange=P.disableRange||!1,this._rangeChunkSize=P.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!P.disableStream,this._isRangeSupported=!P.disableRange,this._headers=H(this._stream.httpHeaders);const E=P.url;fetch(E,z(this._headers,this._withCredentials,this._abortController)).then(v=>{if(!(0,f.validateResponseStatus)(v.status))throw(0,f.createResponseStatusError)(v.status,E);this._reader=v.body.getReader(),this._headersCapability.resolve();const p=x=>v.headers.get(x),{allowRangeRequests:y,suggestedLength:C}=(0,f.validateRangeRequestCapabilities)({getResponseHeader:p,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=y,this._contentLength=C||this._contentLength,this._filename=(0,f.extractFilenameFromHeader)(p),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new i.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var E;await this._headersCapability.promise;const{value:N,done:P}=await this._reader.read();return P?{value:N,done:P}:(this._loaded+=N.byteLength,(E=this.onProgress)==null||E.call(this,{loaded:this._loaded,total:this._contentLength}),{value:ct(N),done:!1})}cancel(N){var P;(P=this._reader)==null||P.cancel(N),this._abortController.abort()}}class m{constructor(N,P,E){this._stream=N,this._reader=null,this._loaded=0;const v=N.source;this._withCredentials=v.withCredentials||!1,this._readCapability=new i.PromiseCapability,this._isStreamingSupported=!v.disableStream,this._abortController=new AbortController,this._headers=H(this._stream.httpHeaders),this._headers.append("Range","bytes=".concat(P,"-").concat(E-1));const p=v.url;fetch(p,z(this._headers,this._withCredentials,this._abortController)).then(y=>{if(!(0,f.validateResponseStatus)(y.status))throw(0,f.createResponseStatusError)(y.status,p);this._readCapability.resolve(),this._reader=y.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var E;await this._readCapability.promise;const{value:N,done:P}=await this._reader.read();return P?{value:N,done:P}:(this._loaded+=N.byteLength,(E=this.onProgress)==null||E.call(this,{loaded:this._loaded}),{value:ct(N),done:!1})}cancel(N){var P;(P=this._reader)==null||P.cancel(N),this._abortController.abort()}}},(D,n,L)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.createResponseStatusError=F,n.extractFilenameFromHeader=ct,n.validateRangeRequestCapabilities=H,n.validateResponseStatus=R;var i=L(1),f=L(21),z=L(6);function H({getResponseHeader:m,isHttp:I,rangeChunkSize:N,disableRange:P}){const E={allowRangeRequests:!1,suggestedLength:void 0},v=parseInt(m("Content-Length"),10);return!Number.isInteger(v)||(E.suggestedLength=v,v<=2*N)||P||!I||m("Accept-Ranges")!=="bytes"||(m("Content-Encoding")||"identity")!=="identity"||(E.allowRangeRequests=!0),E}function ct(m){const I=m("Content-Disposition");if(I){let N=(0,f.getFilenameFromContentDispositionHeader)(I);if(N.includes("%"))try{N=decodeURIComponent(N)}catch(P){}if((0,z.isPdfFile)(N))return N}return null}function F(m,I){return m===404||m===0&&I.startsWith("file:")?new i.MissingPDFException('Missing PDF "'+I+'".'):new i.UnexpectedResponseException("Unexpected server response (".concat(m,') while retrieving PDF "').concat(I,'".'),m)}function R(m){return m===200||m===206}},(D,n,L)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.getFilenameFromContentDispositionHeader=f;var i=L(1);function f(z){let H=!0,ct=F("filename\\*","i").exec(z);if(ct){ct=ct[1];let v=N(ct);return v=unescape(v),v=P(v),v=E(v),m(v)}if(ct=I(z),ct){const v=E(ct);return m(v)}if(ct=F("filename","i").exec(z),ct){ct=ct[1];let v=N(ct);return v=E(v),m(v)}function F(v,p){return new RegExp("(?:^|;)\\s*"+v+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',p)}function R(v,p){if(v){if(!/^[\x00-\xFF]+$/.test(p))return p;try{const y=new TextDecoder(v,{fatal:!0}),C=(0,i.stringToBytes)(p);p=y.decode(C),H=!1}catch(y){}}return p}function m(v){return H&&/[\x80-\xff]/.test(v)&&(v=R("utf-8",v),H&&(v=R("iso-8859-1",v))),v}function I(v){const p=[];let y;const C=F("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(y=C.exec(v))!==null;){let[,A,c,d]=y;if(A=parseInt(A,10),A in p){if(A===0)break;continue}p[A]=[c,d]}const x=[];for(let A=0;A<p.length&&A in p;++A){let[c,d]=p[A];d=N(d),c&&(d=unescape(d),A===0&&(d=P(d))),x.push(d)}return x.join("")}function N(v){if(v.startsWith('"')){const p=v.slice(1).split('\\"');for(let y=0;y<p.length;++y){const C=p[y].indexOf('"');C!==-1&&(p[y]=p[y].slice(0,C),p.length=y+1),p[y]=p[y].replaceAll(/\\(.)/g,"$1")}v=p.join('"')}return v}function P(v){const p=v.indexOf("'");if(p===-1)return v;const y=v.slice(0,p),x=v.slice(p+1).replace(/^[^']*'/,"");return R(y,x)}function E(v){return!v.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(v)?v:v.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(p,y,C,x){if(C==="q"||C==="Q")return x=x.replaceAll("_"," "),x=x.replaceAll(/=([0-9a-fA-F]{2})/g,function(A,c){return String.fromCharCode(parseInt(c,16))}),R(y,x);try{x=atob(x)}catch(A){}return R(y,x)})}return""}},(D,n,L)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.PDFNetworkStream=void 0;var i=L(1),f=L(20);const z=200,H=206;function ct(N){const P=N.response;return typeof P!="string"?P:(0,i.stringToBytes)(P).buffer}class F{constructor(P,E={}){this.url=P,this.isHttp=/^https?:/i.test(P),this.httpHeaders=this.isHttp&&E.httpHeaders||Object.create(null),this.withCredentials=E.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(P,E,v){const p={begin:P,end:E};for(const y in v)p[y]=v[y];return this.request(p)}requestFull(P){return this.request(P)}request(P){const E=new XMLHttpRequest,v=this.currXhrId++,p=this.pendingRequests[v]={xhr:E};E.open("GET",this.url),E.withCredentials=this.withCredentials;for(const y in this.httpHeaders){const C=this.httpHeaders[y];C!==void 0&&E.setRequestHeader(y,C)}return this.isHttp&&"begin"in P&&"end"in P?(E.setRequestHeader("Range","bytes=".concat(P.begin,"-").concat(P.end-1)),p.expectedStatus=H):p.expectedStatus=z,E.responseType="arraybuffer",P.onError&&(E.onerror=function(y){P.onError(E.status)}),E.onreadystatechange=this.onStateChange.bind(this,v),E.onprogress=this.onProgress.bind(this,v),p.onHeadersReceived=P.onHeadersReceived,p.onDone=P.onDone,p.onError=P.onError,p.onProgress=P.onProgress,E.send(null),v}onProgress(P,E){var p;const v=this.pendingRequests[P];v&&((p=v.onProgress)==null||p.call(v,E))}onStateChange(P,E){var A,c,d;const v=this.pendingRequests[P];if(!v)return;const p=v.xhr;if(p.readyState>=2&&v.onHeadersReceived&&(v.onHeadersReceived(),delete v.onHeadersReceived),p.readyState!==4||!(P in this.pendingRequests))return;if(delete this.pendingRequests[P],p.status===0&&this.isHttp){(A=v.onError)==null||A.call(v,p.status);return}const y=p.status||z;if(!(y===z&&v.expectedStatus===H)&&y!==v.expectedStatus){(c=v.onError)==null||c.call(v,p.status);return}const x=ct(p);if(y===H){const M=p.getResponseHeader("Content-Range"),b=/bytes (\d+)-(\d+)\/(\d+)/.exec(M);v.onDone({begin:parseInt(b[1],10),chunk:x})}else x?v.onDone({begin:0,chunk:x}):(d=v.onError)==null||d.call(v,p.status)}getRequestXhr(P){return this.pendingRequests[P].xhr}isPendingRequest(P){return P in this.pendingRequests}abortRequest(P){const E=this.pendingRequests[P].xhr;delete this.pendingRequests[P],E.abort()}}class R{constructor(P){this._source=P,this._manager=new F(P.url,{httpHeaders:P.httpHeaders,withCredentials:P.withCredentials}),this._rangeChunkSize=P.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(P){const E=this._rangeRequestReaders.indexOf(P);E>=0&&this._rangeRequestReaders.splice(E,1)}getFullReader(){return(0,i.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new m(this._manager,this._source),this._fullRequestReader}getRangeReader(P,E){const v=new I(this._manager,P,E);return v.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(v),v}cancelAllRequests(P){var E;(E=this._fullRequestReader)==null||E.cancel(P);for(const v of this._rangeRequestReaders.slice(0))v.cancel(P)}}n.PDFNetworkStream=R;class m{constructor(P,E){this._manager=P;const v={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=E.url,this._fullRequestId=P.requestFull(v),this._headersReceivedCapability=new i.PromiseCapability,this._disableRange=E.disableRange||!1,this._contentLength=E.length,this._rangeChunkSize=E.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const P=this._fullRequestId,E=this._manager.getRequestXhr(P),v=C=>E.getResponseHeader(C),{allowRangeRequests:p,suggestedLength:y}=(0,f.validateRangeRequestCapabilities)({getResponseHeader:v,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});p&&(this._isRangeSupported=!0),this._contentLength=y||this._contentLength,this._filename=(0,f.extractFilenameFromHeader)(v),this._isRangeSupported&&this._manager.abortRequest(P),this._headersReceivedCapability.resolve()}_onDone(P){if(P&&(this._requests.length>0?this._requests.shift().resolve({value:P.chunk,done:!1}):this._cachedChunks.push(P.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const E of this._requests)E.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(P){this._storedError=(0,f.createResponseStatusError)(P,this._url),this._headersReceivedCapability.reject(this._storedError);for(const E of this._requests)E.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(P){var E;(E=this.onProgress)==null||E.call(this,{loaded:P.loaded,total:P.lengthComputable?P.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const P=new i.PromiseCapability;return this._requests.push(P),P.promise}cancel(P){this._done=!0,this._headersReceivedCapability.reject(P);for(const E of this._requests)E.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class I{constructor(P,E,v){this._manager=P;const p={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=P.url,this._requestId=P.requestRange(E,v,p),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var P;(P=this.onClosed)==null||P.call(this,this)}_onDone(P){const E=P.chunk;this._requests.length>0?this._requests.shift().resolve({value:E,done:!1}):this._queuedChunk=E,this._done=!0;for(const v of this._requests)v.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(P){this._storedError=(0,f.createResponseStatusError)(P,this._url);for(const E of this._requests)E.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(P){var E;this.isStreamingSupported||(E=this.onProgress)==null||E.call(this,{loaded:P.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const E=this._queuedChunk;return this._queuedChunk=null,{value:E,done:!1}}if(this._done)return{value:void 0,done:!0};const P=new i.PromiseCapability;return this._requests.push(P),P.promise}cancel(P){this._done=!0;for(const E of this._requests)E.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(D,n,L)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.PDFNodeStream=void 0;var i=L(1),f=L(20);const z=/^file:\/\/\/[a-zA-Z]:\//;function H(v){const p=require$$5,y=p.parse(v);return y.protocol==="file:"||y.host?y:/^[a-z]:[/\\]/i.test(v)?p.parse("file:///".concat(v)):(y.host||(y.protocol="file:"),y)}class ct{constructor(p){this.source=p,this.url=H(p.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&p.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var p,y;return(y=(p=this._fullRequestReader)==null?void 0:p._loaded)!=null?y:0}getFullReader(){return(0,i.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new P(this):new I(this),this._fullRequestReader}getRangeReader(p,y){if(y<=this._progressiveDataLength)return null;const C=this.isFsUrl?new E(this,p,y):new N(this,p,y);return this._rangeRequestReaders.push(C),C}cancelAllRequests(p){var y;(y=this._fullRequestReader)==null||y.cancel(p);for(const C of this._rangeRequestReaders.slice(0))C.cancel(p)}}n.PDFNodeStream=ct;class F{constructor(p){this._url=p.url,this._done=!1,this._storedError=null,this.onProgress=null;const y=p.source;this._contentLength=y.length,this._loaded=0,this._filename=null,this._disableRange=y.disableRange||!1,this._rangeChunkSize=y.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!y.disableStream,this._isRangeSupported=!y.disableRange,this._readableStream=null,this._readCapability=new i.PromiseCapability,this._headersCapability=new i.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var C;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const p=this._readableStream.read();return p===null?(this._readCapability=new i.PromiseCapability,this.read()):(this._loaded+=p.length,(C=this.onProgress)==null||C.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(p).buffer,done:!1})}cancel(p){if(!this._readableStream){this._error(p);return}this._readableStream.destroy(p)}_error(p){this._storedError=p,this._readCapability.resolve()}_setReadableStream(p){this._readableStream=p,p.on("readable",()=>{this._readCapability.resolve()}),p.on("end",()=>{p.destroy(),this._done=!0,this._readCapability.resolve()}),p.on("error",y=>{this._error(y)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new i.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class R{constructor(p){this._url=p.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new i.PromiseCapability;const y=p.source;this._isStreamingSupported=!y.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var C;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const p=this._readableStream.read();return p===null?(this._readCapability=new i.PromiseCapability,this.read()):(this._loaded+=p.length,(C=this.onProgress)==null||C.call(this,{loaded:this._loaded}),{value:new Uint8Array(p).buffer,done:!1})}cancel(p){if(!this._readableStream){this._error(p);return}this._readableStream.destroy(p)}_error(p){this._storedError=p,this._readCapability.resolve()}_setReadableStream(p){this._readableStream=p,p.on("readable",()=>{this._readCapability.resolve()}),p.on("end",()=>{p.destroy(),this._done=!0,this._readCapability.resolve()}),p.on("error",y=>{this._error(y)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function m(v,p){return{protocol:v.protocol,auth:v.auth,host:v.hostname,port:v.port,path:v.path,method:"GET",headers:p}}class I extends F{constructor(p){super(p);const y=C=>{if(C.statusCode===404){const d=new i.MissingPDFException('Missing PDF "'.concat(this._url,'".'));this._storedError=d,this._headersCapability.reject(d);return}this._headersCapability.resolve(),this._setReadableStream(C);const x=d=>this._readableStream.headers[d.toLowerCase()],{allowRangeRequests:A,suggestedLength:c}=(0,f.validateRangeRequestCapabilities)({getResponseHeader:x,isHttp:p.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=A,this._contentLength=c||this._contentLength,this._filename=(0,f.extractFilenameFromHeader)(x)};if(this._request=null,this._url.protocol==="http:"){const C=require$$5;this._request=C.request(m(this._url,p.httpHeaders),y)}else{const C=require$$5;this._request=C.request(m(this._url,p.httpHeaders),y)}this._request.on("error",C=>{this._storedError=C,this._headersCapability.reject(C)}),this._request.end()}}class N extends R{constructor(p,y,C){super(p),this._httpHeaders={};for(const A in p.httpHeaders){const c=p.httpHeaders[A];c!==void 0&&(this._httpHeaders[A]=c)}this._httpHeaders.Range="bytes=".concat(y,"-").concat(C-1);const x=A=>{if(A.statusCode===404){const c=new i.MissingPDFException('Missing PDF "'.concat(this._url,'".'));this._storedError=c;return}this._setReadableStream(A)};if(this._request=null,this._url.protocol==="http:"){const A=require$$5;this._request=A.request(m(this._url,this._httpHeaders),x)}else{const A=require$$5;this._request=A.request(m(this._url,this._httpHeaders),x)}this._request.on("error",A=>{this._storedError=A}),this._request.end()}}class P extends F{constructor(p){super(p);let y=decodeURIComponent(this._url.path);z.test(this._url.href)&&(y=y.replace(/^\//,""));const C=require$$5;C.lstat(y,(x,A)=>{if(x){x.code==="ENOENT"&&(x=new i.MissingPDFException('Missing PDF "'.concat(y,'".'))),this._storedError=x,this._headersCapability.reject(x);return}this._contentLength=A.size,this._setReadableStream(C.createReadStream(y)),this._headersCapability.resolve()})}}class E extends R{constructor(p,y,C){super(p);let x=decodeURIComponent(this._url.path);z.test(this._url.href)&&(x=x.replace(/^\//,""));const A=require$$5;this._setReadableStream(A.createReadStream(x,{start:y,end:C-1}))}}},(D,n,L)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.SVGGraphics=void 0;var i=L(6),f=L(1);const z={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},H="http://www.w3.org/XML/1998/namespace",ct="http://www.w3.org/1999/xlink",F=["butt","round","square"],R=["miter","round","bevel"],m=function(A,c="",d=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!d)return URL.createObjectURL(new Blob([A],{type:c}));const M="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let b="data:".concat(c,";base64,");for(let l=0,w=A.length;l<w;l+=3){const g=A[l]&255,$=A[l+1]&255,V=A[l+2]&255,S=g>>2,X=(g&3)<<4|$>>4,tt=l+1<w?($&15)<<2|V>>6:64,at=l+2<w?V&63:64;b+=M[S]+M[X]+M[tt]+M[at]}return b},I=function(){const A=new Uint8Array([137,80,78,71,13,10,26,10]),c=12,d=new Int32Array(256);for(let V=0;V<256;V++){let S=V;for(let X=0;X<8;X++)S=S&1?3988292384^S>>1&2147483647:S>>1&2147483647;d[V]=S}function M(V,S,X){let tt=-1;for(let at=S;at<X;at++){const G=(tt^V[at])&255,ut=d[G];tt=tt>>>8^ut}return tt^-1}function b(V,S,X,tt){let at=tt;const G=S.length;X[at]=G>>24&255,X[at+1]=G>>16&255,X[at+2]=G>>8&255,X[at+3]=G&255,at+=4,X[at]=V.charCodeAt(0)&255,X[at+1]=V.charCodeAt(1)&255,X[at+2]=V.charCodeAt(2)&255,X[at+3]=V.charCodeAt(3)&255,at+=4,X.set(S,at),at+=S.length;const ut=M(X,tt+4,at);X[at]=ut>>24&255,X[at+1]=ut>>16&255,X[at+2]=ut>>8&255,X[at+3]=ut&255}function l(V,S,X){let tt=1,at=0;for(let G=S;G<X;++G)tt=(tt+(V[G]&255))%65521,at=(at+tt)%65521;return at<<16|tt}function w(V){if(!f.isNodeJS)return g(V);try{const S=parseInt(process.versions.node)>=8?V:Buffer.from(V),X=require$$5.deflateSync(S,{level:9});return X instanceof Uint8Array?X:new Uint8Array(X)}catch(S){(0,f.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+S)}return g(V)}function g(V){let S=V.length;const X=65535,tt=Math.ceil(S/X),at=new Uint8Array(2+S+tt*5+4);let G=0;at[G++]=120,at[G++]=156;let ut=0;for(;S>X;)at[G++]=0,at[G++]=255,at[G++]=255,at[G++]=0,at[G++]=0,at.set(V.subarray(ut,ut+X),G),G+=X,ut+=X,S-=X;at[G++]=1,at[G++]=S&255,at[G++]=S>>8&255,at[G++]=~S&65535&255,at[G++]=(~S&65535)>>8&255,at.set(V.subarray(ut),G),G+=V.length-ut;const yt=l(V,0,V.length);return at[G++]=yt>>24&255,at[G++]=yt>>16&255,at[G++]=yt>>8&255,at[G++]=yt&255,at}function $(V,S,X,tt){const at=V.width,G=V.height;let ut,yt,Tt;const wt=V.data;switch(S){case f.ImageKind.GRAYSCALE_1BPP:yt=0,ut=1,Tt=at+7>>3;break;case f.ImageKind.RGB_24BPP:yt=2,ut=8,Tt=at*3;break;case f.ImageKind.RGBA_32BPP:yt=6,ut=8,Tt=at*4;break;default:throw new Error("invalid format")}const k=new Uint8Array((1+Tt)*G);let s=0,o=0;for(let U=0;U<G;++U)k[s++]=0,k.set(wt.subarray(o,o+Tt),s),o+=Tt,s+=Tt;if(S===f.ImageKind.GRAYSCALE_1BPP&&tt){s=0;for(let U=0;U<G;U++){s++;for(let rt=0;rt<Tt;rt++)k[s++]^=255}}const a=new Uint8Array([at>>24&255,at>>16&255,at>>8&255,at&255,G>>24&255,G>>16&255,G>>8&255,G&255,ut,yt,0,0,0]),h=w(k),u=A.length+c*3+a.length+h.length,T=new Uint8Array(u);let O=0;return T.set(A,O),O+=A.length,b("IHDR",a,T,O),O+=c+a.length,b("IDATA",h,T,O),O+=c+h.length,b("IEND",new Uint8Array(0),T,O),m(T,"image/png",X)}return function(S,X,tt){const at=S.kind===void 0?f.ImageKind.GRAYSCALE_1BPP:S.kind;return $(S,at,X,tt)}}();class N{constructor(){this.fontSizeScale=1,this.fontWeight=z.fontWeight,this.fontSize=0,this.textMatrix=f.IDENTITY_MATRIX,this.fontMatrix=f.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=f.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=z.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(c,d){this.x=c,this.y=d}}function P(A){let c=[];const d=[];for(const M of A){if(M.fn==="save"){c.push({fnId:92,fn:"group",items:[]}),d.push(c),c=c.at(-1).items;continue}M.fn==="restore"?c=d.pop():c.push(M)}return c}function E(A){if(Number.isInteger(A))return A.toString();const c=A.toFixed(10);let d=c.length-1;if(c[d]!=="0")return c;do d--;while(c[d]==="0");return c.substring(0,c[d]==="."?d:d+1)}function v(A){if(A[4]===0&&A[5]===0){if(A[1]===0&&A[2]===0)return A[0]===1&&A[3]===1?"":"scale(".concat(E(A[0])," ").concat(E(A[3]),")");if(A[0]===A[3]&&A[1]===-A[2]){const c=Math.acos(A[0])*180/Math.PI;return"rotate(".concat(E(c),")")}}else if(A[0]===1&&A[1]===0&&A[2]===0&&A[3]===1)return"translate(".concat(E(A[4])," ").concat(E(A[5]),")");return"matrix(".concat(E(A[0])," ").concat(E(A[1])," ").concat(E(A[2])," ").concat(E(A[3])," ").concat(E(A[4])," ")+"".concat(E(A[5]),")")}let p=0,y=0,C=0;class x{constructor(c,d,M=!1){(0,i.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new i.DOMSVGFactory,this.current=new N,this.transformMatrix=f.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=c,this.objs=d,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!M,this._operatorIdMapping=[];for(const b in f.OPS)this._operatorIdMapping[f.OPS[b]]=b}getObject(c,d=null){return typeof c=="string"?c.startsWith("g_")?this.commonObjs.get(c):this.objs.get(c):d}save(){this.transformStack.push(this.transformMatrix);const c=this.current;this.extraStack.push(c),this.current=c.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(c){this.save(),this.executeOpTree(c),this.restore()}loadDependencies(c){const d=c.fnArray,M=c.argsArray;for(let b=0,l=d.length;b<l;b++)if(d[b]===f.OPS.dependency)for(const w of M[b]){const g=w.startsWith("g_")?this.commonObjs:this.objs,$=new Promise(V=>{g.get(w,V)});this.current.dependencies.push($)}return Promise.all(this.current.dependencies)}transform(c,d,M,b,l,w){const g=[c,d,M,b,l,w];this.transformMatrix=f.Util.transform(this.transformMatrix,g),this.tgrp=null}getSVG(c,d){this.viewport=d;const M=this._initialize(d);return this.loadDependencies(c).then(()=>(this.transformMatrix=f.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(c)),M))}convertOpList(c){const d=this._operatorIdMapping,M=c.argsArray,b=c.fnArray,l=[];for(let w=0,g=b.length;w<g;w++){const $=b[w];l.push({fnId:$,fn:d[$],args:M[w]})}return P(l)}executeOpTree(c){for(const d of c){const M=d.fn,b=d.fnId,l=d.args;switch(b|0){case f.OPS.beginText:this.beginText();break;case f.OPS.dependency:break;case f.OPS.setLeading:this.setLeading(l);break;case f.OPS.setLeadingMoveText:this.setLeadingMoveText(l[0],l[1]);break;case f.OPS.setFont:this.setFont(l);break;case f.OPS.showText:this.showText(l[0]);break;case f.OPS.showSpacedText:this.showText(l[0]);break;case f.OPS.endText:this.endText();break;case f.OPS.moveText:this.moveText(l[0],l[1]);break;case f.OPS.setCharSpacing:this.setCharSpacing(l[0]);break;case f.OPS.setWordSpacing:this.setWordSpacing(l[0]);break;case f.OPS.setHScale:this.setHScale(l[0]);break;case f.OPS.setTextMatrix:this.setTextMatrix(l[0],l[1],l[2],l[3],l[4],l[5]);break;case f.OPS.setTextRise:this.setTextRise(l[0]);break;case f.OPS.setTextRenderingMode:this.setTextRenderingMode(l[0]);break;case f.OPS.setLineWidth:this.setLineWidth(l[0]);break;case f.OPS.setLineJoin:this.setLineJoin(l[0]);break;case f.OPS.setLineCap:this.setLineCap(l[0]);break;case f.OPS.setMiterLimit:this.setMiterLimit(l[0]);break;case f.OPS.setFillRGBColor:this.setFillRGBColor(l[0],l[1],l[2]);break;case f.OPS.setStrokeRGBColor:this.setStrokeRGBColor(l[0],l[1],l[2]);break;case f.OPS.setStrokeColorN:this.setStrokeColorN(l);break;case f.OPS.setFillColorN:this.setFillColorN(l);break;case f.OPS.shadingFill:this.shadingFill(l[0]);break;case f.OPS.setDash:this.setDash(l[0],l[1]);break;case f.OPS.setRenderingIntent:this.setRenderingIntent(l[0]);break;case f.OPS.setFlatness:this.setFlatness(l[0]);break;case f.OPS.setGState:this.setGState(l[0]);break;case f.OPS.fill:this.fill();break;case f.OPS.eoFill:this.eoFill();break;case f.OPS.stroke:this.stroke();break;case f.OPS.fillStroke:this.fillStroke();break;case f.OPS.eoFillStroke:this.eoFillStroke();break;case f.OPS.clip:this.clip("nonzero");break;case f.OPS.eoClip:this.clip("evenodd");break;case f.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case f.OPS.paintImageXObject:this.paintImageXObject(l[0]);break;case f.OPS.paintInlineImageXObject:this.paintInlineImageXObject(l[0]);break;case f.OPS.paintImageMaskXObject:this.paintImageMaskXObject(l[0]);break;case f.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(l[0],l[1]);break;case f.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case f.OPS.closePath:this.closePath();break;case f.OPS.closeStroke:this.closeStroke();break;case f.OPS.closeFillStroke:this.closeFillStroke();break;case f.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case f.OPS.nextLine:this.nextLine();break;case f.OPS.transform:this.transform(l[0],l[1],l[2],l[3],l[4],l[5]);break;case f.OPS.constructPath:this.constructPath(l[0],l[1]);break;case f.OPS.endPath:this.endPath();break;case 92:this.group(d.items);break;default:(0,f.warn)("Unimplemented operator ".concat(M));break}}}setWordSpacing(c){this.current.wordSpacing=c}setCharSpacing(c){this.current.charSpacing=c}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(c,d,M,b,l,w){const g=this.current;g.textMatrix=g.lineMatrix=[c,d,M,b,l,w],g.textMatrixScale=Math.hypot(c,d),g.x=g.lineX=0,g.y=g.lineY=0,g.xcoords=[],g.ycoords=[],g.tspan=this.svgFactory.createElement("svg:tspan"),g.tspan.setAttributeNS(null,"font-family",g.fontFamily),g.tspan.setAttributeNS(null,"font-size","".concat(E(g.fontSize),"px")),g.tspan.setAttributeNS(null,"y",E(-g.y)),g.txtElement=this.svgFactory.createElement("svg:text"),g.txtElement.append(g.tspan)}beginText(){const c=this.current;c.x=c.lineX=0,c.y=c.lineY=0,c.textMatrix=f.IDENTITY_MATRIX,c.lineMatrix=f.IDENTITY_MATRIX,c.textMatrixScale=1,c.tspan=this.svgFactory.createElement("svg:tspan"),c.txtElement=this.svgFactory.createElement("svg:text"),c.txtgrp=this.svgFactory.createElement("svg:g"),c.xcoords=[],c.ycoords=[]}moveText(c,d){const M=this.current;M.x=M.lineX+=c,M.y=M.lineY+=d,M.xcoords=[],M.ycoords=[],M.tspan=this.svgFactory.createElement("svg:tspan"),M.tspan.setAttributeNS(null,"font-family",M.fontFamily),M.tspan.setAttributeNS(null,"font-size","".concat(E(M.fontSize),"px")),M.tspan.setAttributeNS(null,"y",E(-M.y))}showText(c){const d=this.current,M=d.font,b=d.fontSize;if(b===0)return;const l=d.fontSizeScale,w=d.charSpacing,g=d.wordSpacing,$=d.fontDirection,V=d.textHScale*$,S=M.vertical,X=S?1:-1,tt=M.defaultVMetrics,at=b*d.fontMatrix[0];let G=0;for(const Tt of c){if(Tt===null){G+=$*g;continue}else if(typeof Tt=="number"){G+=X*Tt*b/1e3;continue}const wt=(Tt.isSpace?g:0)+w,k=Tt.fontChar;let s,o,a=Tt.width;if(S){let u;const T=Tt.vmetric||tt;u=Tt.vmetric?T[1]:a*.5,u=-u*at;const O=T[2]*at;a=T?-T[0]:a,s=u/l,o=(G+O)/l}else s=G/l,o=0;(Tt.isInFont||M.missingFile)&&(d.xcoords.push(d.x+s),S&&d.ycoords.push(-d.y+o),d.tspan.textContent+=k);const h=S?a*at-wt*$:a*at+wt*$;G+=h}d.tspan.setAttributeNS(null,"x",d.xcoords.map(E).join(" ")),S?d.tspan.setAttributeNS(null,"y",d.ycoords.map(E).join(" ")):d.tspan.setAttributeNS(null,"y",E(-d.y)),S?d.y-=G:d.x+=G*V,d.tspan.setAttributeNS(null,"font-family",d.fontFamily),d.tspan.setAttributeNS(null,"font-size","".concat(E(d.fontSize),"px")),d.fontStyle!==z.fontStyle&&d.tspan.setAttributeNS(null,"font-style",d.fontStyle),d.fontWeight!==z.fontWeight&&d.tspan.setAttributeNS(null,"font-weight",d.fontWeight);const ut=d.textRenderingMode&f.TextRenderingMode.FILL_STROKE_MASK;if(ut===f.TextRenderingMode.FILL||ut===f.TextRenderingMode.FILL_STROKE?(d.fillColor!==z.fillColor&&d.tspan.setAttributeNS(null,"fill",d.fillColor),d.fillAlpha<1&&d.tspan.setAttributeNS(null,"fill-opacity",d.fillAlpha)):d.textRenderingMode===f.TextRenderingMode.ADD_TO_PATH?d.tspan.setAttributeNS(null,"fill","transparent"):d.tspan.setAttributeNS(null,"fill","none"),ut===f.TextRenderingMode.STROKE||ut===f.TextRenderingMode.FILL_STROKE){const Tt=1/(d.textMatrixScale||1);this._setStrokeAttributes(d.tspan,Tt)}let yt=d.textMatrix;d.textRise!==0&&(yt=yt.slice(),yt[5]+=d.textRise),d.txtElement.setAttributeNS(null,"transform","".concat(v(yt)," scale(").concat(E(V),", -1)")),d.txtElement.setAttributeNS(H,"xml:space","preserve"),d.txtElement.append(d.tspan),d.txtgrp.append(d.txtElement),this._ensureTransformGroup().append(d.txtElement)}setLeadingMoveText(c,d){this.setLeading(-d),this.moveText(c,d)}addFontStyle(c){if(!c.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const d=m(c.data,c.mimetype,this.forceDataSchema);this.cssStyle.textContent+='@font-face { font-family: "'.concat(c.loadedName,'";')+" src: url(".concat(d,"); }\n")}setFont(c){const d=this.current,M=this.commonObjs.get(c[0]);let b=c[1];d.font=M,this.embedFonts&&!M.missingFile&&!this.embeddedFonts[M.loadedName]&&(this.addFontStyle(M),this.embeddedFonts[M.loadedName]=M),d.fontMatrix=M.fontMatrix||f.FONT_IDENTITY_MATRIX;let l="normal";M.black?l="900":M.bold&&(l="bold");const w=M.italic?"italic":"normal";b<0?(b=-b,d.fontDirection=-1):d.fontDirection=1,d.fontSize=b,d.fontFamily=M.loadedName,d.fontWeight=l,d.fontStyle=w,d.tspan=this.svgFactory.createElement("svg:tspan"),d.tspan.setAttributeNS(null,"y",E(-d.y)),d.xcoords=[],d.ycoords=[]}endText(){var d;const c=this.current;c.textRenderingMode&f.TextRenderingMode.ADD_TO_PATH_FLAG&&((d=c.txtElement)!=null&&d.hasChildNodes())&&(c.element=c.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(c){c>0&&(this.current.lineWidth=c)}setLineCap(c){this.current.lineCap=F[c]}setLineJoin(c){this.current.lineJoin=R[c]}setMiterLimit(c){this.current.miterLimit=c}setStrokeAlpha(c){this.current.strokeAlpha=c}setStrokeRGBColor(c,d,M){this.current.strokeColor=f.Util.makeHexColor(c,d,M)}setFillAlpha(c){this.current.fillAlpha=c}setFillRGBColor(c,d,M){this.current.fillColor=f.Util.makeHexColor(c,d,M),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(c){this.current.strokeColor=this._makeColorN_Pattern(c)}setFillColorN(c){this.current.fillColor=this._makeColorN_Pattern(c)}shadingFill(c){const{width:d,height:M}=this.viewport,b=f.Util.inverseTransform(this.transformMatrix),[l,w,g,$]=f.Util.getAxialAlignedBoundingBox([0,0,d,M],b),V=this.svgFactory.createElement("svg:rect");V.setAttributeNS(null,"x",l),V.setAttributeNS(null,"y",w),V.setAttributeNS(null,"width",g-l),V.setAttributeNS(null,"height",$-w),V.setAttributeNS(null,"fill",this._makeShadingPattern(c)),this.current.fillAlpha<1&&V.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(V)}_makeColorN_Pattern(c){return c[0]==="TilingPattern"?this._makeTilingPattern(c):this._makeShadingPattern(c)}_makeTilingPattern(c){const d=c[1],M=c[2],b=c[3]||f.IDENTITY_MATRIX,[l,w,g,$]=c[4],V=c[5],S=c[6],X=c[7],tt="shading".concat(C++),[at,G,ut,yt]=f.Util.normalizeRect([...f.Util.applyTransform([l,w],b),...f.Util.applyTransform([g,$],b)]),[Tt,wt]=f.Util.singularValueDecompose2dScale(b),k=V*Tt,s=S*wt,o=this.svgFactory.createElement("svg:pattern");o.setAttributeNS(null,"id",tt),o.setAttributeNS(null,"patternUnits","userSpaceOnUse"),o.setAttributeNS(null,"width",k),o.setAttributeNS(null,"height",s),o.setAttributeNS(null,"x","".concat(at)),o.setAttributeNS(null,"y","".concat(G));const a=this.svg,h=this.transformMatrix,u=this.current.fillColor,T=this.current.strokeColor,O=this.svgFactory.create(ut-at,yt-G);if(this.svg=O,this.transformMatrix=b,X===2){const U=f.Util.makeHexColor(...d);this.current.fillColor=U,this.current.strokeColor=U}return this.executeOpTree(this.convertOpList(M)),this.svg=a,this.transformMatrix=h,this.current.fillColor=u,this.current.strokeColor=T,o.append(O.childNodes[0]),this.defs.append(o),"url(#".concat(tt,")")}_makeShadingPattern(c){switch(typeof c=="string"&&(c=this.objs.get(c)),c[0]){case"RadialAxial":const d="shading".concat(C++),M=c[3];let b;switch(c[1]){case"axial":const l=c[4],w=c[5];b=this.svgFactory.createElement("svg:linearGradient"),b.setAttributeNS(null,"id",d),b.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),b.setAttributeNS(null,"x1",l[0]),b.setAttributeNS(null,"y1",l[1]),b.setAttributeNS(null,"x2",w[0]),b.setAttributeNS(null,"y2",w[1]);break;case"radial":const g=c[4],$=c[5],V=c[6],S=c[7];b=this.svgFactory.createElement("svg:radialGradient"),b.setAttributeNS(null,"id",d),b.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),b.setAttributeNS(null,"cx",$[0]),b.setAttributeNS(null,"cy",$[1]),b.setAttributeNS(null,"r",S),b.setAttributeNS(null,"fx",g[0]),b.setAttributeNS(null,"fy",g[1]),b.setAttributeNS(null,"fr",V);break;default:throw new Error("Unknown RadialAxial type: ".concat(c[1]))}for(const l of M){const w=this.svgFactory.createElement("svg:stop");w.setAttributeNS(null,"offset",l[0]),w.setAttributeNS(null,"stop-color",l[1]),b.append(w)}return this.defs.append(b),"url(#".concat(d,")");case"Mesh":return(0,f.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error("Unknown IR type: ".concat(c[0]))}}setDash(c,d){this.current.dashArray=c,this.current.dashPhase=d}constructPath(c,d){const M=this.current;let b=M.x,l=M.y,w=[],g=0;for(const $ of c)switch($|0){case f.OPS.rectangle:b=d[g++],l=d[g++];const V=d[g++],S=d[g++],X=b+V,tt=l+S;w.push("M",E(b),E(l),"L",E(X),E(l),"L",E(X),E(tt),"L",E(b),E(tt),"Z");break;case f.OPS.moveTo:b=d[g++],l=d[g++],w.push("M",E(b),E(l));break;case f.OPS.lineTo:b=d[g++],l=d[g++],w.push("L",E(b),E(l));break;case f.OPS.curveTo:b=d[g+4],l=d[g+5],w.push("C",E(d[g]),E(d[g+1]),E(d[g+2]),E(d[g+3]),E(b),E(l)),g+=6;break;case f.OPS.curveTo2:w.push("C",E(b),E(l),E(d[g]),E(d[g+1]),E(d[g+2]),E(d[g+3])),b=d[g+2],l=d[g+3],g+=4;break;case f.OPS.curveTo3:b=d[g+2],l=d[g+3],w.push("C",E(d[g]),E(d[g+1]),E(b),E(l),E(b),E(l)),g+=4;break;case f.OPS.closePath:w.push("Z");break}w=w.join(" "),M.path&&c.length>0&&c[0]!==f.OPS.rectangle&&c[0]!==f.OPS.moveTo?w=M.path.getAttributeNS(null,"d")+w:(M.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(M.path)),M.path.setAttributeNS(null,"d",w),M.path.setAttributeNS(null,"fill","none"),M.element=M.path,M.setCurrentPoint(b,l)}endPath(){const c=this.current;if(c.path=null,!this.pendingClip)return;if(!c.element){this.pendingClip=null;return}const d="clippath".concat(p++),M=this.svgFactory.createElement("svg:clipPath");M.setAttributeNS(null,"id",d),M.setAttributeNS(null,"transform",v(this.transformMatrix));const b=c.element.cloneNode(!0);if(this.pendingClip==="evenodd"?b.setAttributeNS(null,"clip-rule","evenodd"):b.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,M.append(b),this.defs.append(M),c.activeClipUrl){c.clipGroup=null;for(const l of this.extraStack)l.clipGroup=null;M.setAttributeNS(null,"clip-path",c.activeClipUrl)}c.activeClipUrl="url(#".concat(d,")"),this.tgrp=null}clip(c){this.pendingClip=c}closePath(){const c=this.current;if(c.path){const d="".concat(c.path.getAttributeNS(null,"d"),"Z");c.path.setAttributeNS(null,"d",d)}}setLeading(c){this.current.leading=-c}setTextRise(c){this.current.textRise=c}setTextRenderingMode(c){this.current.textRenderingMode=c}setHScale(c){this.current.textHScale=c/100}setRenderingIntent(c){}setFlatness(c){}setGState(c){for(const[d,M]of c)switch(d){case"LW":this.setLineWidth(M);break;case"LC":this.setLineCap(M);break;case"LJ":this.setLineJoin(M);break;case"ML":this.setMiterLimit(M);break;case"D":this.setDash(M[0],M[1]);break;case"RI":this.setRenderingIntent(M);break;case"FL":this.setFlatness(M);break;case"Font":this.setFont(M);break;case"CA":this.setStrokeAlpha(M);break;case"ca":this.setFillAlpha(M);break;default:(0,f.warn)("Unimplemented graphic state operator ".concat(d));break}}fill(){const c=this.current;c.element&&(c.element.setAttributeNS(null,"fill",c.fillColor),c.element.setAttributeNS(null,"fill-opacity",c.fillAlpha),this.endPath())}stroke(){const c=this.current;c.element&&(this._setStrokeAttributes(c.element),c.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(c,d=1){const M=this.current;let b=M.dashArray;d!==1&&b.length>0&&(b=b.map(function(l){return d*l})),c.setAttributeNS(null,"stroke",M.strokeColor),c.setAttributeNS(null,"stroke-opacity",M.strokeAlpha),c.setAttributeNS(null,"stroke-miterlimit",E(M.miterLimit)),c.setAttributeNS(null,"stroke-linecap",M.lineCap),c.setAttributeNS(null,"stroke-linejoin",M.lineJoin),c.setAttributeNS(null,"stroke-width",E(d*M.lineWidth)+"px"),c.setAttributeNS(null,"stroke-dasharray",b.map(E).join(" ")),c.setAttributeNS(null,"stroke-dashoffset",E(d*M.dashPhase)+"px")}eoFill(){var c;(c=this.current.element)==null||c.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var c;(c=this.current.element)==null||c.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const c=this.svgFactory.createElement("svg:rect");c.setAttributeNS(null,"x","0"),c.setAttributeNS(null,"y","0"),c.setAttributeNS(null,"width","1px"),c.setAttributeNS(null,"height","1px"),c.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(c)}paintImageXObject(c){const d=this.getObject(c);if(!d){(0,f.warn)("Dependent image with object ID ".concat(c," is not ready yet"));return}this.paintInlineImageXObject(d)}paintInlineImageXObject(c,d){const M=c.width,b=c.height,l=I(c,this.forceDataSchema,!!d),w=this.svgFactory.createElement("svg:rect");w.setAttributeNS(null,"x","0"),w.setAttributeNS(null,"y","0"),w.setAttributeNS(null,"width",E(M)),w.setAttributeNS(null,"height",E(b)),this.current.element=w,this.clip("nonzero");const g=this.svgFactory.createElement("svg:image");g.setAttributeNS(ct,"xlink:href",l),g.setAttributeNS(null,"x","0"),g.setAttributeNS(null,"y",E(-b)),g.setAttributeNS(null,"width",E(M)+"px"),g.setAttributeNS(null,"height",E(b)+"px"),g.setAttributeNS(null,"transform","scale(".concat(E(1/M)," ").concat(E(-1/b),")")),d?d.append(g):this._ensureTransformGroup().append(g)}paintImageMaskXObject(c){const d=this.getObject(c.data,c);if(d.bitmap){(0,f.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const M=this.current,b=d.width,l=d.height,w=M.fillColor;M.maskId="mask".concat(y++);const g=this.svgFactory.createElement("svg:mask");g.setAttributeNS(null,"id",M.maskId);const $=this.svgFactory.createElement("svg:rect");$.setAttributeNS(null,"x","0"),$.setAttributeNS(null,"y","0"),$.setAttributeNS(null,"width",E(b)),$.setAttributeNS(null,"height",E(l)),$.setAttributeNS(null,"fill",w),$.setAttributeNS(null,"mask","url(#".concat(M.maskId,")")),this.defs.append(g),this._ensureTransformGroup().append($),this.paintInlineImageXObject(d,g)}paintFormXObjectBegin(c,d){if(Array.isArray(c)&&c.length===6&&this.transform(c[0],c[1],c[2],c[3],c[4],c[5]),d){const M=d[2]-d[0],b=d[3]-d[1],l=this.svgFactory.createElement("svg:rect");l.setAttributeNS(null,"x",d[0]),l.setAttributeNS(null,"y",d[1]),l.setAttributeNS(null,"width",E(M)),l.setAttributeNS(null,"height",E(b)),this.current.element=l,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(c){const d=this.svgFactory.create(c.width,c.height),M=this.svgFactory.createElement("svg:defs");d.append(M),this.defs=M;const b=this.svgFactory.createElement("svg:g");return b.setAttributeNS(null,"transform",v(c.transform)),d.append(b),this.svg=b,d}_ensureClipGroup(){if(!this.current.clipGroup){const c=this.svgFactory.createElement("svg:g");c.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(c),this.current.clipGroup=c}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",v(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}n.SVGGraphics=x},(D,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.XfaText=void 0;class L{static textContent(f){const z=[],H={items:z,styles:Object.create(null)};function ct(F){var I;if(!F)return;let R=null;const m=F.name;if(m==="#text")R=F.value;else if(L.shouldBuildText(m))(I=F==null?void 0:F.attributes)!=null&&I.textContent?R=F.attributes.textContent:F.value&&(R=F.value);else return;if(R!==null&&z.push({str:R}),!!F.children)for(const N of F.children)ct(N)}return ct(f),H}static shouldBuildText(f){return!(f==="textarea"||f==="input"||f==="option"||f==="select")}}n.XfaText=L},(D,n,L)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.TextLayerRenderTask=void 0,n.renderTextLayer=v,n.updateTextLayer=p;var i=L(1),f=L(6);const z=1e5,H=30,ct=.8,F=new Map;function R(y,C){let x;if(C&&i.FeatureTest.isOffscreenCanvasSupported)x=new OffscreenCanvas(y,y).getContext("2d",{alpha:!1});else{const A=document.createElement("canvas");A.width=A.height=y,x=A.getContext("2d",{alpha:!1})}return x}function m(y,C){const x=F.get(y);if(x)return x;const A=R(H,C);A.font="".concat(H,"px ").concat(y);const c=A.measureText("");let d=c.fontBoundingBoxAscent,M=Math.abs(c.fontBoundingBoxDescent);if(d){const l=d/(d+M);return F.set(y,l),A.canvas.width=A.canvas.height=0,l}A.strokeStyle="red",A.clearRect(0,0,H,H),A.strokeText("g",0,0);let b=A.getImageData(0,0,H,H).data;M=0;for(let l=b.length-1-3;l>=0;l-=4)if(b[l]>0){M=Math.ceil(l/4/H);break}A.clearRect(0,0,H,H),A.strokeText("A",0,H),b=A.getImageData(0,0,H,H).data,d=0;for(let l=0,w=b.length;l<w;l+=4)if(b[l]>0){d=H-Math.floor(l/4/H);break}if(A.canvas.width=A.canvas.height=0,d){const l=d/(d+M);return F.set(y,l),l}return F.set(y,ct),ct}function I(y,C,x){const A=document.createElement("span"),c={angle:0,canvasWidth:0,hasText:C.str!=="",hasEOL:C.hasEOL,fontSize:0};y._textDivs.push(A);const d=i.Util.transform(y._transform,C.transform);let M=Math.atan2(d[1],d[0]);const b=x[C.fontName];b.vertical&&(M+=Math.PI/2);const l=Math.hypot(d[2],d[3]),w=l*m(b.fontFamily,y._isOffscreenCanvasSupported);let g,$;M===0?(g=d[4],$=d[5]-w):(g=d[4]+w*Math.sin(M),$=d[5]-w*Math.cos(M));const V="calc(var(--scale-factor)*",S=A.style;y._container===y._rootContainer?(S.left="".concat((100*g/y._pageWidth).toFixed(2),"%"),S.top="".concat((100*$/y._pageHeight).toFixed(2),"%")):(S.left="".concat(V).concat(g.toFixed(2),"px)"),S.top="".concat(V).concat($.toFixed(2),"px)")),S.fontSize="".concat(V).concat(l.toFixed(2),"px)"),S.fontFamily=b.fontFamily,c.fontSize=l,A.setAttribute("role","presentation"),A.textContent=C.str,A.dir=C.dir,y._fontInspectorEnabled&&(A.dataset.fontName=C.fontName),M!==0&&(c.angle=M*(180/Math.PI));let X=!1;if(C.str.length>1)X=!0;else if(C.str!==" "&&C.transform[0]!==C.transform[3]){const tt=Math.abs(C.transform[0]),at=Math.abs(C.transform[3]);tt!==at&&Math.max(tt,at)/Math.min(tt,at)>1.5&&(X=!0)}X&&(c.canvasWidth=b.vertical?C.height:C.width),y._textDivProperties.set(A,c),y._isReadableStream&&y._layoutText(A)}function N(y){const{div:C,scale:x,properties:A,ctx:c,prevFontSize:d,prevFontFamily:M}=y,{style:b}=C;let l="";if(A.canvasWidth!==0&&A.hasText){const{fontFamily:w}=b,{canvasWidth:g,fontSize:$}=A;(d!==$||M!==w)&&(c.font="".concat($*x,"px ").concat(w),y.prevFontSize=$,y.prevFontFamily=w);const{width:V}=c.measureText(C.textContent);V>0&&(l="scaleX(".concat(g*x/V,")"))}A.angle!==0&&(l="rotate(".concat(A.angle,"deg) ").concat(l)),l.length>0&&(b.transform=l)}function P(y){if(y._canceled)return;const C=y._textDivs,x=y._capability;if(C.length>z){x.resolve();return}if(!y._isReadableStream)for(const c of C)y._layoutText(c);x.resolve()}class E{constructor({textContentSource:C,container:x,viewport:A,textDivs:c,textDivProperties:d,textContentItemsStr:M,isOffscreenCanvasSupported:b}){var V;this._textContentSource=C,this._isReadableStream=C instanceof ReadableStream,this._container=this._rootContainer=x,this._textDivs=c||[],this._textContentItemsStr=M||[],this._isOffscreenCanvasSupported=b,this._fontInspectorEnabled=!!((V=globalThis.FontInspector)!=null&&V.enabled),this._reader=null,this._textDivProperties=d||new WeakMap,this._canceled=!1,this._capability=new i.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:A.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:R(0,b)};const{pageWidth:l,pageHeight:w,pageX:g,pageY:$}=A.rawDims;this._transform=[1,0,0,-1,-g,$+w],this._pageWidth=l,this._pageHeight=w,(0,f.setLayerDimensions)(x,A),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new i.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new i.AbortException("TextLayer task cancelled."))}_processItems(C,x){for(const A of C){if(A.str===void 0){if(A.type==="beginMarkedContentProps"||A.type==="beginMarkedContent"){const c=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),A.id!==null&&this._container.setAttribute("id","".concat(A.id)),c.append(this._container)}else A.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(A.str),I(this,A,x)}}_layoutText(C){const x=this._layoutTextParams.properties=this._textDivProperties.get(C);if(this._layoutTextParams.div=C,N(this._layoutTextParams),x.hasText&&this._container.append(C),x.hasEOL){const A=document.createElement("br");A.setAttribute("role","presentation"),this._container.append(A)}}_render(){const C=new i.PromiseCapability;let x=Object.create(null);if(this._isReadableStream){const A=()=>{this._reader.read().then(({value:c,done:d})=>{if(d){C.resolve();return}Object.assign(x,c.styles),this._processItems(c.items,x),A()},C.reject)};this._reader=this._textContentSource.getReader(),A()}else if(this._textContentSource){const{items:A,styles:c}=this._textContentSource;this._processItems(A,c),C.resolve()}else throw new Error('No "textContentSource" parameter specified.');C.promise.then(()=>{x=null,P(this)},this._capability.reject)}}n.TextLayerRenderTask=E;function v(y){!y.textContentSource&&(y.textContent||y.textContentStream)&&((0,f.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),y.textContentSource=y.textContent||y.textContentStream);const{container:C,viewport:x}=y,A=getComputedStyle(C),c=A.getPropertyValue("visibility"),d=parseFloat(A.getPropertyValue("--scale-factor"));c==="visible"&&(!d||Math.abs(d-x.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const M=new E(y);return M._render(),M}function p({container:y,viewport:C,textDivs:x,textDivProperties:A,isOffscreenCanvasSupported:c,mustRotate:d=!0,mustRescale:M=!0}){if(d&&(0,f.setLayerDimensions)(y,{rotation:C.rotation}),M){const b=R(0,c),w={prevFontSize:null,prevFontFamily:null,div:null,scale:C.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:b};for(const g of x)w.properties=A.get(g),w.div=g,N(w)}}},(D,n,L)=>{var m,I,N,P,E,v,p,y,C,x,A,sn,d,Fe,b,rn,w,an;Object.defineProperty(n,"__esModule",{value:!0}),n.AnnotationEditorLayer=void 0;var i=L(1),f=L(4),z=L(28),H=L(33),ct=L(6),F=L(34);const $=class ${constructor({uiManager:S,pageIndex:X,div:tt,accessibilityManager:at,annotationLayer:G,viewport:ut,l10n:yt}){W(this,A);W(this,d);W(this,b);W(this,w);W(this,m,void 0);W(this,I,!1);W(this,N,null);W(this,P,this.pointerup.bind(this));W(this,E,this.pointerdown.bind(this));W(this,v,new Map);W(this,p,!1);W(this,y,!1);W(this,C,!1);W(this,x,void 0);const Tt=[z.FreeTextEditor,H.InkEditor,F.StampEditor];if(!$._initialized){$._initialized=!0;for(const wt of Tt)wt.initialize(yt)}S.registerEditorTypes(Tt),ot(this,x,S),this.pageIndex=X,this.div=tt,ot(this,m,at),ot(this,N,G),this.viewport=ut,t(this,x).addLayer(this)}get isEmpty(){return t(this,v).size===0}updateToolbar(S){t(this,x).updateToolbar(S)}updateMode(S=t(this,x).getMode()){Y(this,w,an).call(this),S===i.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),S!==i.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",S===i.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",S===i.AnnotationEditorType.INK),this.div.classList.toggle("stampEditing",S===i.AnnotationEditorType.STAMP),this.div.hidden=!1)}addInkEditorIfNeeded(S){if(!S&&t(this,x).getMode()!==i.AnnotationEditorType.INK)return;if(!S){for(const tt of t(this,v).values())if(tt.isEmpty()){tt.setInBackground();return}}Y(this,d,Fe).call(this,{offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(S){t(this,x).setEditingState(S)}addCommands(S){t(this,x).addCommands(S)}enable(){this.div.style.pointerEvents="auto";const S=new Set;for(const tt of t(this,v).values())tt.enableEditing(),tt.annotationElementId&&S.add(tt.annotationElementId);if(!t(this,N))return;const X=t(this,N).getEditableAnnotations();for(const tt of X){if(tt.hide(),t(this,x).isDeletedAnnotationElement(tt.data.id)||S.has(tt.data.id))continue;const at=this.deserialize(tt);at&&(this.addOrRebuild(at),at.enableEditing())}}disable(){var X;ot(this,C,!0),this.div.style.pointerEvents="none";const S=new Set;for(const tt of t(this,v).values()){if(tt.disableEditing(),!tt.annotationElementId||tt.serialize()!==null){S.add(tt.annotationElementId);continue}(X=this.getEditableAnnotation(tt.annotationElementId))==null||X.show(),tt.remove()}if(t(this,N)){const tt=t(this,N).getEditableAnnotations();for(const at of tt){const{id:G}=at.data;S.has(G)||t(this,x).isDeletedAnnotationElement(G)||at.show()}}Y(this,w,an).call(this),this.isEmpty&&(this.div.hidden=!0),ot(this,C,!1)}getEditableAnnotation(S){var X;return((X=t(this,N))==null?void 0:X.getEditableAnnotation(S))||null}setActiveEditor(S){t(this,x).getActive()!==S&&t(this,x).setActiveEditor(S)}enableClick(){this.div.addEventListener("pointerdown",t(this,E)),this.div.addEventListener("pointerup",t(this,P))}disableClick(){this.div.removeEventListener("pointerdown",t(this,E)),this.div.removeEventListener("pointerup",t(this,P))}attach(S){t(this,v).set(S.id,S);const{annotationElementId:X}=S;X&&t(this,x).isDeletedAnnotationElement(X)&&t(this,x).removeDeletedAnnotationElement(S)}detach(S){var X;t(this,v).delete(S.id),(X=t(this,m))==null||X.removePointerInTextLayer(S.contentDiv),!t(this,C)&&S.annotationElementId&&t(this,x).addDeletedAnnotationElement(S)}remove(S){this.detach(S),t(this,x).removeEditor(S),S.div.contains(document.activeElement)&&setTimeout(()=>{t(this,x).focusMainContainer()},0),S.div.remove(),S.isAttachedToDOM=!1,t(this,y)||this.addInkEditorIfNeeded(!1)}changeParent(S){var X;S.parent!==this&&(S.annotationElementId&&(t(this,x).addDeletedAnnotationElement(S.annotationElementId),f.AnnotationEditor.deleteAnnotationElement(S),S.annotationElementId=null),this.attach(S),(X=S.parent)==null||X.detach(S),S.setParent(this),S.div&&S.isAttachedToDOM&&(S.div.remove(),this.div.append(S.div)))}add(S){if(this.changeParent(S),t(this,x).addEditor(S),this.attach(S),!S.isAttachedToDOM){const X=S.render();this.div.append(X),S.isAttachedToDOM=!0}S.fixAndSetPosition(),S.onceAdded(),t(this,x).addToAnnotationStorage(S)}moveEditorInDOM(S){var tt;if(!S.isAttachedToDOM)return;const{activeElement:X}=document;S.div.contains(X)&&(S._focusEventsAllowed=!1,setTimeout(()=>{S.div.contains(document.activeElement)?S._focusEventsAllowed=!0:(S.div.addEventListener("focusin",()=>{S._focusEventsAllowed=!0},{once:!0}),X.focus())},0)),S._structTreeParentId=(tt=t(this,m))==null?void 0:tt.moveElementInDOM(this.div,S.div,S.contentDiv,!0)}addOrRebuild(S){S.needsToBeRebuilt()?S.rebuild():this.add(S)}addUndoableEditor(S){const X=()=>S._uiManager.rebuild(S),tt=()=>{S.remove()};this.addCommands({cmd:X,undo:tt,mustExec:!1})}getNextId(){return t(this,x).getId()}pasteEditor(S,X){t(this,x).updateToolbar(S),t(this,x).updateMode(S);const{offsetX:tt,offsetY:at}=Y(this,b,rn).call(this),G=this.getNextId(),ut=Y(this,A,sn).call(this,{parent:this,id:G,x:tt,y:at,uiManager:t(this,x),isCentered:!0,...X});ut&&this.add(ut)}deserialize(S){var X;switch((X=S.annotationType)!=null?X:S.annotationEditorType){case i.AnnotationEditorType.FREETEXT:return z.FreeTextEditor.deserialize(S,this,t(this,x));case i.AnnotationEditorType.INK:return H.InkEditor.deserialize(S,this,t(this,x));case i.AnnotationEditorType.STAMP:return F.StampEditor.deserialize(S,this,t(this,x))}return null}addNewEditor(){Y(this,d,Fe).call(this,Y(this,b,rn).call(this),!0)}setSelected(S){t(this,x).setSelected(S)}toggleSelected(S){t(this,x).toggleSelected(S)}isSelected(S){return t(this,x).isSelected(S)}unselect(S){t(this,x).unselect(S)}pointerup(S){const{isMac:X}=i.FeatureTest.platform;if(!(S.button!==0||S.ctrlKey&&X)&&S.target===this.div&&t(this,p)){if(ot(this,p,!1),!t(this,I)){ot(this,I,!0);return}if(t(this,x).getMode()===i.AnnotationEditorType.STAMP){t(this,x).unselectAll();return}Y(this,d,Fe).call(this,S,!1)}}pointerdown(S){if(t(this,p)){ot(this,p,!1);return}const{isMac:X}=i.FeatureTest.platform;if(S.button!==0||S.ctrlKey&&X||S.target!==this.div)return;ot(this,p,!0);const tt=t(this,x).getActive();ot(this,I,!tt||tt.isEmpty())}findNewParent(S,X,tt){const at=t(this,x).findParent(X,tt);return at===null||at===this?!1:(at.changeParent(S),!0)}destroy(){var S,X;((S=t(this,x).getActive())==null?void 0:S.parent)===this&&(t(this,x).commitOrRemove(),t(this,x).setActiveEditor(null));for(const tt of t(this,v).values())(X=t(this,m))==null||X.removePointerInTextLayer(tt.contentDiv),tt.setParent(null),tt.isAttachedToDOM=!1,tt.div.remove();this.div=null,t(this,v).clear(),t(this,x).removeLayer(this)}render({viewport:S}){this.viewport=S,(0,ct.setLayerDimensions)(this.div,S);for(const X of t(this,x).getEditors(this.pageIndex))this.add(X);this.updateMode()}update({viewport:S}){t(this,x).commitOrRemove(),this.viewport=S,(0,ct.setLayerDimensions)(this.div,{rotation:S.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:S,pageHeight:X}=this.viewport.rawDims;return[S,X]}};m=new WeakMap,I=new WeakMap,N=new WeakMap,P=new WeakMap,E=new WeakMap,v=new WeakMap,p=new WeakMap,y=new WeakMap,C=new WeakMap,x=new WeakMap,A=new WeakSet,sn=function(S){switch(t(this,x).getMode()){case i.AnnotationEditorType.FREETEXT:return new z.FreeTextEditor(S);case i.AnnotationEditorType.INK:return new H.InkEditor(S);case i.AnnotationEditorType.STAMP:return new F.StampEditor(S)}return null},d=new WeakSet,Fe=function(S,X){const tt=this.getNextId(),at=Y(this,A,sn).call(this,{parent:this,id:tt,x:S.offsetX,y:S.offsetY,uiManager:t(this,x),isCentered:X});return at&&this.add(at),at},b=new WeakSet,rn=function(){const{x:S,y:X,width:tt,height:at}=this.div.getBoundingClientRect(),G=Math.max(0,S),ut=Math.max(0,X),yt=Math.min(window.innerWidth,S+tt),Tt=Math.min(window.innerHeight,X+at),wt=(G+yt)/2-S,k=(ut+Tt)/2-X,[s,o]=this.viewport.rotation%180===0?[wt,k]:[k,wt];return{offsetX:s,offsetY:o}},w=new WeakSet,an=function(){ot(this,y,!0);for(const S of t(this,v).values())S.isEmpty()&&S.remove();ot(this,y,!1)},se($,"_initialized",!1);let R=$;n.AnnotationEditorLayer=R},(D,n,L)=>{var F,R,m,I,N,P,E,v,p,y,Dn,x,Ln,c,On,M,Ee,l,on,g,In,V,ln;Object.defineProperty(n,"__esModule",{value:!0}),n.FreeTextEditor=void 0;var i=L(1),f=L(5),z=L(4),H=L(29);const X=class X extends z.AnnotationEditor{constructor(G){super({...G,name:"freeTextEditor"});W(this,y);W(this,x);W(this,c);W(this,M);W(this,l);W(this,g);W(this,V);W(this,F,this.editorDivBlur.bind(this));W(this,R,this.editorDivFocus.bind(this));W(this,m,this.editorDivInput.bind(this));W(this,I,this.editorDivKeydown.bind(this));W(this,N,void 0);W(this,P,"");W(this,E,"".concat(this.id,"-editor"));W(this,v,void 0);W(this,p,null);ot(this,N,G.color||X._defaultColor||z.AnnotationEditor._defaultLineColor),ot(this,v,G.fontSize||X._defaultFontSize)}static get _keyboardManager(){const G=X.prototype,ut=wt=>wt.isEmpty(),yt=f.AnnotationEditorUIManager.TRANSLATE_SMALL,Tt=f.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,i.shadow)(this,"_keyboardManager",new f.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],G.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],G.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],G._translateEmpty,{args:[-yt,0],checker:ut}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],G._translateEmpty,{args:[-Tt,0],checker:ut}],[["ArrowRight","mac+ArrowRight"],G._translateEmpty,{args:[yt,0],checker:ut}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],G._translateEmpty,{args:[Tt,0],checker:ut}],[["ArrowUp","mac+ArrowUp"],G._translateEmpty,{args:[0,-yt],checker:ut}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],G._translateEmpty,{args:[0,-Tt],checker:ut}],[["ArrowDown","mac+ArrowDown"],G._translateEmpty,{args:[0,yt],checker:ut}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],G._translateEmpty,{args:[0,Tt],checker:ut}]]))}static initialize(G){z.AnnotationEditor.initialize(G,{strings:["free_text2_default_content","editor_free_text2_aria_label"]});const ut=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(ut.getPropertyValue("--freetext-padding"))}static updateDefaultParams(G,ut){switch(G){case i.AnnotationEditorParamsType.FREETEXT_SIZE:X._defaultFontSize=ut;break;case i.AnnotationEditorParamsType.FREETEXT_COLOR:X._defaultColor=ut;break}}updateParams(G,ut){switch(G){case i.AnnotationEditorParamsType.FREETEXT_SIZE:Y(this,y,Dn).call(this,ut);break;case i.AnnotationEditorParamsType.FREETEXT_COLOR:Y(this,x,Ln).call(this,ut);break}}static get defaultPropertiesToUpdate(){return[[i.AnnotationEditorParamsType.FREETEXT_SIZE,X._defaultFontSize],[i.AnnotationEditorParamsType.FREETEXT_COLOR,X._defaultColor||z.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[i.AnnotationEditorParamsType.FREETEXT_SIZE,t(this,v)],[i.AnnotationEditorParamsType.FREETEXT_COLOR,t(this,N)]]}_translateEmpty(G,ut){this._uiManager.translateSelectedEditors(G,ut,!0)}getInitialTranslation(){const G=this.parentScale;return[-X._internalPadding*G,-(X._internalPadding+t(this,v))*G]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(i.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",t(this,I)),this.editorDiv.addEventListener("focus",t(this,R)),this.editorDiv.addEventListener("blur",t(this,F)),this.editorDiv.addEventListener("input",t(this,m)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",t(this,E)),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",t(this,I)),this.editorDiv.removeEventListener("focus",t(this,R)),this.editorDiv.removeEventListener("blur",t(this,F)),this.editorDiv.removeEventListener("input",t(this,m)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(G){this._focusEventsAllowed&&(super.focusin(G),G.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var G;if(this.width){Y(this,V,ln).call(this);return}this.enableEditMode(),this.editorDiv.focus(),(G=this._initialOptions)!=null&&G.isCentered&&this.center(),this._initialOptions=null}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const G=t(this,P),ut=ot(this,P,Y(this,c,On).call(this).trimEnd());if(G===ut)return;const yt=Tt=>{if(ot(this,P,Tt),!Tt){this.remove();return}Y(this,l,on).call(this),this._uiManager.rebuild(this),Y(this,M,Ee).call(this)};this.addCommands({cmd:()=>{yt(ut)},undo:()=>{yt(G)},mustExec:!1}),Y(this,M,Ee).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(G){this.enterInEditMode()}keydown(G){G.target===this.div&&G.key==="Enter"&&(this.enterInEditMode(),G.preventDefault())}editorDivKeydown(G){X._keyboardManager.exec(this,G)}editorDivFocus(G){this.isEditing=!0}editorDivBlur(G){this.isEditing=!1}editorDivInput(G){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let G,ut;this.width&&(G=this.x,ut=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",t(this,E)),this.enableEditing(),z.AnnotationEditor._l10nPromise.get("editor_free_text2_aria_label").then(Tt=>{var wt;return(wt=this.editorDiv)==null?void 0:wt.setAttribute("aria-label",Tt)}),z.AnnotationEditor._l10nPromise.get("free_text2_default_content").then(Tt=>{var wt;return(wt=this.editorDiv)==null?void 0:wt.setAttribute("default-content",Tt)}),this.editorDiv.contentEditable=!0;const{style:yt}=this.editorDiv;if(yt.fontSize="calc(".concat(t(this,v),"px * var(--scale-factor))"),yt.color=t(this,N),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,f.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[Tt,wt]=this.parentDimensions;if(this.annotationElementId){const{position:k}=t(this,p);let[s,o]=this.getInitialTranslation();[s,o]=this.pageTranslationToScreen(s,o);const[a,h]=this.pageDimensions,[u,T]=this.pageTranslation;let O,U;switch(this.rotation){case 0:O=G+(k[0]-u)/a,U=ut+this.height-(k[1]-T)/h;break;case 90:O=G+(k[0]-u)/a,U=ut-(k[1]-T)/h,[s,o]=[o,-s];break;case 180:O=G-this.width+(k[0]-u)/a,U=ut-(k[1]-T)/h,[s,o]=[-s,-o];break;case 270:O=G+(k[0]-u-this.height*h)/a,U=ut+(k[1]-T-this.width*a)/h,[s,o]=[-o,s];break}this.setAt(O*Tt,U*wt,s,o)}else this.setAt(G*Tt,ut*wt,this.width*Tt,this.height*wt);Y(this,l,on).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(G,ut,yt){let Tt=null;if(G instanceof H.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:k,fontColor:s},rect:o,rotation:a,id:h},textContent:u,textPosition:T,parent:{page:{pageNumber:O}}}=G;if(!u||u.length===0)return null;Tt=G={annotationType:i.AnnotationEditorType.FREETEXT,color:Array.from(s),fontSize:k,value:u.join("\n"),position:T,pageIndex:O-1,rect:o,rotation:a,id:h,deleted:!1}}const wt=super.deserialize(G,ut,yt);return ot(wt,v,G.fontSize),ot(wt,N,i.Util.makeHexColor(...G.color)),ot(wt,P,G.value),wt.annotationElementId=G.id||null,ot(wt,p,Tt),wt}serialize(G=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const ut=X._internalPadding*this.parentScale,yt=this.getRect(ut,ut),Tt=z.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:t(this,N)),wt={annotationType:i.AnnotationEditorType.FREETEXT,color:Tt,fontSize:t(this,v),value:t(this,P),pageIndex:this.pageIndex,rect:yt,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return G?wt:this.annotationElementId&&!Y(this,g,In).call(this,wt)?null:(wt.id=this.annotationElementId,wt)}};F=new WeakMap,R=new WeakMap,m=new WeakMap,I=new WeakMap,N=new WeakMap,P=new WeakMap,E=new WeakMap,v=new WeakMap,p=new WeakMap,y=new WeakSet,Dn=function(G){const ut=Tt=>{this.editorDiv.style.fontSize="calc(".concat(Tt,"px * var(--scale-factor))"),this.translate(0,-(Tt-t(this,v))*this.parentScale),ot(this,v,Tt),Y(this,M,Ee).call(this)},yt=t(this,v);this.addCommands({cmd:()=>{ut(G)},undo:()=>{ut(yt)},mustExec:!0,type:i.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},x=new WeakSet,Ln=function(G){const ut=t(this,N);this.addCommands({cmd:()=>{ot(this,N,this.editorDiv.style.color=G)},undo:()=>{ot(this,N,this.editorDiv.style.color=ut)},mustExec:!0,type:i.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},c=new WeakSet,On=function(){const G=this.editorDiv.getElementsByTagName("div");if(G.length===0)return this.editorDiv.innerText;const ut=[];for(const yt of G)ut.push(yt.innerText.replace(/\r\n?|\n/,""));return ut.join("\n")},M=new WeakSet,Ee=function(){const[G,ut]=this.parentDimensions;let yt;if(this.isAttachedToDOM)yt=this.div.getBoundingClientRect();else{const{currentLayer:Tt,div:wt}=this,k=wt.style.display;wt.style.display="hidden",Tt.div.append(this.div),yt=wt.getBoundingClientRect(),wt.remove(),wt.style.display=k}this.rotation%180===this.parentRotation%180?(this.width=yt.width/G,this.height=yt.height/ut):(this.width=yt.height/G,this.height=yt.width/ut),this.fixAndSetPosition()},l=new WeakSet,on=function(){if(this.editorDiv.replaceChildren(),!!t(this,P))for(const G of t(this,P).split("\n")){const ut=document.createElement("div");ut.append(G?document.createTextNode(G):document.createElement("br")),this.editorDiv.append(ut)}},g=new WeakSet,In=function(G){const{value:ut,fontSize:yt,color:Tt,rect:wt,pageIndex:k}=t(this,p);return G.value!==ut||G.fontSize!==yt||G.rect.some((s,o)=>Math.abs(s-wt[o])>=1)||G.color.some((s,o)=>s!==Tt[o])||G.pageIndex!==k},V=new WeakSet,ln=function(G=!1){if(!this.annotationElementId)return;if(Y(this,M,Ee).call(this),!G&&(this.width===0||this.height===0)){setTimeout(()=>Y(this,V,ln).call(this,!0),0);return}const ut=X._internalPadding*this.parentScale;t(this,p).rect=this.getRect(ut,ut)},se(X,"_freeTextDefaultContent",""),se(X,"_internalPadding",0),se(X,"_defaultColor",null),se(X,"_defaultFontSize",10),se(X,"_type","freetext");let ct=X;n.FreeTextEditor=ct},(D,n,L)=>{var o,h,de,T,Nn,U,rt,nt,lt,pt,mt,dt,kt,Nt,St,Ot,bt,it,st,gt,Pt,Ct,$t,jn,Ht,Me,zt,cn,Xt,hn,et,K,At,vt,ne,ee,Z,dn,It,Ft,Bt,Ut,Bn,Et,un;Object.defineProperty(n,"__esModule",{value:!0}),n.StampAnnotationElement=n.InkAnnotationElement=n.FreeTextAnnotationElement=n.AnnotationLayer=void 0;var i=L(1),f=L(6),z=L(3),H=L(30),ct=L(31),F=L(32);const R=1e3,m=9,I=new WeakSet;function N(jt){return{width:jt[2]-jt[0],height:jt[3]-jt[1]}}class P{static create(j){switch(j.data.annotationType){case i.AnnotationType.LINK:return new v(j);case i.AnnotationType.TEXT:return new p(j);case i.AnnotationType.WIDGET:switch(j.data.fieldType){case"Tx":return new C(j);case"Btn":return j.data.radioButton?new c(j):j.data.checkBox?new A(j):new d(j);case"Ch":return new M(j);case"Sig":return new x(j)}return new y(j);case i.AnnotationType.POPUP:return new b(j);case i.AnnotationType.FREETEXT:return new w(j);case i.AnnotationType.LINE:return new g(j);case i.AnnotationType.SQUARE:return new $(j);case i.AnnotationType.CIRCLE:return new V(j);case i.AnnotationType.POLYLINE:return new S(j);case i.AnnotationType.CARET:return new tt(j);case i.AnnotationType.INK:return new at(j);case i.AnnotationType.POLYGON:return new X(j);case i.AnnotationType.HIGHLIGHT:return new G(j);case i.AnnotationType.UNDERLINE:return new ut(j);case i.AnnotationType.SQUIGGLY:return new yt(j);case i.AnnotationType.STRIKEOUT:return new Tt(j);case i.AnnotationType.STAMP:return new wt(j);case i.AnnotationType.FILEATTACHMENT:return new k(j);default:return new E(j)}}}const a=class a{constructor(j,{isRenderable:e=!1,ignoreBorder:_=!1,createQuadrilaterals:B=!1}={}){W(this,o,!1);this.isRenderable=e,this.data=j.data,this.layer=j.layer,this.linkService=j.linkService,this.downloadManager=j.downloadManager,this.imageResourcesPath=j.imageResourcesPath,this.renderForms=j.renderForms,this.svgFactory=j.svgFactory,this.annotationStorage=j.annotationStorage,this.enableScripting=j.enableScripting,this.hasJSActions=j.hasJSActions,this._fieldObjects=j.fieldObjects,this.parent=j.parent,e&&(this.container=this._createContainer(_)),B&&this._createQuadrilaterals()}static _hasPopupData({titleObj:j,contentsObj:e,richText:_}){return!!(j!=null&&j.str||e!=null&&e.str||_!=null&&_.str)}get hasPopupData(){return a._hasPopupData(this.data)}_createContainer(j){const{data:e,parent:{page:_,viewport:B}}=this,q=document.createElement("section");q.setAttribute("data-annotation-id",e.id),this instanceof y||(q.tabIndex=R),q.style.zIndex=this.parent.zIndex++,this.data.popupRef&&q.setAttribute("aria-haspopup","dialog"),e.noRotate&&q.classList.add("norotate");const{pageWidth:J,pageHeight:ht,pageX:_t,pageY:Rt}=B.rawDims;if(!e.rect||this instanceof b){const{rotation:Wt}=e;return!e.hasOwnCanvas&&Wt!==0&&this.setRotation(Wt,q),q}const{width:Mt,height:qt}=N(e.rect),Dt=i.Util.normalizeRect([e.rect[0],_.view[3]-e.rect[1]+_.view[1],e.rect[2],_.view[3]-e.rect[3]+_.view[1]]);if(!j&&e.borderStyle.width>0){q.style.borderWidth="".concat(e.borderStyle.width,"px");const Wt=e.borderStyle.horizontalCornerRadius,Kt=e.borderStyle.verticalCornerRadius;if(Wt>0||Kt>0){const te="calc(".concat(Wt,"px * var(--scale-factor)) / calc(").concat(Kt,"px * var(--scale-factor))");q.style.borderRadius=te}else if(this instanceof c){const te="calc(".concat(Mt,"px * var(--scale-factor)) / calc(").concat(qt,"px * var(--scale-factor))");q.style.borderRadius=te}switch(e.borderStyle.style){case i.AnnotationBorderStyleType.SOLID:q.style.borderStyle="solid";break;case i.AnnotationBorderStyleType.DASHED:q.style.borderStyle="dashed";break;case i.AnnotationBorderStyleType.BEVELED:(0,i.warn)("Unimplemented border style: beveled");break;case i.AnnotationBorderStyleType.INSET:(0,i.warn)("Unimplemented border style: inset");break;case i.AnnotationBorderStyleType.UNDERLINE:q.style.borderBottomStyle="solid";break}const Qt=e.borderColor||null;Qt?(ot(this,o,!0),q.style.borderColor=i.Util.makeHexColor(Qt[0]|0,Qt[1]|0,Qt[2]|0)):q.style.borderWidth=0}q.style.left="".concat(100*(Dt[0]-_t)/J,"%"),q.style.top="".concat(100*(Dt[1]-Rt)/ht,"%");const{rotation:Lt}=e;return e.hasOwnCanvas||Lt===0?(q.style.width="".concat(100*Mt/J,"%"),q.style.height="".concat(100*qt/ht,"%")):this.setRotation(Lt,q),q}setRotation(j,e=this.container){if(!this.data.rect)return;const{pageWidth:_,pageHeight:B}=this.parent.viewport.rawDims,{width:q,height:J}=N(this.data.rect);let ht,_t;j%180===0?(ht=100*q/_,_t=100*J/B):(ht=100*J/_,_t=100*q/B),e.style.width="".concat(ht,"%"),e.style.height="".concat(_t,"%"),e.setAttribute("data-main-rotation",(360-j)%360)}get _commonActions(){const j=(e,_,B)=>{const q=B.detail[e],J=q[0],ht=q.slice(1);B.target.style[_]=H.ColorConverters["".concat(J,"_HTML")](ht),this.annotationStorage.setValue(this.data.id,{[_]:H.ColorConverters["".concat(J,"_rgb")](ht)})};return(0,i.shadow)(this,"_commonActions",{display:e=>{const{display:_}=e.detail,B=_%2===1;this.container.style.visibility=B?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:B,noPrint:_===1||_===2})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:_}=e.detail;this.container.style.visibility=_?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:_,noView:_})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:e=>{j("bgColor","backgroundColor",e)},fillColor:e=>{j("fillColor","backgroundColor",e)},fgColor:e=>{j("fgColor","color",e)},textColor:e=>{j("textColor","color",e)},borderColor:e=>{j("borderColor","borderColor",e)},strokeColor:e=>{j("strokeColor","borderColor",e)},rotation:e=>{const _=e.detail.rotation;this.setRotation(_),this.annotationStorage.setValue(this.data.id,{rotation:_})}})}_dispatchEventFromSandbox(j,e){const _=this._commonActions;for(const B of Object.keys(e.detail)){const q=j[B]||_[B];q==null||q(e)}}_setDefaultPropertiesFromJS(j){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const _=this._commonActions;for(const[B,q]of Object.entries(e)){const J=_[B];if(J){const ht={detail:{[B]:q},target:j};J(ht),delete e[B]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:j}=this.data;if(!j)return;const[e,_,B,q]=this.data.rect;if(j.length===1){const[,{x:Kt,y:Qt},{x:te,y:re}]=j[0];if(B===Kt&&q===Qt&&e===te&&_===re)return}const{style:J}=this.container;let ht;if(t(this,o)){const{borderColor:Kt,borderWidth:Qt}=J;J.borderWidth=0,ht=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">','<g fill="transparent" stroke="'.concat(Kt,'" stroke-width="').concat(Qt,'">')],this.container.classList.add("hasBorder")}const _t=B-e,Rt=q-_,{svgFactory:Mt}=this,qt=Mt.createElement("svg");qt.classList.add("quadrilateralsContainer"),qt.setAttribute("width",0),qt.setAttribute("height",0);const Dt=Mt.createElement("defs");qt.append(Dt);const Lt=Mt.createElement("clipPath"),Wt="clippath_".concat(this.data.id);Lt.setAttribute("id",Wt),Lt.setAttribute("clipPathUnits","objectBoundingBox"),Dt.append(Lt);for(const[,{x:Kt,y:Qt},{x:te,y:re}]of j){const ie=Mt.createElement("rect"),ae=(te-e)/_t,ce=(q-Qt)/Rt,he=(Kt-te)/_t,vn=(Qt-re)/Rt;ie.setAttribute("x",ae),ie.setAttribute("y",ce),ie.setAttribute("width",he),ie.setAttribute("height",vn),Lt.append(ie),ht==null||ht.push('<rect vector-effect="non-scaling-stroke" x="'.concat(ae,'" y="').concat(ce,'" width="').concat(he,'" height="').concat(vn,'"/>'))}t(this,o)&&(ht.push("</g></svg>')"),J.backgroundImage=ht.join("")),this.container.append(qt),this.container.style.clipPath="url(#".concat(Wt,")")}_createPopup(){const{container:j,data:e}=this;j.setAttribute("aria-haspopup","dialog");const _=new b({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:"popup_".concat(e.id),rotation:e.rotation},parent:this.parent,elements:[this]});this.parent.div.append(_.render())}render(){(0,i.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(j,e=null){const _=[];if(this._fieldObjects){const B=this._fieldObjects[j];if(B)for(const{page:q,id:J,exportValues:ht}of B){if(q===-1||J===e)continue;const _t=typeof ht=="string"?ht:null,Rt=document.querySelector('[data-element-id="'.concat(J,'"]'));if(Rt&&!I.has(Rt)){(0,i.warn)("_getElementsByName - element not allowed: ".concat(J));continue}_.push({id:J,exportValue:_t,domElement:Rt})}return _}for(const B of document.getElementsByName(j)){const{exportValue:q}=B,J=B.getAttribute("data-element-id");J!==e&&I.has(B)&&_.push({id:J,exportValue:q,domElement:B})}return _}show(){var j;this.container&&(this.container.hidden=!1),(j=this.popup)==null||j.maybeShow()}hide(){var j;this.container&&(this.container.hidden=!0),(j=this.popup)==null||j.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const j=this.getElementsToTriggerPopup();if(Array.isArray(j))for(const e of j)e.classList.add("highlightArea");else j.classList.add("highlightArea")}_editOnDoubleClick(){const{annotationEditorType:j,data:{id:e}}=this;this.container.addEventListener("dblclick",()=>{var _;(_=this.linkService.eventBus)==null||_.dispatch("switchannotationeditormode",{source:this,mode:j,editId:e})})}};o=new WeakMap;let E=a;class v extends E{constructor(e,_=null){super(e,{isRenderable:!0,ignoreBorder:!!(_!=null&&_.ignoreBorder),createQuadrilaterals:!0});W(this,h);W(this,T);this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:_}=this,B=document.createElement("a");B.setAttribute("data-element-id",e.id);let q=!1;return e.url?(_.addLinkAttributes(B,e.url,e.newWindow),q=!0):e.action?(this._bindNamedAction(B,e.action),q=!0):e.attachment?(this._bindAttachment(B,e.attachment),q=!0):e.setOCGState?(Y(this,T,Nn).call(this,B,e.setOCGState),q=!0):e.dest?(this._bindLink(B,e.dest),q=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(B,e),q=!0),e.resetForm?(this._bindResetFormAction(B,e.resetForm),q=!0):this.isTooltipOnly&&!q&&(this._bindLink(B,""),q=!0)),this.container.classList.add("linkAnnotation"),q&&this.container.append(B),this.container}_bindLink(e,_){e.href=this.linkService.getDestinationHash(_),e.onclick=()=>(_&&this.linkService.goToDestination(_),!1),(_||_==="")&&Y(this,h,de).call(this)}_bindNamedAction(e,_){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(_),!1),Y(this,h,de).call(this)}_bindAttachment(e,_){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>{var B;return(B=this.downloadManager)==null||B.openOrDownloadData(this.container,_.content,_.filename),!1},Y(this,h,de).call(this)}_bindJSAction(e,_){e.href=this.linkService.getAnchorUrl("");const B=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const q of Object.keys(_.actions)){const J=B.get(q);J&&(e[J]=()=>{var ht;return(ht=this.linkService.eventBus)==null||ht.dispatch("dispatcheventinsandbox",{source:this,detail:{id:_.id,name:q}}),!1})}e.onclick||(e.onclick=()=>!1),Y(this,h,de).call(this)}_bindResetFormAction(e,_){const B=e.onclick;if(B||(e.href=this.linkService.getAnchorUrl("")),Y(this,h,de).call(this),!this._fieldObjects){(0,i.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),B||(e.onclick=()=>!1);return}e.onclick=()=>{var qt;B==null||B();const{fields:q,refs:J,include:ht}=_,_t=[];if(q.length!==0||J.length!==0){const Dt=new Set(J);for(const Lt of q){const Wt=this._fieldObjects[Lt]||[];for(const{id:Kt}of Wt)Dt.add(Kt)}for(const Lt of Object.values(this._fieldObjects))for(const Wt of Lt)Dt.has(Wt.id)===ht&&_t.push(Wt)}else for(const Dt of Object.values(this._fieldObjects))_t.push(...Dt);const Rt=this.annotationStorage,Mt=[];for(const Dt of _t){const{id:Lt}=Dt;switch(Mt.push(Lt),Dt.type){case"text":{const Kt=Dt.defaultValue||"";Rt.setValue(Lt,{value:Kt});break}case"checkbox":case"radiobutton":{const Kt=Dt.defaultValue===Dt.exportValues;Rt.setValue(Lt,{value:Kt});break}case"combobox":case"listbox":{const Kt=Dt.defaultValue||"";Rt.setValue(Lt,{value:Kt});break}default:continue}const Wt=document.querySelector('[data-element-id="'.concat(Lt,'"]'));if(Wt){if(!I.has(Wt)){(0,i.warn)("_bindResetFormAction - element not allowed: ".concat(Lt));continue}}else continue;Wt.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((qt=this.linkService.eventBus)==null||qt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:Mt,name:"ResetForm"}})),!1}}}h=new WeakSet,de=function(){this.container.setAttribute("data-internal-link","")},T=new WeakSet,Nn=function(e,_){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(_),!1),Y(this,h,de).call(this)};class p extends E{constructor(j){super(j,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const j=document.createElement("img");return j.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",j.alt="[{{type}} Annotation]",j.dataset.l10nId="text_annotation_type",j.dataset.l10nArgs=JSON.stringify({type:this.data.name}),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(j),this.container}}class y extends E{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(j){var e;this.data.hasOwnCanvas&&(((e=j.previousSibling)==null?void 0:e.nodeName)==="CANVAS"&&(j.previousSibling.hidden=!0),j.hidden=!1)}_getKeyModifier(j){const{isWin:e,isMac:_}=i.FeatureTest.platform;return e&&j.ctrlKey||_&&j.metaKey}_setEventListener(j,e,_,B,q){_.includes("mouse")?j.addEventListener(_,J=>{var ht;(ht=this.linkService.eventBus)==null||ht.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:B,value:q(J),shift:J.shiftKey,modifier:this._getKeyModifier(J)}})}):j.addEventListener(_,J=>{var ht;if(_==="blur"){if(!e.focused||!J.relatedTarget)return;e.focused=!1}else if(_==="focus"){if(e.focused)return;e.focused=!0}q&&((ht=this.linkService.eventBus)==null||ht.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:B,value:q(J)}}))})}_setEventListeners(j,e,_,B){var q,J,ht;for(const[_t,Rt]of _)(Rt==="Action"||(q=this.data.actions)!=null&&q[Rt])&&((Rt==="Focus"||Rt==="Blur")&&(e||(e={focused:!1})),this._setEventListener(j,e,_t,Rt,B),Rt==="Focus"&&!((J=this.data.actions)!=null&&J.Blur)?this._setEventListener(j,e,"blur","Blur",null):Rt==="Blur"&&!((ht=this.data.actions)!=null&&ht.Focus)&&this._setEventListener(j,e,"focus","Focus",null))}_setBackgroundColor(j){const e=this.data.backgroundColor||null;j.style.backgroundColor=e===null?"transparent":i.Util.makeHexColor(e[0],e[1],e[2])}_setTextStyle(j){const e=["left","center","right"],{fontColor:_}=this.data.defaultAppearanceData,B=this.data.defaultAppearanceData.fontSize||m,q=j.style;let J;const ht=2,_t=Rt=>Math.round(10*Rt)/10;if(this.data.multiLine){const Rt=Math.abs(this.data.rect[3]-this.data.rect[1]-ht),Mt=Math.round(Rt/(i.LINE_FACTOR*B))||1,qt=Rt/Mt;J=Math.min(B,_t(qt/i.LINE_FACTOR))}else{const Rt=Math.abs(this.data.rect[3]-this.data.rect[1]-ht);J=Math.min(B,_t(Rt/i.LINE_FACTOR))}q.fontSize="calc(".concat(J,"px * var(--scale-factor))"),q.color=i.Util.makeHexColor(_[0],_[1],_[2]),this.data.textAlignment!==null&&(q.textAlign=e[this.data.textAlignment])}_setRequired(j,e){e?j.setAttribute("required",!0):j.removeAttribute("required"),j.setAttribute("aria-required",e)}}class C extends y{constructor(j){const e=j.renderForms||!j.data.hasAppearance&&!!j.data.fieldValue;super(j,{isRenderable:e})}setPropertyOnSiblings(j,e,_,B){const q=this.annotationStorage;for(const J of this._getElementsByName(j.name,j.id))J.domElement&&(J.domElement[e]=_),q.setValue(J.id,{[B]:_})}render(){var B,q;const j=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let _=null;if(this.renderForms){const J=j.getValue(e,{value:this.data.fieldValue});let ht=J.value||"";const _t=j.getValue(e,{charLimit:this.data.maxLen}).charLimit;_t&&ht.length>_t&&(ht=ht.slice(0,_t));let Rt=J.formattedValue||((B=this.data.textContent)==null?void 0:B.join("\n"))||null;Rt&&this.data.comb&&(Rt=Rt.replaceAll(/\s+/g,""));const Mt={userValue:ht,formattedValue:Rt,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(_=document.createElement("textarea"),_.textContent=Rt!=null?Rt:ht,this.data.doNotScroll&&(_.style.overflowY="hidden")):(_=document.createElement("input"),_.type="text",_.setAttribute("value",Rt!=null?Rt:ht),this.data.doNotScroll&&(_.style.overflowX="hidden")),this.data.hasOwnCanvas&&(_.hidden=!0),I.add(_),_.setAttribute("data-element-id",e),_.disabled=this.data.readOnly,_.name=this.data.fieldName,_.tabIndex=R,this._setRequired(_,this.data.required),_t&&(_.maxLength=_t),_.addEventListener("input",Dt=>{j.setValue(e,{value:Dt.target.value}),this.setPropertyOnSiblings(_,"value",Dt.target.value,"value"),Mt.formattedValue=null}),_.addEventListener("resetform",Dt=>{var Wt;const Lt=(Wt=this.data.defaultFieldValue)!=null?Wt:"";_.value=Mt.userValue=Lt,Mt.formattedValue=null});let qt=Dt=>{const{formattedValue:Lt}=Mt;Lt!=null&&(Dt.target.value=Lt),Dt.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){_.addEventListener("focus",Lt=>{if(Mt.focused)return;const{target:Wt}=Lt;Mt.userValue&&(Wt.value=Mt.userValue),Mt.lastCommittedValue=Wt.value,Mt.commitKey=1,Mt.focused=!0}),_.addEventListener("updatefromsandbox",Lt=>{this.showElementAndHideCanvas(Lt.target);const Wt={value(Kt){var Qt;Mt.userValue=(Qt=Kt.detail.value)!=null?Qt:"",j.setValue(e,{value:Mt.userValue.toString()}),Kt.target.value=Mt.userValue},formattedValue(Kt){const{formattedValue:Qt}=Kt.detail;Mt.formattedValue=Qt,Qt!=null&&Kt.target!==document.activeElement&&(Kt.target.value=Qt),j.setValue(e,{formattedValue:Qt})},selRange(Kt){Kt.target.setSelectionRange(...Kt.detail.selRange)},charLimit:Kt=>{var ie;const{charLimit:Qt}=Kt.detail,{target:te}=Kt;if(Qt===0){te.removeAttribute("maxLength");return}te.setAttribute("maxLength",Qt);let re=Mt.userValue;!re||re.length<=Qt||(re=re.slice(0,Qt),te.value=Mt.userValue=re,j.setValue(e,{value:re}),(ie=this.linkService.eventBus)==null||ie.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:re,willCommit:!0,commitKey:1,selStart:te.selectionStart,selEnd:te.selectionEnd}}))}};this._dispatchEventFromSandbox(Wt,Lt)}),_.addEventListener("keydown",Lt=>{var Qt;Mt.commitKey=1;let Wt=-1;if(Lt.key==="Escape"?Wt=0:Lt.key==="Enter"&&!this.data.multiLine?Wt=2:Lt.key==="Tab"&&(Mt.commitKey=3),Wt===-1)return;const{value:Kt}=Lt.target;Mt.lastCommittedValue!==Kt&&(Mt.lastCommittedValue=Kt,Mt.userValue=Kt,(Qt=this.linkService.eventBus)==null||Qt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:Kt,willCommit:!0,commitKey:Wt,selStart:Lt.target.selectionStart,selEnd:Lt.target.selectionEnd}}))});const Dt=qt;qt=null,_.addEventListener("blur",Lt=>{var Kt;if(!Mt.focused||!Lt.relatedTarget)return;Mt.focused=!1;const{value:Wt}=Lt.target;Mt.userValue=Wt,Mt.lastCommittedValue!==Wt&&((Kt=this.linkService.eventBus)==null||Kt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:Wt,willCommit:!0,commitKey:Mt.commitKey,selStart:Lt.target.selectionStart,selEnd:Lt.target.selectionEnd}})),Dt(Lt)}),(q=this.data.actions)!=null&&q.Keystroke&&_.addEventListener("beforeinput",Lt=>{var ce;Mt.lastCommittedValue=null;const{data:Wt,target:Kt}=Lt,{value:Qt,selectionStart:te,selectionEnd:re}=Kt;let ie=te,ae=re;switch(Lt.inputType){case"deleteWordBackward":{const he=Qt.substring(0,te).match(/\w*[^\w]*$/);he&&(ie-=he[0].length);break}case"deleteWordForward":{const he=Qt.substring(te).match(/^[^\w]*\w*/);he&&(ae+=he[0].length);break}case"deleteContentBackward":te===re&&(ie-=1);break;case"deleteContentForward":te===re&&(ae+=1);break}Lt.preventDefault(),(ce=this.linkService.eventBus)==null||ce.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:Qt,change:Wt||"",willCommit:!1,selStart:ie,selEnd:ae}})}),this._setEventListeners(_,Mt,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Lt=>Lt.target.value)}if(qt&&_.addEventListener("blur",qt),this.data.comb){const Lt=(this.data.rect[2]-this.data.rect[0])/_t;_.classList.add("comb"),_.style.letterSpacing="calc(".concat(Lt,"px * var(--scale-factor) - 1ch)")}}else _=document.createElement("div"),_.textContent=this.data.fieldValue,_.style.verticalAlign="middle",_.style.display="table-cell";return this._setTextStyle(_),this._setBackgroundColor(_),this._setDefaultPropertiesFromJS(_),this.container.append(_),this.container}}class x extends y{constructor(j){super(j,{isRenderable:!!j.data.hasOwnCanvas})}}class A extends y{constructor(j){super(j,{isRenderable:j.renderForms})}render(){const j=this.annotationStorage,e=this.data,_=e.id;let B=j.getValue(_,{value:e.exportValue===e.fieldValue}).value;typeof B=="string"&&(B=B!=="Off",j.setValue(_,{value:B})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const q=document.createElement("input");return I.add(q),q.setAttribute("data-element-id",_),q.disabled=e.readOnly,this._setRequired(q,this.data.required),q.type="checkbox",q.name=e.fieldName,B&&q.setAttribute("checked",!0),q.setAttribute("exportValue",e.exportValue),q.tabIndex=R,q.addEventListener("change",J=>{const{name:ht,checked:_t}=J.target;for(const Rt of this._getElementsByName(ht,_)){const Mt=_t&&Rt.exportValue===e.exportValue;Rt.domElement&&(Rt.domElement.checked=Mt),j.setValue(Rt.id,{value:Mt})}j.setValue(_,{value:_t})}),q.addEventListener("resetform",J=>{const ht=e.defaultFieldValue||"Off";J.target.checked=ht===e.exportValue}),this.enableScripting&&this.hasJSActions&&(q.addEventListener("updatefromsandbox",J=>{const ht={value(_t){_t.target.checked=_t.detail.value!=="Off",j.setValue(_,{value:_t.target.checked})}};this._dispatchEventFromSandbox(ht,J)}),this._setEventListeners(q,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],J=>J.target.checked)),this._setBackgroundColor(q),this._setDefaultPropertiesFromJS(q),this.container.append(q),this.container}}class c extends y{constructor(j){super(j,{isRenderable:j.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const j=this.annotationStorage,e=this.data,_=e.id;let B=j.getValue(_,{value:e.fieldValue===e.buttonValue}).value;typeof B=="string"&&(B=B!==e.buttonValue,j.setValue(_,{value:B}));const q=document.createElement("input");if(I.add(q),q.setAttribute("data-element-id",_),q.disabled=e.readOnly,this._setRequired(q,this.data.required),q.type="radio",q.name=e.fieldName,B&&q.setAttribute("checked",!0),q.tabIndex=R,q.addEventListener("change",J=>{const{name:ht,checked:_t}=J.target;for(const Rt of this._getElementsByName(ht,_))j.setValue(Rt.id,{value:!1});j.setValue(_,{value:_t})}),q.addEventListener("resetform",J=>{const ht=e.defaultFieldValue;J.target.checked=ht!=null&&ht===e.buttonValue}),this.enableScripting&&this.hasJSActions){const J=e.buttonValue;q.addEventListener("updatefromsandbox",ht=>{const _t={value:Rt=>{const Mt=J===Rt.detail.value;for(const qt of this._getElementsByName(Rt.target.name)){const Dt=Mt&&qt.id===_;qt.domElement&&(qt.domElement.checked=Dt),j.setValue(qt.id,{value:Dt})}}};this._dispatchEventFromSandbox(_t,ht)}),this._setEventListeners(q,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],ht=>ht.target.checked)}return this._setBackgroundColor(q),this._setDefaultPropertiesFromJS(q),this.container.append(q),this.container}}class d extends v{constructor(j){super(j,{ignoreBorder:j.data.hasAppearance})}render(){const j=super.render();j.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(j.title=this.data.alternativeText);const e=j.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",_=>{this._dispatchEventFromSandbox({},_)})),j}}class M extends y{constructor(j){super(j,{isRenderable:j.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const j=this.annotationStorage,e=this.data.id,_=j.getValue(e,{value:this.data.fieldValue}),B=document.createElement("select");I.add(B),B.setAttribute("data-element-id",e),B.disabled=this.data.readOnly,this._setRequired(B,this.data.required),B.name=this.data.fieldName,B.tabIndex=R;let q=this.data.combo&&this.data.options.length>0;this.data.combo||(B.size=this.data.options.length,this.data.multiSelect&&(B.multiple=!0)),B.addEventListener("resetform",Mt=>{const qt=this.data.defaultFieldValue;for(const Dt of B.options)Dt.selected=Dt.value===qt});for(const Mt of this.data.options){const qt=document.createElement("option");qt.textContent=Mt.displayValue,qt.value=Mt.exportValue,_.value.includes(Mt.exportValue)&&(qt.setAttribute("selected",!0),q=!1),B.append(qt)}let J=null;if(q){const Mt=document.createElement("option");Mt.value=" ",Mt.setAttribute("hidden",!0),Mt.setAttribute("selected",!0),B.prepend(Mt),J=()=>{Mt.remove(),B.removeEventListener("input",J),J=null},B.addEventListener("input",J)}const ht=Mt=>{const qt=Mt?"value":"textContent",{options:Dt,multiple:Lt}=B;return Lt?Array.prototype.filter.call(Dt,Wt=>Wt.selected).map(Wt=>Wt[qt]):Dt.selectedIndex===-1?null:Dt[Dt.selectedIndex][qt]};let _t=ht(!1);const Rt=Mt=>{const qt=Mt.target.options;return Array.prototype.map.call(qt,Dt=>({displayValue:Dt.textContent,exportValue:Dt.value}))};return this.enableScripting&&this.hasJSActions?(B.addEventListener("updatefromsandbox",Mt=>{const qt={value(Dt){J==null||J();const Lt=Dt.detail.value,Wt=new Set(Array.isArray(Lt)?Lt:[Lt]);for(const Kt of B.options)Kt.selected=Wt.has(Kt.value);j.setValue(e,{value:ht(!0)}),_t=ht(!1)},multipleSelection(Dt){B.multiple=!0},remove(Dt){const Lt=B.options,Wt=Dt.detail.remove;Lt[Wt].selected=!1,B.remove(Wt),Lt.length>0&&Array.prototype.findIndex.call(Lt,Qt=>Qt.selected)===-1&&(Lt[0].selected=!0),j.setValue(e,{value:ht(!0),items:Rt(Dt)}),_t=ht(!1)},clear(Dt){for(;B.length!==0;)B.remove(0);j.setValue(e,{value:null,items:[]}),_t=ht(!1)},insert(Dt){const{index:Lt,displayValue:Wt,exportValue:Kt}=Dt.detail.insert,Qt=B.children[Lt],te=document.createElement("option");te.textContent=Wt,te.value=Kt,Qt?Qt.before(te):B.append(te),j.setValue(e,{value:ht(!0),items:Rt(Dt)}),_t=ht(!1)},items(Dt){const{items:Lt}=Dt.detail;for(;B.length!==0;)B.remove(0);for(const Wt of Lt){const{displayValue:Kt,exportValue:Qt}=Wt,te=document.createElement("option");te.textContent=Kt,te.value=Qt,B.append(te)}B.options.length>0&&(B.options[0].selected=!0),j.setValue(e,{value:ht(!0),items:Rt(Dt)}),_t=ht(!1)},indices(Dt){const Lt=new Set(Dt.detail.indices);for(const Wt of Dt.target.options)Wt.selected=Lt.has(Wt.index);j.setValue(e,{value:ht(!0)}),_t=ht(!1)},editable(Dt){Dt.target.disabled=!Dt.detail.editable}};this._dispatchEventFromSandbox(qt,Mt)}),B.addEventListener("input",Mt=>{var Dt;const qt=ht(!0);j.setValue(e,{value:qt}),Mt.preventDefault(),(Dt=this.linkService.eventBus)==null||Dt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:_t,changeEx:qt,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(B,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],Mt=>Mt.target.value)):B.addEventListener("input",function(Mt){j.setValue(e,{value:ht(!0)})}),this.data.combo&&this._setTextStyle(B),this._setBackgroundColor(B),this._setDefaultPropertiesFromJS(B),this.container.append(B),this.container}}class b extends E{constructor(j){const{data:e,elements:_}=j;super(j,{isRenderable:E._hasPopupData(e)}),this.elements=_}render(){this.container.classList.add("popupAnnotation");const j=new l({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),e=[];for(const _ of this.elements)_.popup=j,e.push(_.data.id),_.addHighlightArea();return this.container.setAttribute("aria-controls",e.map(_=>"".concat(i.AnnotationPrefix).concat(_)).join(",")),this.container}}class l{constructor({container:j,color:e,elements:_,titleObj:B,modificationDate:q,contentsObj:J,richText:ht,parent:_t,rect:Rt,parentRect:Mt,open:qt}){W(this,$t);W(this,Ht);W(this,zt);W(this,Xt);W(this,U,null);W(this,rt,Y(this,$t,jn).bind(this));W(this,nt,Y(this,Xt,hn).bind(this));W(this,lt,Y(this,zt,cn).bind(this));W(this,pt,Y(this,Ht,Me).bind(this));W(this,mt,null);W(this,dt,null);W(this,kt,null);W(this,Nt,null);W(this,St,null);W(this,Ot,null);W(this,bt,!1);W(this,it,null);W(this,st,null);W(this,gt,null);W(this,Pt,null);W(this,Ct,!1);var Lt;ot(this,dt,j),ot(this,Pt,B),ot(this,kt,J),ot(this,gt,ht),ot(this,St,_t),ot(this,mt,e),ot(this,st,Rt),ot(this,Ot,Mt),ot(this,Nt,_);const Dt=f.PDFDateString.toDateObject(q);Dt&&ot(this,U,_t.l10n.get("annotation_date_string",{date:Dt.toLocaleDateString(),time:Dt.toLocaleTimeString()})),this.trigger=_.flatMap(Wt=>Wt.getElementsToTriggerPopup());for(const Wt of this.trigger)Wt.addEventListener("click",t(this,pt)),Wt.addEventListener("mouseenter",t(this,lt)),Wt.addEventListener("mouseleave",t(this,nt)),Wt.classList.add("popupTriggerArea");for(const Wt of _)(Lt=Wt.container)==null||Lt.addEventListener("keydown",t(this,rt));t(this,dt).hidden=!0,qt&&Y(this,Ht,Me).call(this)}render(){if(t(this,it))return;const{page:{view:j},viewport:{rawDims:{pageWidth:e,pageHeight:_,pageX:B,pageY:q}}}=t(this,St),J=ot(this,it,document.createElement("div"));if(J.className="popup",t(this,mt)){const ie=J.style.outlineColor=i.Util.makeHexColor(...t(this,mt));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?J.style.backgroundColor="color-mix(in srgb, ".concat(ie," 30%, white)"):J.style.backgroundColor=i.Util.makeHexColor(...t(this,mt).map(ce=>Math.floor(.7*(255-ce)+ce)))}const ht=document.createElement("span");ht.className="header";const _t=document.createElement("h1");if(ht.append(_t),{dir:_t.dir,str:_t.textContent}=t(this,Pt),J.append(ht),t(this,U)){const ie=document.createElement("span");ie.classList.add("popupDate"),t(this,U).then(ae=>{ie.textContent=ae}),ht.append(ie)}const Rt=t(this,kt),Mt=t(this,gt);if(Mt!=null&&Mt.str&&(!(Rt!=null&&Rt.str)||Rt.str===Mt.str))F.XfaLayer.render({xfaHtml:Mt.html,intent:"richText",div:J}),J.lastChild.classList.add("richText","popupContent");else{const ie=this._formatContents(Rt);J.append(ie)}let qt=!!t(this,Ot),Dt=qt?t(this,Ot):t(this,st);for(const ie of t(this,Nt))if(!Dt||i.Util.intersect(ie.data.rect,Dt)!==null){Dt=ie.data.rect,qt=!0;break}const Lt=i.Util.normalizeRect([Dt[0],j[3]-Dt[1]+j[1],Dt[2],j[3]-Dt[3]+j[1]]),Wt=5,Kt=qt?Dt[2]-Dt[0]+Wt:0,Qt=Lt[0]+Kt,te=Lt[1],{style:re}=t(this,dt);re.left="".concat(100*(Qt-B)/e,"%"),re.top="".concat(100*(te-q)/_,"%"),t(this,dt).append(J)}_formatContents({str:j,dir:e}){const _=document.createElement("p");_.classList.add("popupContent"),_.dir=e;const B=j.split(/(?:\r\n?|\n)/);for(let q=0,J=B.length;q<J;++q){const ht=B[q];_.append(document.createTextNode(ht)),q<J-1&&_.append(document.createElement("br"))}return _}forceHide(){ot(this,Ct,this.isVisible),t(this,Ct)&&(t(this,dt).hidden=!0)}maybeShow(){t(this,Ct)&&(ot(this,Ct,!1),t(this,dt).hidden=!1)}get isVisible(){return t(this,dt).hidden===!1}}U=new WeakMap,rt=new WeakMap,nt=new WeakMap,lt=new WeakMap,pt=new WeakMap,mt=new WeakMap,dt=new WeakMap,kt=new WeakMap,Nt=new WeakMap,St=new WeakMap,Ot=new WeakMap,bt=new WeakMap,it=new WeakMap,st=new WeakMap,gt=new WeakMap,Pt=new WeakMap,Ct=new WeakMap,$t=new WeakSet,jn=function(j){j.altKey||j.shiftKey||j.ctrlKey||j.metaKey||(j.key==="Enter"||j.key==="Escape"&&t(this,bt))&&Y(this,Ht,Me).call(this)},Ht=new WeakSet,Me=function(){ot(this,bt,!t(this,bt)),t(this,bt)?(Y(this,zt,cn).call(this),t(this,dt).addEventListener("click",t(this,pt)),t(this,dt).addEventListener("keydown",t(this,rt))):(Y(this,Xt,hn).call(this),t(this,dt).removeEventListener("click",t(this,pt)),t(this,dt).removeEventListener("keydown",t(this,rt)))},zt=new WeakSet,cn=function(){t(this,it)||this.render(),this.isVisible?t(this,bt)&&t(this,dt).classList.add("focused"):(t(this,dt).hidden=!1,t(this,dt).style.zIndex=parseInt(t(this,dt).style.zIndex)+1e3)},Xt=new WeakSet,hn=function(){t(this,dt).classList.remove("focused"),!(t(this,bt)||!this.isVisible)&&(t(this,dt).hidden=!0,t(this,dt).style.zIndex=parseInt(t(this,dt).style.zIndex)-1e3)};class w extends E{constructor(j){super(j,{isRenderable:!0,ignoreBorder:!0}),this.textContent=j.data.textContent,this.textPosition=j.data.textPosition,this.annotationEditorType=i.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const j=document.createElement("div");j.classList.add("annotationTextContent"),j.setAttribute("role","comment");for(const e of this.textContent){const _=document.createElement("span");_.textContent=e,j.append(_)}this.container.append(j)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}n.FreeTextAnnotationElement=w;class g extends E{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});W(this,et,null)}render(){this.container.classList.add("lineAnnotation");const e=this.data,{width:_,height:B}=N(e.rect),q=this.svgFactory.create(_,B,!0),J=ot(this,et,this.svgFactory.createElement("svg:line"));return J.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),J.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),J.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),J.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),J.setAttribute("stroke-width",e.borderStyle.width||1),J.setAttribute("stroke","transparent"),J.setAttribute("fill","transparent"),q.append(J),this.container.append(q),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,et)}addHighlightArea(){this.container.classList.add("highlightArea")}}et=new WeakMap;class $ extends E{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});W(this,K,null)}render(){this.container.classList.add("squareAnnotation");const e=this.data,{width:_,height:B}=N(e.rect),q=this.svgFactory.create(_,B,!0),J=e.borderStyle.width,ht=ot(this,K,this.svgFactory.createElement("svg:rect"));return ht.setAttribute("x",J/2),ht.setAttribute("y",J/2),ht.setAttribute("width",_-J),ht.setAttribute("height",B-J),ht.setAttribute("stroke-width",J||1),ht.setAttribute("stroke","transparent"),ht.setAttribute("fill","transparent"),q.append(ht),this.container.append(q),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,K)}addHighlightArea(){this.container.classList.add("highlightArea")}}K=new WeakMap;class V extends E{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});W(this,At,null)}render(){this.container.classList.add("circleAnnotation");const e=this.data,{width:_,height:B}=N(e.rect),q=this.svgFactory.create(_,B,!0),J=e.borderStyle.width,ht=ot(this,At,this.svgFactory.createElement("svg:ellipse"));return ht.setAttribute("cx",_/2),ht.setAttribute("cy",B/2),ht.setAttribute("rx",_/2-J/2),ht.setAttribute("ry",B/2-J/2),ht.setAttribute("stroke-width",J||1),ht.setAttribute("stroke","transparent"),ht.setAttribute("fill","transparent"),q.append(ht),this.container.append(q),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,At)}addHighlightArea(){this.container.classList.add("highlightArea")}}At=new WeakMap;class S extends E{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});W(this,vt,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const e=this.data,{width:_,height:B}=N(e.rect),q=this.svgFactory.create(_,B,!0);let J=[];for(const _t of e.vertices){const Rt=_t.x-e.rect[0],Mt=e.rect[3]-_t.y;J.push(Rt+","+Mt)}J=J.join(" ");const ht=ot(this,vt,this.svgFactory.createElement(this.svgElementName));return ht.setAttribute("points",J),ht.setAttribute("stroke-width",e.borderStyle.width||1),ht.setAttribute("stroke","transparent"),ht.setAttribute("fill","transparent"),q.append(ht),this.container.append(q),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,vt)}addHighlightArea(){this.container.classList.add("highlightArea")}}vt=new WeakMap;class X extends S{constructor(j){super(j),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class tt extends E{constructor(j){super(j,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class at extends E{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});W(this,ne,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=i.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const e=this.data,{width:_,height:B}=N(e.rect),q=this.svgFactory.create(_,B,!0);for(const J of e.inkLists){let ht=[];for(const Rt of J){const Mt=Rt.x-e.rect[0],qt=e.rect[3]-Rt.y;ht.push("".concat(Mt,",").concat(qt))}ht=ht.join(" ");const _t=this.svgFactory.createElement(this.svgElementName);t(this,ne).push(_t),_t.setAttribute("points",ht),_t.setAttribute("stroke-width",e.borderStyle.width||1),_t.setAttribute("stroke","transparent"),_t.setAttribute("fill","transparent"),!e.popupRef&&this.hasPopupData&&this._createPopup(),q.append(_t)}return this.container.append(q),this.container}getElementsToTriggerPopup(){return t(this,ne)}addHighlightArea(){this.container.classList.add("highlightArea")}}ne=new WeakMap,n.InkAnnotationElement=at;class G extends E{constructor(j){super(j,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class ut extends E{constructor(j){super(j,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class yt extends E{constructor(j){super(j,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class Tt extends E{constructor(j){super(j,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class wt extends E{constructor(j){super(j,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}n.StampAnnotationElement=wt;class k extends E{constructor(e){var q;super(e,{isRenderable:!0});W(this,Z);W(this,ee,null);const{filename:_,content:B}=this.data.file;this.filename=(0,f.getFilenameFromUrl)(_,!0),this.content=B,(q=this.linkService.eventBus)==null||q.dispatch("fileattachmentannotation",{source:this,filename:_,content:B})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:_}=this;let B;_.hasAppearance||_.fillAlpha===0?B=document.createElement("div"):(B=document.createElement("img"),B.src="".concat(this.imageResourcesPath,"annotation-").concat(/paperclip/i.test(_.name)?"paperclip":"pushpin",".svg"),_.fillAlpha&&_.fillAlpha<1&&(B.style="filter: opacity(".concat(Math.round(_.fillAlpha*100),"%);"))),B.addEventListener("dblclick",Y(this,Z,dn).bind(this)),ot(this,ee,B);const{isMac:q}=i.FeatureTest.platform;return e.addEventListener("keydown",J=>{J.key==="Enter"&&(q?J.metaKey:J.ctrlKey)&&Y(this,Z,dn).call(this)}),!_.popupRef&&this.hasPopupData?this._createPopup():B.classList.add("popupTriggerArea"),e.append(B),e}getElementsToTriggerPopup(){return t(this,ee)}addHighlightArea(){this.container.classList.add("highlightArea")}}ee=new WeakMap,Z=new WeakSet,dn=function(){var e;(e=this.downloadManager)==null||e.openOrDownloadData(this.container,this.content,this.filename)};class s{constructor({div:j,accessibilityManager:e,annotationCanvasMap:_,l10n:B,page:q,viewport:J}){W(this,Ut);W(this,Et);W(this,It,null);W(this,Ft,null);W(this,Bt,new Map);this.div=j,ot(this,It,e),ot(this,Ft,_),this.l10n=B,this.page=q,this.viewport=J,this.zIndex=0,this.l10n||(this.l10n=ct.NullL10n)}async render(j){const{annotations:e}=j,_=this.div;(0,f.setLayerDimensions)(_,this.viewport);const B=new Map,q={data:null,layer:_,linkService:j.linkService,downloadManager:j.downloadManager,imageResourcesPath:j.imageResourcesPath||"",renderForms:j.renderForms!==!1,svgFactory:new f.DOMSVGFactory,annotationStorage:j.annotationStorage||new z.AnnotationStorage,enableScripting:j.enableScripting===!0,hasJSActions:j.hasJSActions,fieldObjects:j.fieldObjects,parent:this,elements:null};for(const J of e){if(J.noHTML)continue;const ht=J.annotationType===i.AnnotationType.POPUP;if(ht){const Mt=B.get(J.id);if(!Mt)continue;q.elements=Mt}else{const{width:Mt,height:qt}=N(J.rect);if(Mt<=0||qt<=0)continue}q.data=J;const _t=P.create(q);if(!_t.isRenderable)continue;if(!ht&&J.popupRef){const Mt=B.get(J.popupRef);Mt?Mt.push(_t):B.set(J.popupRef,[_t])}_t.annotationEditorType>0&&t(this,Bt).set(_t.data.id,_t);const Rt=_t.render();J.hidden&&(Rt.style.visibility="hidden"),Y(this,Ut,Bn).call(this,Rt,J.id)}Y(this,Et,un).call(this),await this.l10n.translate(_)}update({viewport:j}){const e=this.div;this.viewport=j,(0,f.setLayerDimensions)(e,{rotation:j.rotation}),Y(this,Et,un).call(this),e.hidden=!1}getEditableAnnotations(){return Array.from(t(this,Bt).values())}getEditableAnnotation(j){return t(this,Bt).get(j)}}It=new WeakMap,Ft=new WeakMap,Bt=new WeakMap,Ut=new WeakSet,Bn=function(j,e){var B;const _=j.firstChild||j;_.id="".concat(i.AnnotationPrefix).concat(e),this.div.append(j),(B=t(this,It))==null||B.moveElementInDOM(this.div,j,_,!1)},Et=new WeakSet,un=function(){if(!t(this,Ft))return;const j=this.div;for(const[e,_]of t(this,Ft)){const B=j.querySelector('[data-annotation-id="'.concat(e,'"]'));if(!B)continue;const{firstChild:q}=B;q?q.nodeName==="CANVAS"?q.replaceWith(_):q.before(_):B.append(_)}t(this,Ft).clear()},n.AnnotationLayer=s},(D,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.ColorConverters=void 0;function L(z){return Math.floor(Math.max(0,Math.min(1,z))*255).toString(16).padStart(2,"0")}function i(z){return Math.max(0,Math.min(255,255*z))}class f{static CMYK_G([H,ct,F,R]){return["G",1-Math.min(1,.3*H+.59*F+.11*ct+R)]}static G_CMYK([H]){return["CMYK",0,0,0,1-H]}static G_RGB([H]){return["RGB",H,H,H]}static G_rgb([H]){return H=i(H),[H,H,H]}static G_HTML([H]){const ct=L(H);return"#".concat(ct).concat(ct).concat(ct)}static RGB_G([H,ct,F]){return["G",.3*H+.59*ct+.11*F]}static RGB_rgb(H){return H.map(i)}static RGB_HTML(H){return"#".concat(H.map(L).join(""))}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([H,ct,F,R]){return["RGB",1-Math.min(1,H+R),1-Math.min(1,F+R),1-Math.min(1,ct+R)]}static CMYK_rgb([H,ct,F,R]){return[i(1-Math.min(1,H+R)),i(1-Math.min(1,F+R)),i(1-Math.min(1,ct+R))]}static CMYK_HTML(H){const ct=this.CMYK_RGB(H).slice(1);return this.RGB_HTML(ct)}static RGB_CMYK([H,ct,F]){const R=1-H,m=1-ct,I=1-F,N=Math.min(R,m,I);return["CMYK",R,m,I,N]}}n.ColorConverters=f},(D,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.NullL10n=void 0,n.getL10nFallback=i;const L={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}} × {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}} × {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing…",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image",editor_alt_text_button_label:"Alt text",editor_alt_text_edit_button_label:"Edit alt text",editor_alt_text_decorative_tooltip:"Marked as decorative"};L.print_progress_percent="{{progress}}%";function i(H,ct){switch(H){case"find_match_count":H="find_match_count[".concat(ct.total===1?"one":"other","]");break;case"find_match_count_limit":H="find_match_count_limit[".concat(ct.limit===1?"one":"other","]");break}return L[H]||""}function f(H,ct){return ct?H.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(F,R)=>R in ct?ct[R]:"{{"+R+"}}"):H}const z={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(H,ct=null,F=i(H,ct)){return f(F,ct)},async translate(H){}};n.NullL10n=z},(D,n,L)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.XfaLayer=void 0;var i=L(25);class f{static setupStorage(H,ct,F,R,m){const I=R.getValue(ct,{value:null});switch(F.name){case"textarea":if(I.value!==null&&(H.textContent=I.value),m==="print")break;H.addEventListener("input",N=>{R.setValue(ct,{value:N.target.value})});break;case"input":if(F.attributes.type==="radio"||F.attributes.type==="checkbox"){if(I.value===F.attributes.xfaOn?H.setAttribute("checked",!0):I.value===F.attributes.xfaOff&&H.removeAttribute("checked"),m==="print")break;H.addEventListener("change",N=>{R.setValue(ct,{value:N.target.checked?N.target.getAttribute("xfaOn"):N.target.getAttribute("xfaOff")})})}else{if(I.value!==null&&H.setAttribute("value",I.value),m==="print")break;H.addEventListener("input",N=>{R.setValue(ct,{value:N.target.value})})}break;case"select":if(I.value!==null){H.setAttribute("value",I.value);for(const N of F.children)N.attributes.value===I.value?N.attributes.selected=!0:N.attributes.hasOwnProperty("selected")&&delete N.attributes.selected}H.addEventListener("input",N=>{const P=N.target.options,E=P.selectedIndex===-1?"":P[P.selectedIndex].value;R.setValue(ct,{value:E})});break}}static setAttributes({html:H,element:ct,storage:F=null,intent:R,linkService:m}){const{attributes:I}=ct,N=H instanceof HTMLAnchorElement;I.type==="radio"&&(I.name="".concat(I.name,"-").concat(R));for(const[P,E]of Object.entries(I))if(E!=null)switch(P){case"class":E.length&&H.setAttribute(P,E.join(" "));break;case"dataId":break;case"id":H.setAttribute("data-element-id",E);break;case"style":Object.assign(H.style,E);break;case"textContent":H.textContent=E;break;default:(!N||P!=="href"&&P!=="newWindow")&&H.setAttribute(P,E)}N&&m.addLinkAttributes(H,I.href,I.newWindow),F&&I.dataId&&this.setupStorage(H,I.dataId,ct,F)}static render(H){var v;const ct=H.annotationStorage,F=H.linkService,R=H.xfaHtml,m=H.intent||"display",I=document.createElement(R.name);R.attributes&&this.setAttributes({html:I,element:R,intent:m,linkService:F});const N=[[R,-1,I]],P=H.div;if(P.append(I),H.viewport){const p="matrix(".concat(H.viewport.transform.join(","),")");P.style.transform=p}m!=="richText"&&P.setAttribute("class","xfaLayer xfaFont");const E=[];for(;N.length>0;){const[p,y,C]=N.at(-1);if(y+1===p.children.length){N.pop();continue}const x=p.children[++N.at(-1)[1]];if(x===null)continue;const{name:A}=x;if(A==="#text"){const d=document.createTextNode(x.value);E.push(d),C.append(d);continue}const c=(v=x==null?void 0:x.attributes)!=null&&v.xmlns?document.createElementNS(x.attributes.xmlns,A):document.createElement(A);if(C.append(c),x.attributes&&this.setAttributes({html:c,element:x,storage:ct,intent:m,linkService:F}),x.children&&x.children.length>0)N.push([x,-1,c]);else if(x.value){const d=document.createTextNode(x.value);i.XfaText.shouldBuildText(A)&&E.push(d),c.append(d)}}for(const p of P.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))p.setAttribute("readOnly",!0);return{textDivs:E}}static update(H){const ct="matrix(".concat(H.viewport.transform.join(","),")");H.div.style.transform=ct,H.div.hidden=!1}}n.XfaLayer=f},(D,n,L)=>{var R,m,I,N,P,E,v,p,y,C,x,A,c,d,M,Un,l,Wn,g,Hn,V,$n,X,fn,at,Gn,ut,pn,Tt,Vn,k,zn,o,Xn,h,qn,T,Yn,U,le,nt,gn,pt,De,dt,Le,Nt,ge,Ot,mn,it,Oe,gt,Kn,Ct,bn,Vt,Jn,Yt,Qn,Gt,yn,ft,Ie,K,me;Object.defineProperty(n,"__esModule",{value:!0}),n.InkEditor=void 0;var i=L(1),f=L(4),z=L(29),H=L(6),ct=L(5);const vt=class vt extends f.AnnotationEditor{constructor(Z){super({...Z,name:"inkEditor"});W(this,M);W(this,l);W(this,g);W(this,V);W(this,X);W(this,at);W(this,ut);W(this,Tt);W(this,k);W(this,o);W(this,h);W(this,T);W(this,U);W(this,nt);W(this,pt);W(this,dt);W(this,Nt);W(this,Ot);W(this,it);W(this,Yt);W(this,Gt);W(this,ft);W(this,K);W(this,R,0);W(this,m,0);W(this,I,this.canvasPointermove.bind(this));W(this,N,this.canvasPointerleave.bind(this));W(this,P,this.canvasPointerup.bind(this));W(this,E,this.canvasPointerdown.bind(this));W(this,v,new Path2D);W(this,p,!1);W(this,y,!1);W(this,C,!1);W(this,x,null);W(this,A,0);W(this,c,0);W(this,d,null);this.color=Z.color||null,this.thickness=Z.thickness||null,this.opacity=Z.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(Z){f.AnnotationEditor.initialize(Z,{strings:["editor_ink_canvas_aria_label","editor_ink2_aria_label"]})}static updateDefaultParams(Z,xt){switch(Z){case i.AnnotationEditorParamsType.INK_THICKNESS:vt._defaultThickness=xt;break;case i.AnnotationEditorParamsType.INK_COLOR:vt._defaultColor=xt;break;case i.AnnotationEditorParamsType.INK_OPACITY:vt._defaultOpacity=xt/100;break}}updateParams(Z,xt){switch(Z){case i.AnnotationEditorParamsType.INK_THICKNESS:Y(this,M,Un).call(this,xt);break;case i.AnnotationEditorParamsType.INK_COLOR:Y(this,l,Wn).call(this,xt);break;case i.AnnotationEditorParamsType.INK_OPACITY:Y(this,g,Hn).call(this,xt);break}}static get defaultPropertiesToUpdate(){return[[i.AnnotationEditorParamsType.INK_THICKNESS,vt._defaultThickness],[i.AnnotationEditorParamsType.INK_COLOR,vt._defaultColor||f.AnnotationEditor._defaultLineColor],[i.AnnotationEditorParamsType.INK_OPACITY,Math.round(vt._defaultOpacity*100)]]}get propertiesToUpdate(){var Z;return[[i.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||vt._defaultThickness],[i.AnnotationEditorParamsType.INK_COLOR,this.color||vt._defaultColor||f.AnnotationEditor._defaultLineColor],[i.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*((Z=this.opacity)!=null?Z:vt._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(Y(this,pt,De).call(this),Y(this,dt,Le).call(this)),this.isAttachedToDOM||(this.parent.add(this),Y(this,Nt,ge).call(this)),Y(this,K,me).call(this)))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,t(this,x).disconnect(),ot(this,x,null),super.remove())}setParent(Z){!this.parent&&Z?this._uiManager.removeShouldRescale(this):this.parent&&Z===null&&this._uiManager.addShouldRescale(this),super.setParent(Z)}onScaleChanging(){const[Z,xt]=this.parentDimensions,It=this.width*Z,Ft=this.height*xt;this.setDimensions(It,Ft)}enableEditMode(){t(this,p)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",t(this,E)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",t(this,E)))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){t(this,p)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),ot(this,p,!0),this.div.classList.add("disabled"),Y(this,K,me).call(this,!0),this.makeResizable(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(Z){this._focusEventsAllowed&&(super.focusin(Z),this.enableEditMode())}canvasPointerdown(Z){Z.button!==0||!this.isInEditMode()||t(this,p)||(this.setInForeground(),Z.preventDefault(),Z.type!=="mouse"&&this.div.focus(),Y(this,at,Gn).call(this,Z.offsetX,Z.offsetY))}canvasPointermove(Z){Z.preventDefault(),Y(this,ut,pn).call(this,Z.offsetX,Z.offsetY)}canvasPointerup(Z){Z.preventDefault(),Y(this,nt,gn).call(this,Z)}canvasPointerleave(Z){Y(this,nt,gn).call(this,Z)}get isResizable(){return!this.isEmpty()&&t(this,p)}render(){if(this.div)return this.div;let Z,xt;this.width&&(Z=this.x,xt=this.y),super.render(),f.AnnotationEditor._l10nPromise.get("editor_ink2_aria_label").then(Zt=>{var Et;return(Et=this.div)==null?void 0:Et.setAttribute("aria-label",Zt)});const[It,Ft,Bt,Ut]=Y(this,V,$n).call(this);if(this.setAt(It,Ft,0,0),this.setDims(Bt,Ut),Y(this,pt,De).call(this),this.width){const[Zt,Et]=this.parentDimensions;this.setAspectRatio(this.width*Zt,this.height*Et),this.setAt(Z*Zt,xt*Et,this.width*Zt,this.height*Et),ot(this,C,!0),Y(this,Nt,ge).call(this),this.setDims(this.width*Zt,this.height*Et),Y(this,U,le).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return Y(this,dt,Le).call(this),this.div}setDimensions(Z,xt){const It=Math.round(Z),Ft=Math.round(xt);if(t(this,A)===It&&t(this,c)===Ft)return;ot(this,A,It),ot(this,c,Ft),this.canvas.style.visibility="hidden";const[Bt,Ut]=this.parentDimensions;this.width=Z/Bt,this.height=xt/Ut,this.fixAndSetPosition(),t(this,p)&&Y(this,Ot,mn).call(this,Z,xt),Y(this,Nt,ge).call(this),Y(this,U,le).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(Z,xt,It){var q,J,ht;if(Z instanceof z.InkAnnotationElement)return null;const Ft=super.deserialize(Z,xt,It);Ft.thickness=Z.thickness,Ft.color=i.Util.makeHexColor(...Z.color),Ft.opacity=Z.opacity;const[Bt,Ut]=Ft.pageDimensions,Zt=Ft.width*Bt,Et=Ft.height*Ut,Jt=Ft.parentScale,jt=Z.thickness/2;ot(Ft,p,!0),ot(Ft,A,Math.round(Zt)),ot(Ft,c,Math.round(Et));const{paths:j,rect:e,rotation:_}=Z;for(let{bezier:_t}of j){_t=Y(q=vt,Vt,Jn).call(q,_t,e,_);const Rt=[];Ft.paths.push(Rt);let Mt=Jt*(_t[0]-jt),qt=Jt*(_t[1]-jt);for(let Lt=2,Wt=_t.length;Lt<Wt;Lt+=6){const Kt=Jt*(_t[Lt]-jt),Qt=Jt*(_t[Lt+1]-jt),te=Jt*(_t[Lt+2]-jt),re=Jt*(_t[Lt+3]-jt),ie=Jt*(_t[Lt+4]-jt),ae=Jt*(_t[Lt+5]-jt);Rt.push([[Mt,qt],[Kt,Qt],[te,re],[ie,ae]]),Mt=ie,qt=ae}const Dt=Y(this,gt,Kn).call(this,Rt);Ft.bezierPath2D.push(Dt)}const B=Y(J=Ft,Gt,yn).call(J);return ot(Ft,m,Math.max(f.AnnotationEditor.MIN_SIZE,B[2]-B[0])),ot(Ft,R,Math.max(f.AnnotationEditor.MIN_SIZE,B[3]-B[1])),Y(ht=Ft,Ot,mn).call(ht,Zt,Et),Ft}serialize(){if(this.isEmpty())return null;const Z=this.getRect(0,0),xt=f.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:i.AnnotationEditorType.INK,color:xt,thickness:this.thickness,opacity:this.opacity,paths:Y(this,Yt,Qn).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,Z),pageIndex:this.pageIndex,rect:Z,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};R=new WeakMap,m=new WeakMap,I=new WeakMap,N=new WeakMap,P=new WeakMap,E=new WeakMap,v=new WeakMap,p=new WeakMap,y=new WeakMap,C=new WeakMap,x=new WeakMap,A=new WeakMap,c=new WeakMap,d=new WeakMap,M=new WeakSet,Un=function(Z){const xt=this.thickness;this.addCommands({cmd:()=>{this.thickness=Z,Y(this,K,me).call(this)},undo:()=>{this.thickness=xt,Y(this,K,me).call(this)},mustExec:!0,type:i.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},l=new WeakSet,Wn=function(Z){const xt=this.color;this.addCommands({cmd:()=>{this.color=Z,Y(this,U,le).call(this)},undo:()=>{this.color=xt,Y(this,U,le).call(this)},mustExec:!0,type:i.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},g=new WeakSet,Hn=function(Z){Z/=100;const xt=this.opacity;this.addCommands({cmd:()=>{this.opacity=Z,Y(this,U,le).call(this)},undo:()=>{this.opacity=xt,Y(this,U,le).call(this)},mustExec:!0,type:i.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},V=new WeakSet,$n=function(){const{parentRotation:Z,parentDimensions:[xt,It]}=this;switch(Z){case 90:return[0,It,It,xt];case 180:return[xt,It,xt,It];case 270:return[xt,0,It,xt];default:return[0,0,xt,It]}},X=new WeakSet,fn=function(){const{ctx:Z,color:xt,opacity:It,thickness:Ft,parentScale:Bt,scaleFactor:Ut}=this;Z.lineWidth=Ft*Bt/Ut,Z.lineCap="round",Z.lineJoin="round",Z.miterLimit=10,Z.strokeStyle="".concat(xt).concat((0,ct.opacityToHex)(It))},at=new WeakSet,Gn=function(Z,xt){var It;this.canvas.addEventListener("contextmenu",H.noContextMenu),this.canvas.addEventListener("pointerleave",t(this,N)),this.canvas.addEventListener("pointermove",t(this,I)),this.canvas.addEventListener("pointerup",t(this,P)),this.canvas.removeEventListener("pointerdown",t(this,E)),this.isEditing=!0,t(this,C)||(ot(this,C,!0),Y(this,Nt,ge).call(this),this.thickness||(this.thickness=vt._defaultThickness),this.color||(this.color=vt._defaultColor||f.AnnotationEditor._defaultLineColor),(It=this.opacity)!=null||(this.opacity=vt._defaultOpacity)),this.currentPath.push([Z,xt]),ot(this,y,!1),Y(this,X,fn).call(this),ot(this,d,()=>{Y(this,o,Xn).call(this),t(this,d)&&window.requestAnimationFrame(t(this,d))}),window.requestAnimationFrame(t(this,d))},ut=new WeakSet,pn=function(Z,xt){const[It,Ft]=this.currentPath.at(-1);if(this.currentPath.length>1&&Z===It&&xt===Ft)return;const Bt=this.currentPath;let Ut=t(this,v);if(Bt.push([Z,xt]),ot(this,y,!0),Bt.length<=2){Ut.moveTo(...Bt[0]),Ut.lineTo(Z,xt);return}Bt.length===3&&(ot(this,v,Ut=new Path2D),Ut.moveTo(...Bt[0])),Y(this,h,qn).call(this,Ut,...Bt.at(-3),...Bt.at(-2),Z,xt)},Tt=new WeakSet,Vn=function(){if(this.currentPath.length===0)return;const Z=this.currentPath.at(-1);t(this,v).lineTo(...Z)},k=new WeakSet,zn=function(Z,xt){ot(this,d,null),Z=Math.min(Math.max(Z,0),this.canvas.width),xt=Math.min(Math.max(xt,0),this.canvas.height),Y(this,ut,pn).call(this,Z,xt),Y(this,Tt,Vn).call(this);let It;if(this.currentPath.length!==1)It=Y(this,T,Yn).call(this);else{const Et=[Z,xt];It=[[Et,Et.slice(),Et.slice(),Et]]}const Ft=t(this,v),Bt=this.currentPath;this.currentPath=[],ot(this,v,new Path2D);const Ut=()=>{this.allRawPaths.push(Bt),this.paths.push(It),this.bezierPath2D.push(Ft),this.rebuild()},Zt=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(Y(this,pt,De).call(this),Y(this,dt,Le).call(this)),Y(this,K,me).call(this))};this.addCommands({cmd:Ut,undo:Zt,mustExec:!0})},o=new WeakSet,Xn=function(){if(!t(this,y))return;ot(this,y,!1);const Z=Math.ceil(this.thickness*this.parentScale),xt=this.currentPath.slice(-3),It=xt.map(Ut=>Ut[0]),Ft=xt.map(Ut=>Ut[1]);Math.min(...It)-Z,Math.max(...It)+Z,Math.min(...Ft)-Z,Math.max(...Ft)+Z;const{ctx:Bt}=this;Bt.save(),Bt.clearRect(0,0,this.canvas.width,this.canvas.height);for(const Ut of this.bezierPath2D)Bt.stroke(Ut);Bt.stroke(t(this,v)),Bt.restore()},h=new WeakSet,qn=function(Z,xt,It,Ft,Bt,Ut,Zt){const Et=(xt+Ft)/2,Jt=(It+Bt)/2,jt=(Ft+Ut)/2,j=(Bt+Zt)/2;Z.bezierCurveTo(Et+2*(Ft-Et)/3,Jt+2*(Bt-Jt)/3,jt+2*(Ft-jt)/3,j+2*(Bt-j)/3,jt,j)},T=new WeakSet,Yn=function(){const Z=this.currentPath;if(Z.length<=2)return[[Z[0],Z[0],Z.at(-1),Z.at(-1)]];const xt=[];let It,[Ft,Bt]=Z[0];for(It=1;It<Z.length-2;It++){const[e,_]=Z[It],[B,q]=Z[It+1],J=(e+B)/2,ht=(_+q)/2,_t=[Ft+2*(e-Ft)/3,Bt+2*(_-Bt)/3],Rt=[J+2*(e-J)/3,ht+2*(_-ht)/3];xt.push([[Ft,Bt],_t,Rt,[J,ht]]),[Ft,Bt]=[J,ht]}const[Ut,Zt]=Z[It],[Et,Jt]=Z[It+1],jt=[Ft+2*(Ut-Ft)/3,Bt+2*(Zt-Bt)/3],j=[Et+2*(Ut-Et)/3,Jt+2*(Zt-Jt)/3];return xt.push([[Ft,Bt],jt,j,[Et,Jt]]),xt},U=new WeakSet,le=function(){if(this.isEmpty()){Y(this,it,Oe).call(this);return}Y(this,X,fn).call(this);const{canvas:Z,ctx:xt}=this;xt.setTransform(1,0,0,1,0,0),xt.clearRect(0,0,Z.width,Z.height),Y(this,it,Oe).call(this);for(const It of this.bezierPath2D)xt.stroke(It)},nt=new WeakSet,gn=function(Z){this.canvas.removeEventListener("pointerleave",t(this,N)),this.canvas.removeEventListener("pointermove",t(this,I)),this.canvas.removeEventListener("pointerup",t(this,P)),this.canvas.addEventListener("pointerdown",t(this,E)),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",H.noContextMenu)},10),Y(this,k,zn).call(this,Z.offsetX,Z.offsetY),this.addToAnnotationStorage(),this.setInBackground()},pt=new WeakSet,De=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",f.AnnotationEditor._l10nPromise.get("editor_ink_canvas_aria_label").then(Z=>{var xt;return(xt=this.canvas)==null?void 0:xt.setAttribute("aria-label",Z)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},dt=new WeakSet,Le=function(){ot(this,x,new ResizeObserver(Z=>{const xt=Z[0].contentRect;xt.width&&xt.height&&this.setDimensions(xt.width,xt.height)})),t(this,x).observe(this.div)},Nt=new WeakSet,ge=function(){if(!t(this,C))return;const[Z,xt]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*Z),this.canvas.height=Math.ceil(this.height*xt),Y(this,it,Oe).call(this)},Ot=new WeakSet,mn=function(Z,xt){const It=Y(this,ft,Ie).call(this),Ft=(Z-It)/t(this,m),Bt=(xt-It)/t(this,R);this.scaleFactor=Math.min(Ft,Bt)},it=new WeakSet,Oe=function(){const Z=Y(this,ft,Ie).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+Z,this.translationY*this.scaleFactor+Z)},gt=new WeakSet,Kn=function(Z){const xt=new Path2D;for(let It=0,Ft=Z.length;It<Ft;It++){const[Bt,Ut,Zt,Et]=Z[It];It===0&&xt.moveTo(...Bt),xt.bezierCurveTo(Ut[0],Ut[1],Zt[0],Zt[1],Et[0],Et[1])}return xt},Ct=new WeakSet,bn=function(Z,xt,It){const[Ft,Bt,Ut,Zt]=xt;switch(It){case 0:for(let Et=0,Jt=Z.length;Et<Jt;Et+=2)Z[Et]+=Ft,Z[Et+1]=Zt-Z[Et+1];break;case 90:for(let Et=0,Jt=Z.length;Et<Jt;Et+=2){const jt=Z[Et];Z[Et]=Z[Et+1]+Ft,Z[Et+1]=jt+Bt}break;case 180:for(let Et=0,Jt=Z.length;Et<Jt;Et+=2)Z[Et]=Ut-Z[Et],Z[Et+1]+=Bt;break;case 270:for(let Et=0,Jt=Z.length;Et<Jt;Et+=2){const jt=Z[Et];Z[Et]=Ut-Z[Et+1],Z[Et+1]=Zt-jt}break;default:throw new Error("Invalid rotation")}return Z},Vt=new WeakSet,Jn=function(Z,xt,It){const[Ft,Bt,Ut,Zt]=xt;switch(It){case 0:for(let Et=0,Jt=Z.length;Et<Jt;Et+=2)Z[Et]-=Ft,Z[Et+1]=Zt-Z[Et+1];break;case 90:for(let Et=0,Jt=Z.length;Et<Jt;Et+=2){const jt=Z[Et];Z[Et]=Z[Et+1]-Bt,Z[Et+1]=jt-Ft}break;case 180:for(let Et=0,Jt=Z.length;Et<Jt;Et+=2)Z[Et]=Ut-Z[Et],Z[Et+1]-=Bt;break;case 270:for(let Et=0,Jt=Z.length;Et<Jt;Et+=2){const jt=Z[Et];Z[Et]=Zt-Z[Et+1],Z[Et+1]=Ut-jt}break;default:throw new Error("Invalid rotation")}return Z},Yt=new WeakSet,Qn=function(Z,xt,It,Ft){var Jt,jt;const Bt=[],Ut=this.thickness/2,Zt=Z*xt+Ut,Et=Z*It+Ut;for(const j of this.paths){const e=[],_=[];for(let B=0,q=j.length;B<q;B++){const[J,ht,_t,Rt]=j[B],Mt=Z*J[0]+Zt,qt=Z*J[1]+Et,Dt=Z*ht[0]+Zt,Lt=Z*ht[1]+Et,Wt=Z*_t[0]+Zt,Kt=Z*_t[1]+Et,Qt=Z*Rt[0]+Zt,te=Z*Rt[1]+Et;B===0&&(e.push(Mt,qt),_.push(Mt,qt)),e.push(Dt,Lt,Wt,Kt,Qt,te),_.push(Dt,Lt),B===q-1&&_.push(Qt,te)}Bt.push({bezier:Y(Jt=vt,Ct,bn).call(Jt,e,Ft,this.rotation),points:Y(jt=vt,Ct,bn).call(jt,_,Ft,this.rotation)})}return Bt},Gt=new WeakSet,yn=function(){let Z=1/0,xt=-1/0,It=1/0,Ft=-1/0;for(const Bt of this.paths)for(const[Ut,Zt,Et,Jt]of Bt){const jt=i.Util.bezierBoundingBox(...Ut,...Zt,...Et,...Jt);Z=Math.min(Z,jt[0]),It=Math.min(It,jt[1]),xt=Math.max(xt,jt[2]),Ft=Math.max(Ft,jt[3])}return[Z,It,xt,Ft]},ft=new WeakSet,Ie=function(){return t(this,p)?Math.ceil(this.thickness*this.parentScale):0},K=new WeakSet,me=function(Z=!1){if(this.isEmpty())return;if(!t(this,p)){Y(this,U,le).call(this);return}const xt=Y(this,Gt,yn).call(this),It=Y(this,ft,Ie).call(this);ot(this,m,Math.max(f.AnnotationEditor.MIN_SIZE,xt[2]-xt[0])),ot(this,R,Math.max(f.AnnotationEditor.MIN_SIZE,xt[3]-xt[1]));const Ft=Math.ceil(It+t(this,m)*this.scaleFactor),Bt=Math.ceil(It+t(this,R)*this.scaleFactor),[Ut,Zt]=this.parentDimensions;this.width=Ft/Ut,this.height=Bt/Zt,this.setAspectRatio(Ft,Bt);const Et=this.translationX,Jt=this.translationY;this.translationX=-xt[0],this.translationY=-xt[1],Y(this,Nt,ge).call(this),Y(this,U,le).call(this),ot(this,A,Ft),ot(this,c,Bt),this.setDims(Ft,Bt);const jt=Z?It/this.scaleFactor/2:0;this.translate(Et-this.translationX-jt,Jt-this.translationY-jt)},W(vt,gt),W(vt,Ct),W(vt,Vt),se(vt,"_defaultColor",null),se(vt,"_defaultOpacity",1),se(vt,"_defaultThickness",1),se(vt,"_type","ink");let F=vt;n.InkEditor=F},(D,n,L)=>{var F,R,m,I,N,P,E,v,p,y,C,Se,A,Te,d,Ne,b,_n,w,Zn,$,ts,S,An,tt,je,G,es;Object.defineProperty(n,"__esModule",{value:!0}),n.StampEditor=void 0;var i=L(1),f=L(4),z=L(6),H=L(29);const yt=class yt extends f.AnnotationEditor{constructor(k){super({...k,name:"stampEditor"});W(this,C);W(this,A);W(this,d);W(this,b);W(this,w);W(this,$);W(this,S);W(this,tt);W(this,G);W(this,F,null);W(this,R,null);W(this,m,null);W(this,I,null);W(this,N,null);W(this,P,null);W(this,E,null);W(this,v,null);W(this,p,!1);W(this,y,!1);ot(this,I,k.bitmapUrl),ot(this,N,k.bitmapFile)}static initialize(k){f.AnnotationEditor.initialize(k)}static get supportedTypes(){const k=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,i.shadow)(this,"supportedTypes",k.map(s=>"image/".concat(s)))}static get supportedTypesStr(){return(0,i.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(k){return this.supportedTypes.includes(k)}static paste(k,s){s.pasteEditor(i.AnnotationEditorType.STAMP,{bitmapFile:k.getAsFile()})}remove(){var k,s;t(this,R)&&(ot(this,F,null),this._uiManager.imageManager.deleteId(t(this,R)),(k=t(this,P))==null||k.remove(),ot(this,P,null),(s=t(this,E))==null||s.disconnect(),ot(this,E,null)),super.remove()}rebuild(){if(!this.parent){t(this,R)&&Y(this,d,Ne).call(this);return}super.rebuild(),this.div!==null&&(t(this,R)&&Y(this,d,Ne).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(t(this,m)||t(this,F)||t(this,I)||t(this,N))}get isResizable(){return!0}render(){if(this.div)return this.div;let k,s;if(this.width&&(k=this.x,s=this.y),super.render(),this.div.hidden=!0,t(this,F)?Y(this,b,_n).call(this):Y(this,d,Ne).call(this),this.width){const[o,a]=this.parentDimensions;this.setAt(k*o,s*a,this.width*o,this.height*a)}return this.div}static deserialize(k,s,o){if(k instanceof H.StampAnnotationElement)return null;const a=super.deserialize(k,s,o),{rect:h,bitmapUrl:u,bitmapId:T,isSvg:O,accessibilityData:U}=k;T&&o.imageManager.isValidId(T)?ot(a,R,T):ot(a,I,u),ot(a,p,O);const[rt,nt]=a.pageDimensions;return a.width=(h[2]-h[0])/rt,a.height=(h[3]-h[1])/nt,U&&(a.altTextData=U),a}serialize(k=!1,s=null){if(this.isEmpty())return null;const o={annotationType:i.AnnotationEditorType.STAMP,bitmapId:t(this,R),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:t(this,p),structTreeParentId:this._structTreeParentId};if(k)return o.bitmapUrl=Y(this,tt,je).call(this,!0),o.accessibilityData=this.altTextData,o;const{decorative:a,altText:h}=this.altTextData;if(!a&&h&&(o.accessibilityData={type:"Figure",alt:h}),s===null)return o;s.stamps||(s.stamps=new Map);const u=t(this,p)?(o.rect[2]-o.rect[0])*(o.rect[3]-o.rect[1]):null;if(!s.stamps.has(t(this,R)))s.stamps.set(t(this,R),{area:u,serialized:o}),o.bitmap=Y(this,tt,je).call(this,!1);else if(t(this,p)){const T=s.stamps.get(t(this,R));u>T.area&&(T.area=u,T.serialized.bitmap.close(),T.serialized.bitmap=Y(this,tt,je).call(this,!1))}return o}};F=new WeakMap,R=new WeakMap,m=new WeakMap,I=new WeakMap,N=new WeakMap,P=new WeakMap,E=new WeakMap,v=new WeakMap,p=new WeakMap,y=new WeakMap,C=new WeakSet,Se=function(k,s=!1){if(!k){this.remove();return}ot(this,F,k.bitmap),s||(ot(this,R,k.id),ot(this,p,k.isSvg)),Y(this,b,_n).call(this)},A=new WeakSet,Te=function(){ot(this,m,null),this._uiManager.enableWaiting(!1),t(this,P)&&this.div.focus()},d=new WeakSet,Ne=function(){if(t(this,R)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(t(this,R)).then(s=>Y(this,C,Se).call(this,s,!0)).finally(()=>Y(this,A,Te).call(this));return}if(t(this,I)){const s=t(this,I);ot(this,I,null),this._uiManager.enableWaiting(!0),ot(this,m,this._uiManager.imageManager.getFromUrl(s).then(o=>Y(this,C,Se).call(this,o)).finally(()=>Y(this,A,Te).call(this)));return}if(t(this,N)){const s=t(this,N);ot(this,N,null),this._uiManager.enableWaiting(!0),ot(this,m,this._uiManager.imageManager.getFromFile(s).then(o=>Y(this,C,Se).call(this,o)).finally(()=>Y(this,A,Te).call(this)));return}const k=document.createElement("input");k.type="file",k.accept=yt.supportedTypesStr,ot(this,m,new Promise(s=>{k.addEventListener("change",async()=>{if(!k.files||k.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const o=await this._uiManager.imageManager.getFromFile(k.files[0]);Y(this,C,Se).call(this,o)}s()}),k.addEventListener("cancel",()=>{this.remove(),s()})}).finally(()=>Y(this,A,Te).call(this))),k.click()},b=new WeakSet,_n=function(){const{div:k}=this;let{width:s,height:o}=t(this,F);const[a,h]=this.pageDimensions,u=.75;if(this.width)s=this.width*a,o=this.height*h;else if(s>u*a||o>u*h){const rt=Math.min(u*a/s,u*h/o);s*=rt,o*=rt}const[T,O]=this.parentDimensions;this.setDims(s*T/a,o*O/h),this._uiManager.enableWaiting(!1);const U=ot(this,P,document.createElement("canvas"));k.append(U),k.hidden=!1,Y(this,S,An).call(this,s,o),Y(this,G,es).call(this),t(this,y)||(this.parent.addUndoableEditor(this),ot(this,y,!0)),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"inserted_image"}}}),this.addAltTextButton()},w=new WeakSet,Zn=function(k,s){var u;const[o,a]=this.parentDimensions;this.width=k/o,this.height=s/a,this.setDims(k,s),(u=this._initialOptions)!=null&&u.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,t(this,v)!==null&&clearTimeout(t(this,v)),ot(this,v,setTimeout(()=>{ot(this,v,null),Y(this,S,An).call(this,k,s)},200))},$=new WeakSet,ts=function(k,s){const{width:o,height:a}=t(this,F);let h=o,u=a,T=t(this,F);for(;h>2*k||u>2*s;){const O=h,U=u;h>2*k&&(h=h>=16384?Math.floor(h/2)-1:Math.ceil(h/2)),u>2*s&&(u=u>=16384?Math.floor(u/2)-1:Math.ceil(u/2));const rt=new OffscreenCanvas(h,u);rt.getContext("2d").drawImage(T,0,0,O,U,0,0,h,u),T=rt.transferToImageBitmap()}return T},S=new WeakSet,An=function(k,s){k=Math.ceil(k),s=Math.ceil(s);const o=t(this,P);if(!o||o.width===k&&o.height===s)return;o.width=k,o.height=s;const a=t(this,p)?t(this,F):Y(this,$,ts).call(this,k,s),h=o.getContext("2d");h.filter=this._uiManager.hcmFilter,h.drawImage(a,0,0,a.width,a.height,0,0,k,s)},tt=new WeakSet,je=function(k){if(k){if(t(this,p)){const a=this._uiManager.imageManager.getSvgUrl(t(this,R));if(a)return a}const s=document.createElement("canvas");return{width:s.width,height:s.height}=t(this,F),s.getContext("2d").drawImage(t(this,F),0,0),s.toDataURL()}if(t(this,p)){const[s,o]=this.pageDimensions,a=Math.round(this.width*s*z.PixelsPerInch.PDF_TO_CSS_UNITS),h=Math.round(this.height*o*z.PixelsPerInch.PDF_TO_CSS_UNITS),u=new OffscreenCanvas(a,h);return u.getContext("2d").drawImage(t(this,F),0,0,t(this,F).width,t(this,F).height,0,0,a,h),u.transferToImageBitmap()}return structuredClone(t(this,F))},G=new WeakSet,es=function(){ot(this,E,new ResizeObserver(k=>{const s=k[0].contentRect;s.width&&s.height&&Y(this,w,Zn).call(this,s.width,s.height)})),t(this,E).observe(this.div)},se(yt,"_type","stamp");let ct=yt;n.StampEditor=ct}],__webpack_module_cache__={};function __w_pdfjs_require__(D){var n=__webpack_module_cache__[D];if(n!==void 0)return n.exports;var L=__webpack_module_cache__[D]={exports:{}};return __webpack_modules__[D](L,L.exports,__w_pdfjs_require__),L.exports}var __webpack_exports__={};return(()=>{var D=__webpack_exports__;Object.defineProperty(D,"__esModule",{value:!0}),Object.defineProperty(D,"AbortException",{enumerable:!0,get:function(){return n.AbortException}}),Object.defineProperty(D,"AnnotationEditorLayer",{enumerable:!0,get:function(){return z.AnnotationEditorLayer}}),Object.defineProperty(D,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return n.AnnotationEditorParamsType}}),Object.defineProperty(D,"AnnotationEditorType",{enumerable:!0,get:function(){return n.AnnotationEditorType}}),Object.defineProperty(D,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return H.AnnotationEditorUIManager}}),Object.defineProperty(D,"AnnotationLayer",{enumerable:!0,get:function(){return ct.AnnotationLayer}}),Object.defineProperty(D,"AnnotationMode",{enumerable:!0,get:function(){return n.AnnotationMode}}),Object.defineProperty(D,"CMapCompressionType",{enumerable:!0,get:function(){return n.CMapCompressionType}}),Object.defineProperty(D,"DOMSVGFactory",{enumerable:!0,get:function(){return i.DOMSVGFactory}}),Object.defineProperty(D,"FeatureTest",{enumerable:!0,get:function(){return n.FeatureTest}}),Object.defineProperty(D,"GlobalWorkerOptions",{enumerable:!0,get:function(){return F.GlobalWorkerOptions}}),Object.defineProperty(D,"ImageKind",{enumerable:!0,get:function(){return n.ImageKind}}),Object.defineProperty(D,"InvalidPDFException",{enumerable:!0,get:function(){return n.InvalidPDFException}}),Object.defineProperty(D,"MissingPDFException",{enumerable:!0,get:function(){return n.MissingPDFException}}),Object.defineProperty(D,"OPS",{enumerable:!0,get:function(){return n.OPS}}),Object.defineProperty(D,"PDFDataRangeTransport",{enumerable:!0,get:function(){return L.PDFDataRangeTransport}}),Object.defineProperty(D,"PDFDateString",{enumerable:!0,get:function(){return i.PDFDateString}}),Object.defineProperty(D,"PDFWorker",{enumerable:!0,get:function(){return L.PDFWorker}}),Object.defineProperty(D,"PasswordResponses",{enumerable:!0,get:function(){return n.PasswordResponses}}),Object.defineProperty(D,"PermissionFlag",{enumerable:!0,get:function(){return n.PermissionFlag}}),Object.defineProperty(D,"PixelsPerInch",{enumerable:!0,get:function(){return i.PixelsPerInch}}),Object.defineProperty(D,"PromiseCapability",{enumerable:!0,get:function(){return n.PromiseCapability}}),Object.defineProperty(D,"RenderingCancelledException",{enumerable:!0,get:function(){return i.RenderingCancelledException}}),Object.defineProperty(D,"SVGGraphics",{enumerable:!0,get:function(){return L.SVGGraphics}}),Object.defineProperty(D,"UnexpectedResponseException",{enumerable:!0,get:function(){return n.UnexpectedResponseException}}),Object.defineProperty(D,"Util",{enumerable:!0,get:function(){return n.Util}}),Object.defineProperty(D,"VerbosityLevel",{enumerable:!0,get:function(){return n.VerbosityLevel}}),Object.defineProperty(D,"XfaLayer",{enumerable:!0,get:function(){return R.XfaLayer}}),Object.defineProperty(D,"build",{enumerable:!0,get:function(){return L.build}}),Object.defineProperty(D,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return n.createValidAbsoluteUrl}}),Object.defineProperty(D,"getDocument",{enumerable:!0,get:function(){return L.getDocument}}),Object.defineProperty(D,"getFilenameFromUrl",{enumerable:!0,get:function(){return i.getFilenameFromUrl}}),Object.defineProperty(D,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return i.getPdfFilenameFromUrl}}),Object.defineProperty(D,"getXfaPageViewport",{enumerable:!0,get:function(){return i.getXfaPageViewport}}),Object.defineProperty(D,"isDataScheme",{enumerable:!0,get:function(){return i.isDataScheme}}),Object.defineProperty(D,"isPdfFile",{enumerable:!0,get:function(){return i.isPdfFile}}),Object.defineProperty(D,"loadScript",{enumerable:!0,get:function(){return i.loadScript}}),Object.defineProperty(D,"noContextMenu",{enumerable:!0,get:function(){return i.noContextMenu}}),Object.defineProperty(D,"normalizeUnicode",{enumerable:!0,get:function(){return n.normalizeUnicode}}),Object.defineProperty(D,"renderTextLayer",{enumerable:!0,get:function(){return f.renderTextLayer}}),Object.defineProperty(D,"setLayerDimensions",{enumerable:!0,get:function(){return i.setLayerDimensions}}),Object.defineProperty(D,"shadow",{enumerable:!0,get:function(){return n.shadow}}),Object.defineProperty(D,"updateTextLayer",{enumerable:!0,get:function(){return f.updateTextLayer}}),Object.defineProperty(D,"version",{enumerable:!0,get:function(){return L.version}});var n=__w_pdfjs_require__(1),L=__w_pdfjs_require__(2),i=__w_pdfjs_require__(6),f=__w_pdfjs_require__(26),z=__w_pdfjs_require__(27),H=__w_pdfjs_require__(5),ct=__w_pdfjs_require__(29),F=__w_pdfjs_require__(14),R=__w_pdfjs_require__(32)})(),__webpack_exports__})())})(pdf$1);var pdfExports=pdf$1.exports;const pdf=getDefaultExportFromCjs(pdfExports),pdfjsModule=_mergeNamespaces({__proto__:null,default:pdf},[pdfExports]),pdfjs="default"in pdfjsModule?pdf:pdfjsModule,pdfjs$1=pdfjs;var __spreadArray=function(D,n,L){if(L||arguments.length===2)for(var i=0,f=n.length,z;i<f;i++)(z||!(i in n))&&(z||(z=Array.prototype.slice.call(n,0,i)),z[i]=n[i]);return D.concat(z||Array.prototype.slice.call(n))},clipboardEvents=["onCopy","onCut","onPaste"],compositionEvents=["onCompositionEnd","onCompositionStart","onCompositionUpdate"],focusEvents=["onFocus","onBlur"],formEvents=["onInput","onInvalid","onReset","onSubmit"],imageEvents=["onLoad","onError"],keyboardEvents=["onKeyDown","onKeyPress","onKeyUp"],mediaEvents=["onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onError","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting"],mouseEvents=["onClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp"],dragEvents=["onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop"],selectionEvents=["onSelect"],touchEvents=["onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"],pointerEvents=["onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onGotPointerCapture","onLostPointerCapture","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut"],uiEvents=["onScroll"],wheelEvents=["onWheel"],animationEvents=["onAnimationStart","onAnimationEnd","onAnimationIteration"],transitionEvents=["onTransitionEnd"],otherEvents=["onToggle"],changeEvents=["onChange"],allEvents=__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray([],clipboardEvents,!0),compositionEvents,!0),focusEvents,!0),formEvents,!0),imageEvents,!0),keyboardEvents,!0),mediaEvents,!0),mouseEvents,!0),dragEvents,!0),selectionEvents,!0),touchEvents,!0),pointerEvents,!0),uiEvents,!0),wheelEvents,!0),animationEvents,!0),transitionEvents,!0),changeEvents,!0),otherEvents,!0);function makeEventProps(D,n){var L={};return allEvents.forEach(function(i){var f=D[i];f&&(n?L[i]=function(z){return f(z,n(i))}:L[i]=f)}),L}function makeCancellablePromise(D){var n=!1,L=new Promise(function(i,f){D.then(function(z){return!n&&i(z)}).catch(function(z){return!n&&f(z)})});return{promise:L,cancel:function(){n=!0}}}function r(D){var n,L,i="";if(typeof D=="string"||typeof D=="number")i+=D;else if(typeof D=="object")if(Array.isArray(D)){var f=D.length;for(n=0;n<f;n++)D[n]&&(L=r(D[n]))&&(i&&(i+=" "),i+=L)}else for(L in D)D[L]&&(i&&(i+=" "),i+=L);return i}function clsx(){for(var D,n,L=0,i="",f=arguments.length;L<f;L++)(D=arguments[L])&&(n=r(D))&&(i&&(i+=" "),i+=n);return i}var isProduction=!0,prefix="Invariant failed";function invariant(D,n){if(!D){if(isProduction)throw new Error(prefix);var L=typeof n=="function"?n():n,i=L?"".concat(prefix,": ").concat(L):prefix;throw new Error(i)}}var warning=function(){},warning_1=warning;const warning$1=getDefaultExportFromCjs(warning_1);var has=Object.prototype.hasOwnProperty;function find(D,n,L){for(L of D.keys())if(dequal(L,n))return L}function dequal(D,n){var L,i,f;if(D===n)return!0;if(D&&n&&(L=D.constructor)===n.constructor){if(L===Date)return D.getTime()===n.getTime();if(L===RegExp)return D.toString()===n.toString();if(L===Array){if((i=D.length)===n.length)for(;i--&&dequal(D[i],n[i]););return i===-1}if(L===Set){if(D.size!==n.size)return!1;for(i of D)if(f=i,f&&typeof f=="object"&&(f=find(n,f),!f)||!n.has(f))return!1;return!0}if(L===Map){if(D.size!==n.size)return!1;for(i of D)if(f=i[0],f&&typeof f=="object"&&(f=find(n,f),!f)||!dequal(i[1],n.get(f)))return!1;return!0}if(L===ArrayBuffer)D=new Uint8Array(D),n=new Uint8Array(n);else if(L===DataView){if((i=D.byteLength)===n.byteLength)for(;i--&&D.getInt8(i)===n.getInt8(i););return i===-1}if(ArrayBuffer.isView(D)){if((i=D.byteLength)===n.byteLength)for(;i--&&D[i]===n[i];);return i===-1}if(!L||typeof D=="object"){i=0;for(L in D)if(has.call(D,L)&&++i&&!has.call(n,L)||!(L in n)||!dequal(D[L],n[L]))return!1;return Object.keys(n).length===i}}return D!==D&&n!==n}const DocumentContext=reactExports.createContext(null);function Message({children:D,type:n}){return React.createElement("div",{className:"react-pdf__message react-pdf__message--".concat(n)},D)}const DEFAULT_LINK_REL="noopener noreferrer nofollow";class LinkService{constructor(){this.externalLinkEnabled=!0,this.externalLinkRel=void 0,this.externalLinkTarget=void 0,this.isInPresentationMode=!1,this.pdfDocument=void 0,this.pdfViewer=void 0}setDocument(n){this.pdfDocument=n}setViewer(n){this.pdfViewer=n}setExternalLinkRel(n){this.externalLinkRel=n}setExternalLinkTarget(n){this.externalLinkTarget=n}setHistory(){}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return invariant(this.pdfViewer,"PDF viewer is not initialized."),this.pdfViewer.currentPageNumber||0}set page(n){invariant(this.pdfViewer,"PDF viewer is not initialized."),this.pdfViewer.currentPageNumber=n}get rotation(){return 0}set rotation(n){}goToDestination(n){return new Promise(L=>{invariant(this.pdfDocument,"PDF document not loaded."),invariant(n,"Destination is not specified."),typeof n=="string"?this.pdfDocument.getDestination(n).then(L):Array.isArray(n)?L(n):n.then(L)}).then(L=>{invariant(Array.isArray(L),'"'.concat(L,'" is not a valid destination array.'));const i=L[0];new Promise(f=>{invariant(this.pdfDocument,"PDF document not loaded."),i instanceof Object?this.pdfDocument.getPageIndex(i).then(z=>{f(z)}).catch(()=>{invariant(!1,'"'.concat(i,'" is not a valid page reference.'))}):typeof i=="number"?f(i):invariant(!1,'"'.concat(i,'" is not a valid destination reference.'))}).then(f=>{const z=f+1;invariant(this.pdfViewer,"PDF viewer is not initialized."),invariant(z>=1&&z<=this.pagesCount,'"'.concat(z,'" is not a valid page number.')),this.pdfViewer.scrollPageIntoView({dest:L,pageIndex:f,pageNumber:z})})})}navigateTo(n){this.goToDestination(n)}goToPage(n){const L=n-1;invariant(this.pdfViewer,"PDF viewer is not initialized."),invariant(n>=1&&n<=this.pagesCount,'"'.concat(n,'" is not a valid page number.')),this.pdfViewer.scrollPageIntoView({pageIndex:L,pageNumber:n})}addLinkAttributes(n,L,i){n.href=L,n.rel=this.externalLinkRel||DEFAULT_LINK_REL,n.target=i?"_blank":this.externalLinkTarget||""}getDestinationHash(){return"#"}getAnchorUrl(){return"#"}setHash(){}executeNamedAction(){}cachePageRef(){}isPageVisible(){return!0}isPageCached(){return!0}executeSetOCGState(){}}const PasswordResponses={NEED_PASSWORD:1,INCORRECT_PASSWORD:2},PasswordResponses$1=PasswordResponses,isBrowser=typeof document<"u",isLocalFileSystem=isBrowser&&window.location.protocol==="file:";function isDefined(D){return typeof D<"u"}function isProvided(D){return isDefined(D)&&D!==null}function isString(D){return typeof D=="string"}function isArrayBuffer(D){return D instanceof ArrayBuffer}function isBlob(D){return invariant(isBrowser,"isBlob can only be used in a browser environment"),D instanceof Blob}function isDataURI(D){return isString(D)&&/^data:/.test(D)}function dataURItoByteString(D){invariant(isDataURI(D),"Invalid data URI.");const[n="",L=""]=D.split(",");return n.split(";").indexOf("base64")!==-1?atob(L):unescape(L)}function getDevicePixelRatio(){return isBrowser&&window.devicePixelRatio||1}const allowFileAccessFromFilesTip="On Chromium based browsers, you can use --allow-file-access-from-files flag for debugging purposes.";function displayCORSWarning(){warning$1(!isLocalFileSystem,"Loading PDF as base64 strings/URLs may not work on protocols other than HTTP/HTTPS. ".concat(allowFileAccessFromFilesTip))}function displayWorkerWarning(){warning$1(!isLocalFileSystem,"Loading PDF.js worker may not work on protocols other than HTTP/HTTPS. ".concat(allowFileAccessFromFilesTip))}function cancelRunningTask(D){D&&D.cancel&&D.cancel()}function makePageCallback(D,n){return Object.defineProperty(D,"width",{get(){return this.view[2]*n},configurable:!0}),Object.defineProperty(D,"height",{get(){return this.view[3]*n},configurable:!0}),Object.defineProperty(D,"originalWidth",{get(){return this.view[2]},configurable:!0}),Object.defineProperty(D,"originalHeight",{get(){return this.view[3]},configurable:!0}),D}function isCancelException(D){return D.name==="RenderingCancelledException"}function loadFromFile(D){return new Promise((n,L)=>{const i=new FileReader;i.onload=()=>{if(!i.result)return L(new Error("Error while reading a file."));n(i.result)},i.onerror=f=>{if(!f.target)return L(new Error("Error while reading a file."));const{error:z}=f.target;if(!z)return L(new Error("Error while reading a file."));switch(z.code){case z.NOT_FOUND_ERR:return L(new Error("Error while reading a file: File not found."));case z.SECURITY_ERR:return L(new Error("Error while reading a file: Security error."));case z.ABORT_ERR:return L(new Error("Error while reading a file: Aborted."));default:return L(new Error("Error while reading a file."))}},i.readAsArrayBuffer(D)})}function reducer(D,n){switch(n.type){case"RESOLVE":return{value:n.value,error:void 0};case"REJECT":return{value:!1,error:n.error};case"RESET":return{value:void 0,error:void 0};default:return D}}function useResolver(){return reactExports.useReducer(reducer,{value:void 0,error:void 0})}const{PDFDataRangeTransport:PDFDataRangeTransport$1}=pdfjs$1,eventProps=(()=>{const D={};return allEvents.forEach(n=>{D[n]=PropTypes.func}),D})(),isTypedArray=PropTypes.oneOfType([PropTypes.instanceOf(Int8Array),PropTypes.instanceOf(Uint8Array),PropTypes.instanceOf(Uint8ClampedArray),PropTypes.instanceOf(Int16Array),PropTypes.instanceOf(Uint16Array),PropTypes.instanceOf(Int32Array),PropTypes.instanceOf(Uint32Array),PropTypes.instanceOf(Float32Array),PropTypes.instanceOf(Float64Array)]),fileTypes=[PropTypes.string,PropTypes.instanceOf(ArrayBuffer),PropTypes.shape({data:PropTypes.oneOfType([PropTypes.string,PropTypes.instanceOf(ArrayBuffer),PropTypes.arrayOf(PropTypes.number.isRequired),isTypedArray]).isRequired}),PropTypes.shape({range:PropTypes.instanceOf(PDFDataRangeTransport$1).isRequired}),PropTypes.shape({url:PropTypes.string.isRequired})];typeof Blob<"u"&&fileTypes.push(PropTypes.instanceOf(Blob));const isClassName=PropTypes.oneOfType([PropTypes.string,PropTypes.arrayOf(PropTypes.string)]),isFile=PropTypes.oneOfType(fileTypes);PropTypes.instanceOf(LinkService);PropTypes.oneOf(["_self","_blank","_parent","_top"]);PropTypes.shape({commonObjs:PropTypes.shape({}).isRequired,getAnnotations:PropTypes.func.isRequired,getTextContent:PropTypes.func.isRequired,getViewport:PropTypes.func.isRequired,render:PropTypes.func.isRequired});const isPageIndex=function D(n,L,i){const{[L]:f,pageNumber:z,pdf:H}=n;if(!isDefined(H))return null;if(isDefined(f)){if(typeof f!="number")return new Error("`".concat(L,"` of type `").concat(typeof f,"` supplied to `").concat(i,"`, expected `number`."));if(f<0)return new Error("Expected `".concat(L,"` to be greater or equal to 0."));const{numPages:ct}=H;if(f+1>ct)return new Error("Expected `".concat(L,"` to be less or equal to ").concat(ct-1,"."))}else if(!isDefined(z))return new Error("`".concat(L,"` not supplied. Either pageIndex or pageNumber must be supplied to `").concat(i,"`."));return null},isPageNumber=function D(n,L,i){const{[L]:f,pageIndex:z,pdf:H}=n;if(!isDefined(H))return null;if(isDefined(f)){if(typeof f!="number")return new Error("`".concat(L,"` of type `").concat(typeof f,"` supplied to `").concat(i,"`, expected `number`."));if(f<1)return new Error("Expected `".concat(L,"` to be greater or equal to 1."));const{numPages:ct}=H;if(f>ct)return new Error("Expected `".concat(L,"` to be less or equal to ").concat(ct,"."))}else if(!isDefined(z))return new Error("`".concat(L,"` not supplied. Either pageIndex or pageNumber must be supplied to `").concat(i,"`."));return null},isPdf=PropTypes.oneOfType([PropTypes.any,PropTypes.oneOf([!1])]),isRef=PropTypes.oneOfType([PropTypes.func,PropTypes.exact({current:PropTypes.any})]),isRenderMode=PropTypes.oneOf(["canvas","custom","none","svg"]),isRotate=PropTypes.oneOf([0,90,180,270]);var __awaiter=function(D,n,L,i){function f(z){return z instanceof L?z:new L(function(H){H(z)})}return new(L||(L=Promise))(function(z,H){function ct(m){try{R(i.next(m))}catch(I){H(I)}}function F(m){try{R(i.throw(m))}catch(I){H(I)}}function R(m){m.done?z(m.value):f(m.value).then(ct,F)}R((i=i.apply(D,n||[])).next())})},__rest$1=function(D,n){var L={};for(var i in D)Object.prototype.hasOwnProperty.call(D,i)&&n.indexOf(i)<0&&(L[i]=D[i]);if(D!=null&&typeof Object.getOwnPropertySymbols=="function")for(var f=0,i=Object.getOwnPropertySymbols(D);f<i.length;f++)n.indexOf(i[f])<0&&Object.prototype.propertyIsEnumerable.call(D,i[f])&&(L[i[f]]=D[i[f]]);return L};const{PDFDataRangeTransport}=pdfjs$1,defaultOnPassword=(D,n)=>{switch(n){case PasswordResponses$1.NEED_PASSWORD:{const L=prompt("Enter the password to open this PDF file.");D(L);break}case PasswordResponses$1.INCORRECT_PASSWORD:{const L=prompt("Invalid password. Please try again.");D(L);break}}};function isParameterObject(D){return typeof D=="object"&&D!==null&&("data"in D||"range"in D||"url"in D)}const Document=reactExports.forwardRef(function D(n,L){var{children:i,className:f,error:z="Failed to load PDF file.",externalLinkRel:H,externalLinkTarget:ct,file:F,inputRef:R,imageResourcesPath:m,loading:I="Loading PDF…",noData:N="No PDF file specified.",onItemClick:P,onLoadError:E,onLoadProgress:v,onLoadSuccess:p,onPassword:y=defaultOnPassword,onSourceError:C,onSourceSuccess:x,options:A,renderMode:c,rotate:d}=n,M=__rest$1(n,["children","className","error","externalLinkRel","externalLinkTarget","file","inputRef","imageResourcesPath","loading","noData","onItemClick","onLoadError","onLoadProgress","onLoadSuccess","onPassword","onSourceError","onSourceSuccess","options","renderMode","rotate"]);const[b,l]=useResolver(),{value:w,error:g}=b,[$,V]=useResolver(),{value:S,error:X}=$,tt=reactExports.useRef(new LinkService),at=reactExports.useRef([]),G=reactExports.useRef(),ut=reactExports.useRef();reactExports.useEffect(()=>{F&&F!==G.current&&isParameterObject(F)&&(warning$1(!dequal(F,G.current),'File prop passed to <Document /> changed, but it\'s equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "file" prop.'),G.current=F)},[F]),reactExports.useEffect(()=>{A&&A!==ut.current&&(warning$1(!dequal(A,ut.current),'Options prop passed to <Document /> changed, but it\'s equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "options" prop.'),ut.current=A)},[A]);const yt=reactExports.useRef({scrollPageIntoView:mt=>{const{dest:dt,pageNumber:kt,pageIndex:Nt=kt-1}=mt;if(P){P({dest:dt,pageIndex:Nt,pageNumber:kt});return}const St=at.current[Nt];if(St){St.scrollIntoView();return}warning$1(!1,"An internal link leading to page ".concat(kt," was clicked, but neither <Document> was provided with onItemClick nor it was able to find the page within itself. Either provide onItemClick to <Document> and handle navigating by yourself or ensure that all pages are rendered within <Document>."))}});reactExports.useImperativeHandle(L,()=>({linkService:tt,pages:at,viewer:yt}),[]);function Tt(){x&&x()}function wt(){g&&(warning$1(!1,g.toString()),C&&C(g))}function k(){l({type:"RESET"})}reactExports.useEffect(k,[F,l]);const s=reactExports.useCallback(()=>__awaiter(this,void 0,void 0,function*(){if(!F)return null;if(typeof F=="string")return isDataURI(F)?{data:dataURItoByteString(F)}:(displayCORSWarning(),{url:F});if(F instanceof PDFDataRangeTransport)return{range:F};if(isArrayBuffer(F))return{data:F};if(isBrowser&&isBlob(F))return{data:yield loadFromFile(F)};if(invariant(typeof F=="object","Invalid parameter in file, need either Uint8Array, string or a parameter object"),invariant(isParameterObject(F),"Invalid parameter object: need either .data, .range or .url"),"url"in F&&typeof F.url=="string"){if(isDataURI(F.url)){const{url:mt}=F,dt=__rest$1(F,["url"]),kt=dataURItoByteString(mt);return Object.assign({data:kt},dt)}displayCORSWarning()}return F}),[F]);reactExports.useEffect(()=>{const mt=makeCancellablePromise(s());return mt.promise.then(dt=>{l({type:"RESOLVE",value:dt})}).catch(dt=>{l({type:"REJECT",error:dt})}),()=>{cancelRunningTask(mt)}},[s,l]),reactExports.useEffect(()=>{if(!(typeof w>"u")){if(w===!1){wt();return}Tt()}},[w]);function o(){S&&(p&&p(S),at.current=new Array(S.numPages),tt.current.setDocument(S))}function a(){X&&(warning$1(!1,X.toString()),E&&E(X))}function h(){V({type:"RESET"})}reactExports.useEffect(h,[V,w]);function u(){if(!w)return;const mt=A?Object.assign(Object.assign({},w),A):w,dt=pdfjs$1.getDocument(mt);v&&(dt.onProgress=v),y&&(dt.onPassword=y);const kt=dt;return kt.promise.then(Nt=>{V({type:"RESOLVE",value:Nt})}).catch(Nt=>{kt.destroyed||V({type:"REJECT",error:Nt})}),()=>{kt.destroy()}}reactExports.useEffect(u,[A,V,w]),reactExports.useEffect(()=>{if(!(typeof S>"u")){if(S===!1){a();return}o()}},[S]);function T(){tt.current.setViewer(yt.current),tt.current.setExternalLinkRel(H),tt.current.setExternalLinkTarget(ct)}reactExports.useEffect(T,[H,ct]);function O(mt,dt){at.current[mt]=dt}function U(mt){delete at.current[mt]}const rt=reactExports.useMemo(()=>({imageResourcesPath:m,linkService:tt.current,onItemClick:P,pdf:S,registerPage:O,renderMode:c,rotate:d,unregisterPage:U}),[m,P,S,c,d]),nt=reactExports.useMemo(()=>makeEventProps(M,()=>S),[M,S]);function lt(){return React.createElement(DocumentContext.Provider,{value:rt},i)}function pt(){return F?S==null?React.createElement(Message,{type:"loading"},typeof I=="function"?I():I):S===!1?React.createElement(Message,{type:"error"},typeof z=="function"?z():z):lt():React.createElement(Message,{type:"no-data"},typeof N=="function"?N():N)}return React.createElement("div",Object.assign({className:clsx("react-pdf__Document",f),ref:R,style:{"--scale-factor":"1"}},nt),pt())}),isFunctionOrNode$1=PropTypes.oneOfType([PropTypes.func,PropTypes.node]);Document.propTypes=Object.assign(Object.assign({},eventProps),{children:PropTypes.node,className:isClassName,error:isFunctionOrNode$1,externalLinkRel:PropTypes.string,externalLinkTarget:PropTypes.oneOf(["_self","_blank","_parent","_top"]),file:isFile,imageResourcesPath:PropTypes.string,inputRef:isRef,loading:isFunctionOrNode$1,noData:isFunctionOrNode$1,onItemClick:PropTypes.func,onLoadError:PropTypes.func,onLoadProgress:PropTypes.func,onLoadSuccess:PropTypes.func,onPassword:PropTypes.func,onSourceError:PropTypes.func,onSourceSuccess:PropTypes.func,options:PropTypes.shape({canvasFactory:PropTypes.any,canvasMaxAreaInBytes:PropTypes.number,cMapPacked:PropTypes.bool,CMapReaderFactory:PropTypes.any,cMapUrl:PropTypes.string,disableAutoFetch:PropTypes.bool,disableFontFace:PropTypes.bool,disableRange:PropTypes.bool,disableStream:PropTypes.bool,docBaseUrl:PropTypes.string,enableXfa:PropTypes.bool,filterFactory:PropTypes.any,fontExtraProperties:PropTypes.bool,httpHeaders:PropTypes.object,isEvalSupported:PropTypes.bool,isOffscreenCanvasSupported:PropTypes.bool,length:PropTypes.number,maxImageSize:PropTypes.number,ownerDocument:PropTypes.any,password:PropTypes.string,pdfBug:PropTypes.bool,rangeChunkSize:PropTypes.number,StandardFontDataFactory:PropTypes.any,standardFontDataUrl:PropTypes.string,stopAtErrors:PropTypes.bool,useSystemFonts:PropTypes.bool,useWorkerFetch:PropTypes.bool,verbosity:PropTypes.number,withCredentials:PropTypes.bool,worker:PropTypes.any}),rotate:PropTypes.number});const Document$1=Document;function useDocumentContext(){return reactExports.useContext(DocumentContext)}function mergeRefs(){for(var D=[],n=0;n<arguments.length;n++)D[n]=arguments[n];var L=D.filter(Boolean);if(L.length<=1){var i=L[0];return i||null}return function(z){L.forEach(function(H){typeof H=="function"?H(z):H&&(H.current=z)})}}const PageContext=reactExports.createContext(null),PDF_ROLE_TO_HTML_ROLE={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},HEADING_PATTERN=/^H(\d+)$/;function isPdfRole(D){return D in PDF_ROLE_TO_HTML_ROLE}function isStructTreeNode(D){return"children"in D}function isStructTreeNodeWithOnlyContentChild(D){return isStructTreeNode(D)?D.children.length===1&&0 in D.children&&"id"in D.children[0]:!1}function getRoleAttributes(D){const n={};if(isStructTreeNode(D)){const{role:L}=D,i=L.match(HEADING_PATTERN);if(i)n.role="heading",n["aria-level"]=Number(i[1]);else if(isPdfRole(L)){const f=PDF_ROLE_TO_HTML_ROLE[L];f&&(n.role=f)}}return n}function getBaseAttributes(D){const n={};if(isStructTreeNode(D)){if(D.alt!==void 0&&(n["aria-label"]=D.alt),D.lang!==void 0&&(n.lang=D.lang),isStructTreeNodeWithOnlyContentChild(D)){const[L]=D.children;if(L){const i=getBaseAttributes(L);return Object.assign(Object.assign({},n),i)}}}else"id"in D&&(n["aria-owns"]=D.id);return n}function getAttributes(D){return D?Object.assign(Object.assign({},getRoleAttributes(D)),getBaseAttributes(D)):null}function StructTreeItem({className:D,node:n}){const L=reactExports.useMemo(()=>getAttributes(n),[n]),i=reactExports.useMemo(()=>!isStructTreeNode(n)||isStructTreeNodeWithOnlyContentChild(n)?null:n.children.map((f,z)=>React.createElement(StructTreeItem,{key:z,node:f})),[n]);return React.createElement("span",Object.assign({className:D},L),i)}function usePageContext(){return reactExports.useContext(PageContext)}function StructTree(){const D=usePageContext();invariant(D,"Unable to find Page context.");const{onGetStructTreeError:n,onGetStructTreeSuccess:L}=D,[i,f]=useResolver(),{value:z,error:H}=i,{customTextRenderer:ct,page:F}=D;function R(){z&&L&&L(z)}function m(){H&&(warning$1(!1,H.toString()),n&&n(H))}function I(){f({type:"RESET"})}reactExports.useEffect(I,[f,F]);function N(){if(ct||!F)return;const P=makeCancellablePromise(F.getStructTree()),E=P;return P.promise.then(v=>{f({type:"RESOLVE",value:v})}).catch(v=>{f({type:"REJECT",error:v})}),()=>cancelRunningTask(E)}return reactExports.useEffect(N,[ct,F,f]),reactExports.useEffect(()=>{if(z!==void 0){if(z===!1){m();return}R()}},[z]),z?React.createElement(StructTreeItem,{className:"react-pdf__Page__structTree structTree",node:z}):null}const ANNOTATION_MODE=pdfjs$1.AnnotationMode;function PageCanvas(D){const n=usePageContext();invariant(n,"Unable to find Page context.");const L=Object.assign(Object.assign({},n),D),{_className:i,canvasBackground:f,devicePixelRatio:z=getDevicePixelRatio(),onRenderError:H,onRenderSuccess:ct,page:F,renderForms:R,renderTextLayer:m,rotate:I,scale:N}=L,{canvasRef:P}=D;invariant(F,"Attempted to render page canvas, but no page was specified.");const E=reactExports.useRef(null);function v(){F&&ct&&ct(makePageCallback(F,N))}function p(c){isCancelException(c)||(warning$1(!1,c.toString()),H&&H(c))}const y=reactExports.useMemo(()=>F.getViewport({scale:N*z,rotation:I}),[z,F,I,N]),C=reactExports.useMemo(()=>F.getViewport({scale:N,rotation:I}),[F,I,N]);function x(){if(!F)return;F.cleanup();const{current:c}=E;if(!c)return;c.width=y.width,c.height=y.height,c.style.width="".concat(Math.floor(C.width),"px"),c.style.height="".concat(Math.floor(C.height),"px"),c.style.visibility="hidden";const d={annotationMode:R?ANNOTATION_MODE.ENABLE_FORMS:ANNOTATION_MODE.ENABLE,canvasContext:c.getContext("2d",{alpha:!1}),viewport:y};f&&(d.background=f);const M=F.render(d),b=M;return M.promise.then(()=>{c.style.visibility="",v()}).catch(p),()=>cancelRunningTask(b)}reactExports.useEffect(x,[f,E,z,F,R,y,C]);const A=reactExports.useCallback(()=>{const{current:c}=E;c&&(c.width=0,c.height=0)},[E]);return reactExports.useEffect(()=>A,[A]),React.createElement("canvas",{className:"".concat(i,"__canvas"),dir:"ltr",ref:mergeRefs(P,E),style:{display:"block",userSelect:"none"}},m?React.createElement(StructTree,null):null)}function PageSVG(){const D=usePageContext();invariant(D,"Unable to find Page context.");const{_className:n,onRenderSuccess:L,onRenderError:i,page:f,rotate:z,scale:H}=D;invariant(f,"Attempted to render page SVG, but no page was specified.");const[ct,F]=useResolver(),{value:R,error:m}=ct;function I(){f&&L&&L(makePageCallback(f,H))}function N(){m&&(isCancelException(m)||(warning$1(!1,m.toString()),i&&i(m)))}const P=reactExports.useMemo(()=>f.getViewport({scale:H,rotation:z}),[f,z,H]);function E(){F({type:"RESET"})}reactExports.useEffect(E,[f,F,P]);function v(){if(!f)return;const x=makeCancellablePromise(f.getOperatorList());return x.promise.then(A=>{new pdfjs$1.SVGGraphics(f.commonObjs,f.objs).getSVG(A,P).then(d=>{if(!(d instanceof SVGElement))throw new Error("getSVG returned unexpected result.");F({type:"RESOLVE",value:d})}).catch(d=>{F({type:"REJECT",error:d})})}).catch(A=>{F({type:"REJECT",error:A})}),()=>cancelRunningTask(x)}reactExports.useEffect(v,[f,F,P]),reactExports.useEffect(()=>{if(R!==void 0){if(R===!1){N();return}I()}},[R]);function p(x){if(!x||!R)return;x.firstElementChild||x.appendChild(R);const{width:A,height:c}=P;R.setAttribute("width","".concat(A)),R.setAttribute("height","".concat(c))}const{width:y,height:C}=P;return React.createElement("div",{className:"".concat(n,"__svg"),ref:x=>p(x),style:{display:"block",backgroundColor:"white",overflow:"hidden",width:y,height:C,userSelect:"none"}})}function isTextItem(D){return"str"in D}function TextLayer(){const D=usePageContext();invariant(D,"Unable to find Page context.");const{customTextRenderer:n,onGetTextError:L,onGetTextSuccess:i,onRenderTextLayerError:f,onRenderTextLayerSuccess:z,page:H,pageIndex:ct,pageNumber:F,rotate:R,scale:m}=D;invariant(H,"Attempted to load page text content, but no page was specified.");const[I,N]=useResolver(),{value:P,error:E}=I,v=reactExports.useRef(null),p=reactExports.useRef();warning$1(parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-text-layer"),10)===1,"TextLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-text-layer");function y(){P&&i&&i(P)}function C(){E&&(warning$1(!1,E.toString()),L&&L(E))}function x(){N({type:"RESET"})}reactExports.useEffect(x,[H,N]);function A(){if(!H)return;const g=makeCancellablePromise(H.getTextContent()),$=g;return g.promise.then(V=>{N({type:"RESOLVE",value:V})}).catch(V=>{N({type:"REJECT",error:V})}),()=>cancelRunningTask($)}reactExports.useEffect(A,[H,N]),reactExports.useEffect(()=>{if(P!==void 0){if(P===!1){C();return}y()}},[P]);const c=reactExports.useCallback(()=>{z&&z()},[z]),d=reactExports.useCallback(g=>{warning$1(!1,g.toString()),f&&f(g)},[f]);function M(){const g=p.current;g&&g.classList.add("active")}function b(){const g=p.current;g&&g.classList.remove("active")}const l=reactExports.useMemo(()=>H.getViewport({scale:m,rotation:R}),[H,R,m]);function w(){if(!H||!P)return;const{current:g}=v;if(!g)return;g.innerHTML="";const $=H.streamTextContent({includeMarkedContent:!0}),V={container:g,textContentSource:$,viewport:l},S=pdfjs$1.renderTextLayer(V),X=S;return S.promise.then(()=>{const tt=document.createElement("div");tt.className="endOfContent",g.append(tt),p.current=tt;const at=g.querySelectorAll('[role="presentation"]');if(n){let G=0;P.items.forEach((ut,yt)=>{if(!isTextItem(ut))return;const Tt=at[G];if(!Tt)return;const wt=n(Object.assign({pageIndex:ct,pageNumber:F,itemIndex:yt},ut));Tt.innerHTML=wt,G+=ut.str&&ut.hasEOL?2:1})}c()}).catch(d),()=>cancelRunningTask(X)}return reactExports.useLayoutEffect(w,[n,d,c,H,ct,F,P,l]),React.createElement("div",{className:clsx("react-pdf__Page__textContent","textLayer"),onMouseUp:b,onMouseDown:M,ref:v})}function AnnotationLayer(){const D=useDocumentContext(),n=usePageContext();invariant(n,"Unable to find Page context.");const L=Object.assign(Object.assign({},D),n),{imageResourcesPath:i,linkService:f,onGetAnnotationsError:z,onGetAnnotationsSuccess:H,onRenderAnnotationLayerError:ct,onRenderAnnotationLayerSuccess:F,page:R,pdf:m,renderForms:I,rotate:N,scale:P=1}=L;invariant(m,"Attempted to load page annotations, but no document was specified. Wrap <Page /> in a <Document /> or pass explicit `pdf` prop."),invariant(R,"Attempted to load page annotations, but no page was specified."),invariant(f,"Attempted to load page annotations, but no linkService was specified.");const[E,v]=useResolver(),{value:p,error:y}=E,C=reactExports.useRef(null);warning$1(parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-annotation-layer"),10)===1,"AnnotationLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-annotations");function x(){p&&H&&H(p)}function A(){y&&(warning$1(!1,y.toString()),z&&z(y))}function c(){v({type:"RESET"})}reactExports.useEffect(c,[v,R]);function d(){if(!R)return;const g=makeCancellablePromise(R.getAnnotations()),$=g;return g.promise.then(V=>{v({type:"RESOLVE",value:V})}).catch(V=>{v({type:"REJECT",error:V})}),()=>{cancelRunningTask($)}}reactExports.useEffect(d,[v,R,I]),reactExports.useEffect(()=>{if(p!==void 0){if(p===!1){A();return}x()}},[p]);function M(){F&&F()}function b(g){warning$1(!1,"".concat(g)),ct&&ct(g)}const l=reactExports.useMemo(()=>R.getViewport({scale:P,rotation:N}),[R,N,P]);function w(){if(!m||!R||!f||!p)return;const{current:g}=C;if(!g)return;const $=l.clone({dontFlip:!0}),V={accessibilityManager:null,annotationCanvasMap:null,div:g,l10n:null,page:R,viewport:$},S={annotations:p,annotationStorage:m.annotationStorage,div:g,downloadManager:null,imageResourcesPath:i,linkService:f,page:R,renderForms:I,viewport:$};g.innerHTML="";try{new pdfjs$1.AnnotationLayer(V).render(S),M()}catch(X){b(X)}return()=>{}}return reactExports.useEffect(w,[p,i,f,R,I,l]),React.createElement("div",{className:clsx("react-pdf__Page__annotations","annotationLayer"),ref:C})}var __rest=function(D,n){var L={};for(var i in D)Object.prototype.hasOwnProperty.call(D,i)&&n.indexOf(i)<0&&(L[i]=D[i]);if(D!=null&&typeof Object.getOwnPropertySymbols=="function")for(var f=0,i=Object.getOwnPropertySymbols(D);f<i.length;f++)n.indexOf(i[f])<0&&Object.prototype.propertyIsEnumerable.call(D,i[f])&&(L[i[f]]=D[i[f]]);return L};const defaultScale=1,Page=function D(n){const L=useDocumentContext(),i=Object.assign(Object.assign({},L),n),{_className:f="react-pdf__Page",_enableRegisterUnregisterPage:z=!0,canvasBackground:H,canvasRef:ct,children:F,className:R,customRenderer:m,customTextRenderer:I,devicePixelRatio:N,error:P="Failed to load the page.",height:E,inputRef:v,loading:p="Loading page…",noData:y="No page specified.",onGetAnnotationsError:C,onGetAnnotationsSuccess:x,onGetStructTreeError:A,onGetStructTreeSuccess:c,onGetTextError:d,onGetTextSuccess:M,onLoadError:b,onLoadSuccess:l,onRenderAnnotationLayerError:w,onRenderAnnotationLayerSuccess:g,onRenderError:$,onRenderSuccess:V,onRenderTextLayerError:S,onRenderTextLayerSuccess:X,pageIndex:tt,pageNumber:at,pdf:G,registerPage:ut,renderAnnotationLayer:yt=!0,renderForms:Tt=!1,renderMode:wt="canvas",renderTextLayer:k=!0,rotate:s,scale:o=defaultScale,unregisterPage:a,width:h}=i,u=__rest(i,["_className","_enableRegisterUnregisterPage","canvasBackground","canvasRef","children","className","customRenderer","customTextRenderer","devicePixelRatio","error","height","inputRef","loading","noData","onGetAnnotationsError","onGetAnnotationsSuccess","onGetStructTreeError","onGetStructTreeSuccess","onGetTextError","onGetTextSuccess","onLoadError","onLoadSuccess","onRenderAnnotationLayerError","onRenderAnnotationLayerSuccess","onRenderError","onRenderSuccess","onRenderTextLayerError","onRenderTextLayerSuccess","pageIndex","pageNumber","pdf","registerPage","renderAnnotationLayer","renderForms","renderMode","renderTextLayer","rotate","scale","unregisterPage","width"]),[T,O]=useResolver(),{value:U,error:rt}=T,nt=reactExports.useRef(null);invariant(G,"Attempted to load a page, but no document was specified. Wrap <Page /> in a <Document /> or pass explicit `pdf` prop.");const lt=isProvided(at)?at-1:tt!=null?tt:null,pt=at!=null?at:isProvided(tt)?tt+1:null,mt=s!=null?s:U?U.rotate:null,dt=reactExports.useMemo(()=>{if(!U)return null;let zt=1;const Gt=o!=null?o:defaultScale;if(h||E){const Xt=U.getViewport({scale:1,rotation:mt});h?zt=h/Xt.width:E&&(zt=E/Xt.height)}return Gt*zt},[E,U,mt,o,h]);function kt(){return()=>{isProvided(lt)&&z&&a&&a(lt)}}reactExports.useEffect(kt,[z,G,lt,a]);function Nt(){if(l){if(!U||!dt)return;l(makePageCallback(U,dt))}if(z&&ut){if(!isProvided(lt)||!nt.current)return;ut(lt,nt.current)}}function St(){rt&&(warning$1(!1,rt.toString()),b&&b(rt))}function Ot(){O({type:"RESET"})}reactExports.useEffect(Ot,[O,G,lt]);function bt(){if(!G||!pt)return;const zt=makeCancellablePromise(G.getPage(pt)),Gt=zt;return zt.promise.then(Xt=>{O({type:"RESOLVE",value:Xt})}).catch(Xt=>{O({type:"REJECT",error:Xt})}),()=>cancelRunningTask(Gt)}reactExports.useEffect(bt,[O,G,lt,pt,ut]),reactExports.useEffect(()=>{if(U!==void 0){if(U===!1){St();return}Nt()}},[U,dt]);const it=reactExports.useMemo(()=>U&&isProvided(lt)&&pt&&isProvided(mt)&&isProvided(dt)?{_className:f,canvasBackground:H,customTextRenderer:I,devicePixelRatio:N,onGetAnnotationsError:C,onGetAnnotationsSuccess:x,onGetStructTreeError:A,onGetStructTreeSuccess:c,onGetTextError:d,onGetTextSuccess:M,onRenderAnnotationLayerError:w,onRenderAnnotationLayerSuccess:g,onRenderError:$,onRenderSuccess:V,onRenderTextLayerError:S,onRenderTextLayerSuccess:X,page:U,pageIndex:lt,pageNumber:pt,renderForms:Tt,renderTextLayer:k,rotate:mt,scale:dt}:null,[f,H,I,N,C,x,A,c,d,M,w,g,$,V,S,X,U,lt,pt,Tt,k,mt,dt]),st=reactExports.useMemo(()=>makeEventProps(u,()=>U&&(dt?makePageCallback(U,dt):void 0)),[u,U,dt]),gt="".concat(lt,"@").concat(dt,"/").concat(mt),Pt="".concat(lt,"/").concat(mt);function Ct(){switch(wt){case"custom":return invariant(m,'renderMode was set to "custom", but no customRenderer was passed.'),React.createElement(m,{key:"".concat(gt,"_custom")});case"none":return null;case"svg":return React.createElement(PageSVG,{key:"".concat(Pt,"_svg")});case"canvas":default:return React.createElement(PageCanvas,{key:"".concat(gt,"_canvas"),canvasRef:ct})}}function $t(){return k?React.createElement(TextLayer,{key:"".concat(gt,"_text")}):null}function Vt(){return yt?React.createElement(AnnotationLayer,{key:"".concat(gt,"_annotations")}):null}function Ht(){return React.createElement(PageContext.Provider,{value:it},Ct(),$t(),Vt(),F)}function Yt(){return pt?G===null||U===void 0||U===null?React.createElement(Message,{type:"loading"},typeof p=="function"?p():p):G===!1||U===!1?React.createElement(Message,{type:"error"},typeof P=="function"?P():P):Ht():React.createElement(Message,{type:"no-data"},typeof y=="function"?y():y)}return React.createElement("div",Object.assign({className:clsx(f,R),"data-page-number":pt,ref:mergeRefs(v,nt),style:{"--scale-factor":"".concat(dt),backgroundColor:H||"white",position:"relative",minWidth:"min-content",minHeight:"min-content"}},st),Yt())},isFunctionOrNode=PropTypes.oneOfType([PropTypes.func,PropTypes.node]);Page.propTypes=Object.assign(Object.assign({},eventProps),{canvasBackground:PropTypes.string,canvasRef:isRef,children:PropTypes.node,className:isClassName,customRenderer:PropTypes.func,customTextRenderer:PropTypes.func,devicePixelRatio:PropTypes.number,error:isFunctionOrNode,height:PropTypes.number,imageResourcesPath:PropTypes.string,inputRef:isRef,loading:isFunctionOrNode,noData:isFunctionOrNode,onGetTextError:PropTypes.func,onGetTextSuccess:PropTypes.func,onLoadError:PropTypes.func,onLoadSuccess:PropTypes.func,onRenderError:PropTypes.func,onRenderSuccess:PropTypes.func,onRenderTextLayerError:PropTypes.func,onRenderTextLayerSuccess:PropTypes.func,pageIndex:isPageIndex,pageNumber:isPageNumber,pdf:isPdf,renderAnnotationLayer:PropTypes.bool,renderForms:PropTypes.bool,renderMode:isRenderMode,renderTextLayer:PropTypes.bool,rotate:isRotate,scale:PropTypes.number,width:PropTypes.number});const Page$1=Page;displayWorkerWarning();pdfjs$1.GlobalWorkerOptions.workerSrc="pdf.worker.js";pdfjs$1.GlobalWorkerOptions.workerSrc="//cdnjs.cloudflare.com/ajax/libs/pdf.js/".concat(pdfjs$1.version,"/pdf.worker.min.js");function CustomPDFViewer(D){const[n,L]=React.useState(null),[i,f]=React.useState(1);function z({numPages:H}){L(H)}return jsxRuntimeExports.jsx("div",{className:"px-1 py-1 w-full bg-gray-300",children:jsxRuntimeExports.jsxs("div",{className:"overflow-x-scroll mt-2 ",children:[jsxRuntimeExports.jsx(Document$1,{file:D.file,onLoadSuccess:z,children:Array.from(new Array(n),(H,ct)=>jsxRuntimeExports.jsx(Page$1,{pageNumber:ct+1,renderAnnotationLayer:!1,renderTextLayer:!1,width:window.innerWidth,height:window.innerHeight/2},"page_".concat(ct+1)))}),jsxRuntimeExports.jsxs("p",{children:["Page ",i," of ",n]})]})})}function Measurement(){var m,I,N,P,E,v,p,y,C,x,A,c,d,M,b;const D=useNavigate(),n=usePostMutation({}),[L,i]=React.useState(""),[f,z]=React.useState(""),{id:H}=useParams(),ct=useApiPost({api:propertyApi.staticSafDetail,config:{applicationId:H},value:[H],options:{enabled:!!H}}),F=useFormik({initialValues:{uploadMeasurement:"",comment:""},validationSchema:create$3({uploadMeasurement:create$6().required().label("Measurement Sheet"),comment:create$6().label("Comment").min(2).max(500)}),onSubmit:async l=>{var g,$,V,S,X,tt;const w=new FormData;w.append("applicationId",H),w.append("document",l==null?void 0:l.uploadMeasurement);try{const at=await n.mutateAsync({api:propertyApi.uploadMeasurementSheetApi,data:w});if((g=at==null?void 0:at.data)!=null&&g.status){const G=await n.mutateAsync({api:propertyApi.safLevel,data:{applicationId:H,receiverRoleId1:"",action:"forward",comment:(l==null?void 0:l.comment)||"OK"}});($=G==null?void 0:G.data)!=null&&$.status?(Q.success((V=G==null?void 0:G.data)==null?void 0:V.message),D("/amc-app/property/saf-verification-list",{replace:!0})):Q.error((S=G==null?void 0:G.data)==null?void 0:S.message)}else Q.error((X=at==null?void 0:at.data)==null?void 0:X.message)}catch(at){Q.error((tt=at==null?void 0:at.data)==null?void 0:tt.message)}}}),R=async l=>{var g,$,V;const w=l.target.files[0];if((w==null?void 0:w.type)==="application/pdf"){const S=new FileReader;S.onload=X=>{i(X.target.result),z(w.name.split(".").pop())},S.readAsDataURL(w),F.setFieldValue("uploadMeasurement",w)}else{const S=await resizeFile((g=l==null?void 0:l.target)==null?void 0:g.files[0]),X=new File([S],(V=($=l==null?void 0:l.target)==null?void 0:$.files[0])==null?void 0:V.name,{type:"image/*"}),tt=new FileReader;tt.onload=at=>{i(at.target.result),z(X.name.split(".").pop())},tt.readAsDataURL(X),F.setFieldValue("uploadMeasurement",X)}};return ct!=null&&ct.isLoading?jsxRuntimeExports.jsx(InitialLoader,{}):jsxRuntimeExports.jsxs(Page$2,{title:"Measurement",children:[n.isLoading&&jsxRuntimeExports.jsx(OverLayLoader,{}),jsxRuntimeExports.jsx(FormProvider,{formik:F,children:jsxRuntimeExports.jsxs("div",{className:"p-4 ",children:[jsxRuntimeExports.jsx(react.Card,{className:"w-full",children:jsxRuntimeExports.jsxs(react.CardBody,{children:[jsxRuntimeExports.jsx("div",{className:"flex justify-between items-center",children:jsxRuntimeExports.jsx("h1",{className:"font-semibold",children:"Measurement Sheet"})}),jsxRuntimeExports.jsx("div",{className:"border-b-2 border-gray-300 w-full py-1"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-3 mt-3",children:[jsxRuntimeExports.jsx("h1",{className:"font-semibold text-sm",children:"Application No : "}),jsxRuntimeExports.jsx("h1",{className:"text-sm",children:(I=(m=ct==null?void 0:ct.data)==null?void 0:m.data)==null?void 0:I.saf_no}),jsxRuntimeExports.jsx("h1",{className:"font-semibold text-sm",children:"Application Type : "}),jsxRuntimeExports.jsx("h1",{className:"text-sm",children:(P=(N=ct==null?void 0:ct.data)==null?void 0:N.data)==null?void 0:P.assessment_type}),jsxRuntimeExports.jsx("h1",{className:"font-semibold text-sm",children:"Apply Date : "}),jsxRuntimeExports.jsx("h1",{className:"text-sm",children:(v=(E=ct==null?void 0:ct.data)==null?void 0:E.data)==null?void 0:v.application_date}),jsxRuntimeExports.jsx("h1",{className:"font-semibold text-sm",children:"Owner Name : "}),jsxRuntimeExports.jsx("h1",{className:"text-sm",children:(y=(p=ct==null?void 0:ct.data)==null?void 0:p.data)==null?void 0:y.applicant_name}),jsxRuntimeExports.jsx("h1",{className:"font-semibold text-sm",children:"Mobile No : "}),jsxRuntimeExports.jsx("h1",{className:"text-sm w-40 truncate",children:(c=(A=(x=(C=ct==null?void 0:ct.data)==null?void 0:C.data)==null?void 0:x.owners)==null?void 0:A.map(l=>l==null?void 0:l.mobile_no))==null?void 0:c.join(", ")})]})]})}),jsxRuntimeExports.jsx("div",{className:"my-4 border-b-2"}),jsxRuntimeExports.jsxs(react.Card,{className:"w-full",children:[jsxRuntimeExports.jsx("div",{className:"flex justify-between items-center px-5 bg-blue-gray-400 py-2 rounded-tl-lg rounded-tr-lg",children:jsxRuntimeExports.jsx("h1",{className:"text-base font-semibold text-gray-100",children:"Upload Measurement Sheet"})}),L&&(f==="pdf"?jsxRuntimeExports.jsx(CustomPDFViewer,{file:L}):jsxRuntimeExports.jsx("div",{className:"flex justify-center px-4 py-2",children:jsxRuntimeExports.jsx("img",{src:L,alt:"preview"})})),jsxRuntimeExports.jsx(react.CardBody,{children:jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 justify-center gap-5",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{className:"mb-1",children:jsxRuntimeExports.jsx("h1",{className:"font-semibold text-xs",children:"Upload Measurement Sheet"})}),jsxRuntimeExports.jsx("input",{type:"file",name:"uploadMeasurement",onChange:R,className:"border border-gray-300 p-2 rounded-lg"}),jsxRuntimeExports.jsx("small",{className:"text-red-500",children:((d=F==null?void 0:F.errors)==null?void 0:d.uploadMeasurement)&&((M=F==null?void 0:F.touched)==null?void 0:M.uploadMeasurement)&&((b=F==null?void 0:F.errors)==null?void 0:b.uploadMeasurement)})]}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(TextAreaField,{label:"Comment",name:"comment",formik:F,placeholder:"Comment"})})]})})]}),jsxRuntimeExports.jsx("div",{className:"my-4 border-b-2"}),jsxRuntimeExports.jsx("div",{className:"flex justify-center",children:jsxRuntimeExports.jsx(react.Button,{color:"blue",size:"sm",type:"submit",children:"Forward"})})]})})]})}export{Measurement as default};
