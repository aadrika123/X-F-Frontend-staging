import{j as e,b as we,a as ke,p,S as _e,Q as h,f as Pe}from"./index-rvbWXsAs.js";import{e as i,R as f,h as Se,u as Ce,r as Ae}from"./react-HXRlOr-l.js";import{u as Be}from"./formik.esm-BYe_KACy.js";import{c as Oe,a as pe,g as fe}from"./index.esm-yBrOrWJe.js";import{F as Ve}from"./FormProvider-KXcKKeLM.js";import{T as Fe}from"./TextField-7yddcJ1G.js";import{R as ze}from"./RadioButton-1nn29QDm.js";import{T as Ie}from"./TextAreaField-fhPjsiJM.js";import"./index-mWJwE1Yp.js";import{P as $e}from"./index-ydPQ-Vjj.js";import{O as qe}from"./OverLayLoader-VNf_HxNe.js";import"./module-P9sElsZx.js";function ye({open:o,setOpen:j,url:u,ext:g}){const m=()=>j(!o);return e.jsxs(e.Fragment,{children:[o&&e.jsx("div",{onClick:m,className:"bg-gray-900/50 dark:bg-gray-900/80 fixed inset-0 z-40"}),e.jsx("div",{id:"authentication-modal",tabIndex:-1,"aria-hidden":"true",className:"".concat(o?"flex":"hidden"," overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full"),children:e.jsx("div",{className:"relative p-4 w-full max-w-md max-h-full ",children:e.jsxs("div",{className:"relative bg-white rounded-lg shadow dark:bg-gray-700 h-[500px]",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-2 md:p-5 border-b rounded-t dark:border-gray-600",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900 dark:text-white",children:"View Sanction Plan"}),e.jsxs("button",{onClick:m,type:"button",className:"end-2.5 text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white","data-modal-hide":"authentication-modal",children:[e.jsx("svg",{className:"w-3 h-3","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 14 14",children:e.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"})}),e.jsx("span",{className:"sr-only",children:"Close modal"})]})]}),g==="pdf"?e.jsx("embed",{src:"https://docs.google.com/viewer?url=".concat(u,"&embedded=true"),width:"100%",height:"100%"}):e.jsx("img",{src:u,alt:"Naksha",className:"w-full h-full"}),e.jsx("div",{className:"p-4 md:p-5",children:e.jsx("div",{className:"flex items-center justify-end mt-4 gap-5",children:e.jsx(i.Button,{type:"button",size:"sm",variant:"text",color:"red",onClick:m,className:"mr-1 bg-gray-300",children:e.jsx("span",{children:"Ok"})})})})]})})})]})}const Le=[{label:"Yes",value:"yes"},{label:"No",value:"no"}];function Xe(){var b,v,w,k,_,P,S,C,A,B,O,V,F,z,I,$,q,L,M,R,T,D,E,Y,W,H,K,Q,U,Z,G,J,X,ee,se,te,ae,re,ie,le,ne,ce,de,oe;const o=we({}),[j,u]=f.useState(""),[g,m]=f.useState(!1),[Ne,y]=f.useState(!1),{id:x}=Se(),N=Ce(),{data:s,refetch:Me,error:Re,isLoading:be}=ke({api:p.getUploadDocNaksha,config:{applicationId:x},value:[x],options:{enabled:!!x}}),t=Be({enableReinitialize:!0,initialValues:{areaOfPlot:"",isNaksha:(b=s==null?void 0:s.data)!=null&&b.naksha?"":"no",comment:"",message:""},validationSchema:Oe({isNaksha:pe().required("Required"),comment:pe().required("Required").max(500,"Max 500 characters"),areaOfPlot:fe().when("isNaksha",{is:"yes",then:()=>fe().required("Required")})}),onSubmit:async r=>{_e.fire({title:"Are you sure?",text:"You are going to verify naksha of this property ",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, Proceed!",cancelButtonText:"No, cancel!",reverseButtons:!0}).then(l=>{l.isConfirmed&&ve(r)}).catch(l=>{var c,d;h.error((d=(c=l==null?void 0:l.response)==null?void 0:c.data)==null?void 0:d.message)})}}),ve=async r=>{var c,d,me,xe,he,ue,je,ge;const l={applicationId:x,IsDouble:r.isNaksha==="no",areaOfPlot:r.areaOfPlot};try{const a=await o.mutateAsync({api:p.nakshaVerify,data:l});if((c=a==null?void 0:a.data)!=null&&c.status){console.log((d=a==null?void 0:a.data)==null?void 0:d.message),u((me=a==null?void 0:a.data)==null?void 0:me.message);const n=await o.mutateAsync({api:p.safLevel,data:{applicationId:x,action:"forward",comment:"Ok"}});(xe=n==null?void 0:n.data)!=null&&xe.status?(N("/amc-app/property/saf-verification-list",{replace:!0}),h.success("".concat(j," and ").concat((he=n==null?void 0:n.data)==null?void 0:he.message))):h.error((ue=n==null?void 0:n.data)==null?void 0:ue.message)}else h.error((je=a==null?void 0:a.data)==null?void 0:je.message)}catch(a){h.error(((ge=a==null?void 0:a.data)==null?void 0:ge.message)||"Something went wrong !")}};return Ae.useEffect(()=>{var r;((r=t==null?void 0:t.values)==null?void 0:r.isNaksha)=="no"&&(t.setFieldValue("areaOfPlot",""),t.setFieldValue("message",""))},[(v=t==null?void 0:t.values)==null?void 0:v.isNaksha]),be?e.jsx(Pe,{}):e.jsxs(e.Fragment,{children:[o.isLoading&&e.jsx(qe,{}),e.jsxs($e,{title:"Naksha Verification",children:[e.jsx(ye,{open:g,setOpen:m,url:(k=(w=s==null?void 0:s.data)==null?void 0:w.naksha)==null?void 0:k.doc_path,ext:(P=(_=s==null?void 0:s.data)==null?void 0:_.naksha)==null?void 0:P.ext}),e.jsx(ye,{open:Ne,setOpen:y,url:(C=(S=s==null?void 0:s.data)==null?void 0:S.measurement_sheet)==null?void 0:C.doc_path,ext:(B=(A=s==null?void 0:s.data)==null?void 0:A.measurement_sheet)==null?void 0:B.ext}),e.jsxs("div",{className:"p-4",children:[e.jsxs(i.Card,{className:"w-full",children:[e.jsx("div",{className:"flex justify-between items-center px-5 bg-blue-gray-400 py-2 rounded-tl-lg rounded-tr-lg",children:e.jsx("h1",{className:"text-base font-semibold text-gray-100",children:"Basic Details"})}),e.jsx(i.CardBody,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-2 items-center",children:[e.jsx("div",{children:e.jsx("h1",{className:"text-sm font-semibold text-gray-900",children:"Application No :"})}),e.jsx("div",{children:e.jsx("h1",{className:"text-sm  text-gray-900",children:(O=s==null?void 0:s.data)==null?void 0:O.saf_no})}),e.jsx("div",{children:e.jsx("h1",{className:"text-sm font-semibold text-gray-900",children:"Owner Name :"})}),e.jsx("div",{className:"text-sm  text-gray-900",children:(V=s==null?void 0:s.data)==null?void 0:V.applicant_name}),e.jsx("div",{children:e.jsxs("h1",{className:"text-sm font-semibold text-gray-900",children:["Buildup Area (",e.jsx("small",{children:"In Sqft"}),") :"]})}),e.jsx("div",{className:"text-sm  text-gray-900",children:(F=s==null?void 0:s.data)==null?void 0:F.builtup_area}),e.jsx("div",{children:e.jsx("h1",{className:"text-sm font-semibold text-gray-900",children:"Zone :"})}),e.jsx("div",{className:"text-sm  text-gray-900",children:e.jsx("h1",{className:"text-sm  text-gray-900",children:(z=s==null?void 0:s.data)==null?void 0:z.zone})}),e.jsx("div",{children:e.jsx("h1",{className:"text-sm font-semibold text-gray-900",children:"Ward :"})}),e.jsx("div",{className:"text-sm  text-gray-900",children:e.jsx("h1",{className:"text-sm  text-gray-900",children:(I=s==null?void 0:s.data)==null?void 0:I.new_ward_no})}),e.jsx("div",{children:e.jsx("h1",{className:"text-sm font-semibold text-gray-900",children:"Property Type :"})}),e.jsx("div",{className:"text-sm  text-gray-900",children:e.jsx("h1",{className:"text-sm  text-gray-900",children:($=s==null?void 0:s.data)==null?void 0:$.property_type})}),e.jsx("div",{children:e.jsx("h1",{className:"text-sm font-semibold text-gray-900",children:"Address :"})}),e.jsx("div",{className:"text-sm  text-gray-900",children:e.jsx("h1",{className:"text-sm  text-gray-900",children:(q=s==null?void 0:s.data)==null?void 0:q.prop_address})}),e.jsx("div",{children:e.jsx("h1",{className:"text-sm font-semibold text-gray-900",children:"Assessment Type :"})}),e.jsx("div",{className:"text-sm  text-gray-900",children:e.jsx("h1",{className:"text-sm  text-gray-900",children:(L=s==null?void 0:s.data)==null?void 0:L.assessment_type})}),e.jsx("div",{children:e.jsx("h1",{className:"text-sm font-semibold text-gray-900",children:"Application Date :"})}),e.jsx("div",{className:"text-sm  text-gray-900",children:e.jsx("h1",{className:"text-sm  text-gray-900",children:(M=s==null?void 0:s.data)==null?void 0:M.application_date})}),e.jsx("div",{className:"col-span-2 flex justify-center items-center mt-3",children:e.jsx(i.Button,{size:"sm",variant:"outlined",onClick:()=>N("/amc-app/property/saf-property-details/".concat(x)),children:e.jsx("span",{children:"View Saf Details"})})})]})})]}),e.jsx("div",{className:"border-b-2 border-gray-300 mt-3 mb-3"}),e.jsxs(i.Card,{className:"w-full",children:[e.jsx("div",{className:"flex justify-between items-center px-5 bg-blue-gray-400 py-2 rounded-tl-lg rounded-tr-lg",children:e.jsxs("h1",{className:"text-base font-semibold text-gray-100",children:["Measurement Sheet"," "]})}),e.jsx(i.CardBody,{children:(R=s==null?void 0:s.data)!=null&&R.measurement_sheet?e.jsxs("div",{className:"grid grid-cols-1 gap-2 items-center",children:[((D=(T=s==null?void 0:s.data)==null?void 0:T.measurement_sheet)==null?void 0:D.ext)=="jpg"||((Y=(E=s==null?void 0:s.data)==null?void 0:E.measurement_sheet)==null?void 0:Y.ext)=="jpeg"||((H=(W=s==null?void 0:s.data)==null?void 0:W.measurement_sheet)==null?void 0:H.ext)=="png"?e.jsx("div",{className:"flex justify-center items-center",children:e.jsx("img",{src:(Q=(K=s==null?void 0:s.data)==null?void 0:K.measurement_sheet)==null?void 0:Q.doc_path,alt:"measurement_sheet",loading:"lazy",width:500,className:"w-full h-full object-cover"})}):e.jsx("div",{className:"w-full",children:e.jsx("embed",{src:"https://docs.google.com/viewer?url=".concat((Z=(U=s==null?void 0:s.data)==null?void 0:U.measurement_sheet)==null?void 0:Z.doc_path,"&embedded=true"),width:"100%",height:"100%"})}),e.jsx("div",{className:"flex justify-center items-center",children:e.jsx(i.Button,{type:"button",size:"sm",color:"blue",className:"text-[11px]  h-8 justify-center items-center text-center flex",onClick:()=>y(!0),variant:"outlined",children:e.jsx("span",{children:"View Measurement"})})})]}):e.jsx("div",{className:"text-center",children:e.jsx("h1",{className:"text-red-900 font-semibold",children:"Sanction Plan not found!"})})})]}),e.jsx("div",{className:"border-b-2 border-gray-300 mt-3 mb-3"}),e.jsxs(i.Card,{className:"w-full",children:[e.jsx("div",{className:"flex justify-between items-center px-5 bg-blue-gray-400 py-2 rounded-tl-lg rounded-tr-lg",children:e.jsx("h1",{className:"text-base font-semibold text-gray-100",children:"Sanction Plan"})}),e.jsx(i.CardBody,{children:(G=s==null?void 0:s.data)!=null&&G.naksha?e.jsxs("div",{className:"grid grid-cols-1 gap-2 items-center",children:[((X=(J=s==null?void 0:s.data)==null?void 0:J.naksha)==null?void 0:X.ext)=="jpg"||((se=(ee=s==null?void 0:s.data)==null?void 0:ee.naksha)==null?void 0:se.ext)=="jpeg"||((ae=(te=s==null?void 0:s.data)==null?void 0:te.naksha)==null?void 0:ae.ext)=="png"?e.jsx("div",{className:"flex justify-center items-center",children:e.jsx("img",{src:(ie=(re=s==null?void 0:s.data)==null?void 0:re.naksha)==null?void 0:ie.doc_path,alt:"naksha",loading:"lazy",width:500,className:"w-full h-full object-cover"})}):e.jsx("div",{className:"w-full",children:e.jsx("embed",{src:"https://docs.google.com/viewer?url=".concat((ne=(le=s==null?void 0:s.data)==null?void 0:le.naksha)==null?void 0:ne.doc_path,"&embedded=true"),width:"100%",height:"100%"})}),e.jsx("div",{className:"flex justify-center items-center",children:e.jsx(i.Button,{type:"button",size:"sm",color:"blue",className:"text-[11px]  h-8 justify-center items-center text-center flex",onClick:()=>m(!0),variant:"outlined",children:e.jsx("span",{children:"View Sanction"})})})]}):e.jsx("div",{className:"text-center",children:e.jsx("h1",{className:"text-red-900 font-semibold",children:"Sanction Plan not found!"})})})]}),e.jsx("div",{className:"border-b-2 border-gray-300 mt-3 mb-4"}),((ce=t==null?void 0:t.values)==null?void 0:ce.isNaksha)=="no"&&e.jsx("div",{className:"flex justify-center items-center",children:e.jsx("h1",{className:"text-sm font-semibold text-red-900 text-center mb-3 w-52",children:"Double taxation will be applied for this property !"})}),e.jsxs(Ve,{formik:t,children:[((de=s==null?void 0:s.data)==null?void 0:de.naksha)&&e.jsx("div",{className:"flex justify-center gap-4 items-center px-5 ",children:Le.map(r=>e.jsx(ze,{formik:t,name:"isNaksha",label:r.label,value:r.value},r.value))}),e.jsxs("div",{className:"grid grid-cols-1 gap-2 items-center mt-4",children:[t.values.isNaksha==="yes"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-sm font-semibold text-gray-900"}),e.jsx("div",{className:"flex justify-center items-center",children:e.jsx("h1",{className:"text-sm font-semibold text-red-900 text-center mb-3 w-52",children:(oe=t==null?void 0:t.values)==null?void 0:oe.message})})]}),e.jsx("div",{children:e.jsx(Fe,{label:"Constructed Area(In Sqft) :",type:"number",formik:t,name:"areaOfPlot",placeholder:"Constructed Area (In Sqft)",onBlur:()=>{var r,l,c,d;((r=t==null?void 0:t.values)==null?void 0:r.areaOfPlot)<((l=s==null?void 0:s.data)==null?void 0:l.builtup_area)?t.setFieldValue("message","100% Taxation will be applied on ".concat(((c=s==null?void 0:s.data)==null?void 0:c.builtup_area)-((d=t==null?void 0:t.values)==null?void 0:d.areaOfPlot)," sqft constructed area !")):t.setFieldValue("message","")}})})]}),e.jsx("div",{children:e.jsx(Ie,{label:"comment",formik:t,name:"comment",placeholder:"Comment"})})]}),e.jsx("div",{className:"flex justify-center mt-4 gap-5",children:e.jsx(i.Button,{type:"submit",size:"sm",children:e.jsx("span",{children:"Forward"})})})]})]})]})]})}export{Xe as default};
