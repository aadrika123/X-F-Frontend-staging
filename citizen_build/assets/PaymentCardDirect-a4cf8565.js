import{j as e}from"./mui-8e804a04.js";import{c as Q,d as i,u as W,b as T,A as J,Q as w,X as E}from"./index-0f28b603.js";import{f as K,u as Z,r as l}from"./router-87042356.js";import{M as v}from"./index-4e794517.js";import{a as ee}from"./index.esm-f717eb21.js";import{B as te}from"./BarLoader-577c8c6a.js";import"./index-05fe6e4f.js";import{_ as ae}from"./index-48d14c2d.js";import{a as j}from"./axios-97164839.js";import{C as ne}from"./CitizenApplyApiList-5b22da78.js";import{h as oe}from"./moment-fbc5633a.js";const Ie="/assets/user-8db58450.png",se={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",backgroundColor:"transparent",border:"none"}};v.setAppElement("#root");function le(t){return e.jsx(v,{isOpen:!0,style:se,contentLabel:"Example Modal",children:t==null?void 0:t.children})}function re(t){return e.jsx(le,{children:e.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 pl-4 pr-16 py-3 rounded relative shadow-xl",role:"alert",children:[e.jsx("strong",{className:"font-bold"}),e.jsx("span",{className:"block sm:inline",children:t==null?void 0:t.errorTitle}),e.jsx("span",{className:"absolute top-0 bottom-0 right-0 px-4 py-3",children:e.jsxs("svg",{onClick:()=>t==null?void 0:t.activateBottomErrorCard(!1,null),className:"fill-current h-6 w-6 text-red-500",role:"button",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:[e.jsx("title",{children:"Close"}),e.jsx("path",{d:"M14.348 14.849a1.2 1.2 0 0 1-1.697 0L10 11.819l-2.651 3.029a1.2 1.2 0 1 1-1.697-1.697l2.758-3.15-2.759-3.152a1.2 1.2 0 1 1 1.697-1.697L10 8.183l2.651-3.031a1.2 1.2 0 1 1 1.697 1.697l-2.758 3.152 2.758 3.15a1.2 1.2 0 0 1 0 1.698z"})]})})]})})}const de=()=>{const[t]=ae();return{handlePayment:async(a,I)=>{console.log("order",a);const h={key:"rzp_test_NXHWEn0nSMDcnm",amount:`${a==null?void 0:a.amount}`,currency:"INR",name:"Acme Corp",description:"Test Transaction",image:"https://deoghar.smartulb.co.in/static/media/rmclogo.d1d9f229f3fd3b66c19c.png",order_id:a==null?void 0:a.orderId,handler:async c=>{console.log(c);const f=await I({...c,...a});console.log("res razorpay",f)},prefill:{name:"Piyush Garg",email:"youremail@example.com",contact:"9999999999"},notes:{address:"Razorpay Corporate Office",departmentId:a==null?void 0:a.departmentId,userId:a==null?void 0:a.user_id,workflowId:a==null?void 0:a.workflowId,ulbId:a==null?void 0:a.ulbId,applicationId:a==null?void 0:a.applicationId},theme:{color:"#3399cc"}},x=new t(h);x.on("payment.failed",function(c){alert(c.error.code)}),x.open()}}},ce={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",backgroundColor:"white",border:"none"}};function Ce(t){const{handlePayment:N}=de();console.log("data",t);const{id:a}=K(),{api_challanOfflinePayment:I,api_generateOrderIdswm:h,api_getTransactionNo:x,api_sendOnlineResponseswm:c,getPaymentUpto:f,getCalculateAmount:R,api_generatedreceipt:ie}=ne(),y=Z(),[B,me]=l.useState(!1),[M,C]=l.useState(!1),[O,L]=l.useState(!1),[z,k]=l.useState(!1),[Y,ue]=l.useState(null),[q,A]=l.useState(null);l.useState(!1),l.useState();const[b,D]=l.useState(),[r,U]=l.useState(),[m,$]=l.useState("");let F=Q({paymentMode:i().required("select payment mode"),remarks:i(),bankName:i(),branchName:i(),cheque_dd_no:i(),cheque_dd_date:i()});const G=W({initialValues:{paymentUpto:"",remarks:"",bankName:"",branchName:"",cheque_dd_no:"",cheque_dd_date:"",payAdvance:"",advanceAmount:""},validationSchema:F,onSubmit:n=>{console.log("values at submit payment",n),S()}}),V=n=>{const{value:o}=n.target;$(o)},p=(n,o)=>{A(o),L(n)},_=()=>k(!1),S=async n=>{C(!0);let o={amount:r==null?void 0:r.totaldemand,consumerId:t==null?void 0:t.consumerId,consumerType:t==null?void 0:t.consumerType};console.log("orderidpayload at payment before...",o),j.post(h,o,T()).then(s=>{var d,u,g;console.log("Order Id Response ",s==null?void 0:s.data),((d=s==null?void 0:s.data)==null?void 0:d.status)===!0?(console.log("==1==OrderId Generated True",(u=s==null?void 0:s.data)==null?void 0:u.data),N({order_id:(g=s==null?void 0:s.data)==null?void 0:g.data,amount:(r==null?void 0:r.totaldemand)*100},H)):p(!0,"Error occured. Please try again later.")}).catch(s=>{p(!0,"Error occured. Please try again later."),console.log("ERROR :-  Unable to Generate Order Id ",s)}).finally(()=>{C(!1)})},H=async n=>{var s;console.log("generateReceipt",n),console.log(n);let o={amount:(n==null?void 0:n.amount)/100,consumerId:t.consumerId,consumerType:t==null?void 0:t.consumerType,orderId:(s=n==null?void 0:n.order_id)==null?void 0:s.order_id,paymentId:n==null?void 0:n.razorpay_payment_id,payUpto:m};console.log("Receipt",n),J.post(c,o,T()).then(d=>{var u,g;console.log("genereted receipt",d),d.data.status==!0?(console.log("Oder ID Generated ++++dddddddddddddddddddddddd+++++",d.data),w.success("Payment Done Successfully !!!","success"),y(`/swm-payment-receipt/${(g=(u=d.data)==null?void 0:u.data)==null?void 0:g.transactionId}`,{replace:!0}),console.log("Receipt",d.data)):w.error(d.data.message,"error")}).catch(d=>{console.log("Error genrating order id",d),w.error(d.message,"error")})};console.log("BBBBb",t==null?void 0:t.consumerId),console.log("BBBBb   id ==>",a),console.log("consumer Type ==>",t==null?void 0:t.consumerType),l.useEffect(()=>{let n={consumerId:a,consumerType:t==null?void 0:t.consumerType};j.post(f,n).then(o=>{o.data.status&&(D(o.data.data),console.log("Error while getting application data",o.data.data))}).catch(o=>{console.log("Error while getting application data")})},[]);const X=()=>{if(m){let n={consumerId:a,payUpto:m,consumerType:t==null?void 0:t.consumerType};j.post(R,n).then(o=>{o.data.status&&(U(o.data.data),console.log("Error while getting application data",o.data.data))}).catch(o=>{console.log("Error while getting application data")})}};l.useEffect(()=>{X()},[m]);const P=()=>{t==null||t.closeDialogTag(),k(!1),S()};return M?e.jsx(e.Fragment,{children:e.jsx(te,{})}):B==!0?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"w-full h-full bg-white sm:p-20 p-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-center font-semibold text-3xl",children:"Your payment has been successfully done !"}),e.jsxs("div",{className:"text-center mt-6",children:[e.jsx("button",{className:"mr-4 bg-indigo-500  text-white px-6 py-1 shadow-lg hover:scale-105 rounded-sm",onClick:()=>y(`/swm-payment-receipt/${a}`),children:"View Receipt"}),e.jsx("button",{className:"mr-4 bg-white border border-indigo-500 text-indigo-500 px-4 py-1 shadow-lg hover:scale-105 rounded-sm",onClick:()=>y(`/challan/${a}/direct`),children:"View Challan"})]})]}),console.log("dghhjhdj",Y)]})}):e.jsxs(e.Fragment,{children:[O&&e.jsx(re,{activateBottomErrorCard:p,errorTitle:q}),e.jsx("div",{className:" block sm:p-4 mt-4 w-full md:py-4 md:px-40 md:pb-0 md:pt-0 rounded-lg  bg-white md:w-full mx-auto  overflow-x-auto mb-20 ",children:e.jsxs("div",{className:"border rounded-md shadow-lg shadow-black flex justify-center items-center ",children:[e.jsxs("div",{className:"w-full md:w-[25%] ml-2",children:[e.jsxs("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:["Payment Upto",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:m,onChange:V,className:`${G.errors.searchBy?"text-red-400 font-semibold border border-solid border-red-400 placeholder-red-300 shadow-red-100 ":"text-gray-700 font-normal border border-solid border-gray-400 placeholder-gray-400 h-10"} cursor-pointer w-full px-3 py-1 text-sm  bg-white bg-clip-padding rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none shadow-sm`,children:[e.jsx("option",{value:"",disabled:!0,children:"--Select--"}),b==null?void 0:b.map(n=>e.jsx("option",{value:n.payment_to,children:oe(n.payment_to,"YYYY-MM-DD").format("MMM-YYYY")}))]})]}),e.jsxs("div",{className:"p-4 w-full md:py-6 rounded-lg bg-white mx-auto flex mt-3",children:[e.jsxs("div",{className:"md:px-4  flex justify-center items-center mt-4",children:[e.jsx("span",{children:"Total Payable Amount :"})," ",e.jsx("span",{className:"font-mono font-bold text-xl",children:E(r==null?void 0:r.totaldemand)})]}),e.jsx("div",{className:"mt-4 ",children:e.jsxs("button",{onClick:P,type:"button",className:"sm:ml-4 font-bold px-6 py-3 md:py-2 bg-indigo-500 text-white text-xs sm:text-sm leading-tight uppercase rounded  hover:bg-indigo-700 hover:shadow-lg focus:shadow-lg focus:outline-none focus:ring-0 active:bg-indigo-800 active:shadow-lg transition duration-150 ease-in-out shadow-xl border border-white",children:[e.jsx("span",{className:"sm:mr-2 mr-1",children:"Pay "}),E(r==null?void 0:r.totaldemand)]})})]})]})}),e.jsx(v,{isOpen:z,onRequestClose:_,style:ce,contentLabel:"Example Modal",children:e.jsxs("div",{class:"relative bg-white rounded-lg shadow-xl border-2 border-gray-50",children:[e.jsx("button",{onClick:_,type:"button",class:"absolute top-3 right-2.5 text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm p-1.5 ml-auto inline-flex items-center dark:hover:bg-gray-800 dark:hover:text-white",children:e.jsx("svg",{class:"w-5 h-5",fill:"currentColor",children:e.jsx("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})})}),e.jsxs("div",{class:"p-6 text-center",children:[e.jsxs("div",{className:"w-full flex h-10",children:[" ",e.jsx("span",{className:"mx-auto",children:e.jsx(ee,{size:30})})]}),e.jsx("h3",{class:"mb-5 text-lg font-normal text-gray-500 dark:text-gray-400",children:"Confirm Payment"}),e.jsx("button",{type:"button",class:"text-white bg-green-600 hover:bg-green-800 focus:ring-4 focus:outline-none focus:ring-red-300 dark:focus:ring-red-800 font-medium rounded-lg text-sm inline-flex items-center px-5 py-2.5 text-center mr-2",onClick:P,children:"Yes, I'm sure"})]})]})})]})}export{Ce as P,Ie as p};
