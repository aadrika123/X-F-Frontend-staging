import{j as e}from"./mui-8e804a04.js";import{u as G,r}from"./router-87042356.js";import{l as V,c as J,d as x,u as Q,A as f,B as ee,i as ae}from"./index-0f28b603.js";import"./PetAccordionPage-26a80458.js";import{P as se}from"./PetRegAPIList-7a71d901.js";import{W as te}from"./WaterApiList-5dfb5a8b.js";import{r as L}from"./UseImgResizer-f1558408.js";import"./react-09dd1212.js";import"./axios-97164839.js";import"./reactIcons-6a3b6da1.js";import"./redux-4db06ad6.js";import"./i18next-e99b4042.js";const le=o=>{var g,N;const h=G();return console.log("3",(g=o==null?void 0:o.data)==null?void 0:g.applicationNo),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{className:"text-center",children:[" ","Your Application has submitted successfully"]}),e.jsxs("p",{className:"text-center",children:["Application No."," ",e.jsxs("span",{className:"font-semibold text-lg",children:[" ",(N=o==null?void 0:o.data)==null?void 0:N.applicationNo]})]}),e.jsx("div",{className:"flex justify-center gap-x-5",children:e.jsx("button",{onClick:()=>h("/vehicle-registration-dashboard"),className:"border border-indigo-600 px-2 py-1 rounded shadow hover:bg-indigo-500 hover:text-white",children:"Dashboard"})})]})},a={required:"text-red-700 font-semibold",label:"text-sm",textFiled:"block w-full h-9 border px-2 border-gray-300 rounded shadow text-gray-700",textArea:"block w-full border px-2 border-gray-300 rounded shadow"},ie=o=>{const[h,g]=r.useState(),[N,j]=r.useState(),[re,D]=r.useState(),[v,A]=r.useState(!1),[P,F]=r.useState(!1),[q,C]=r.useState(!1),{notify:S}=r.useContext(V);r.useState(),r.useState();const[R,w]=r.useState(!1),[ne,k]=r.useState(),[oe,K]=r.useState(),[ce,B]=r.useState(),[y,de]=r.useState(""),{api_ulbList:W,header:I,api_wardList:_}=te(),{api_RigRegistrationApplyForm:M,api_PetRegistrationMaster:U,api_ListOfSafHolding:me,api_getUserDetailsByHoldingSaf:pe,header1:z}=se(),T=J({ulb:x().required("Kindly enter a value."),address:x().required("Kindly enter a value."),applicantName:x().matches(/^[a-zA-Z0-9\s,.:-]+$/,"Only text is allowed").required("Kindly enter a value."),mobileNo:x().matches(/^\d{10}$/,"Mobile number must be exactly 10 digits").required("Kindly enter a value."),email:x().email().required("Kindly enter a value."),vehicleComapny:x().required("Kindly enter a value."),fitness:x().required("Kindly enter a value."),taxCopy:x().required("Kindly enter a value."),license:x().required("Kindly enter a value."),registrationNumber:x().required("Kindly enter a value.")}),$={ulb:"",ulbId:"",applicantName:"",mobileNo:"",email:"",address:"",vehicleComapny:"",fitness:"",taxCopy:"",license:"",registrationNumber:""};let c=new FormData;const t=Q({initialValues:$,enableReinitialize:!0,onSubmit:(s,i)=>{console.log("clicked"),console.log(s,"formSubmitValues==>"),O(s)},validationSchema:T}),H=s=>{let i=s.target.name,n=s.target.value;C(!1),i=="driverName"&&t.setFieldValue("driverName",ae(n,t.values.driverName,20)),i=="fitness"&&k(s.target.files[0]),i=="taxCopy"&&K(s.target.files[0]),i=="license"&&B(s.target.files[0])},O=s=>{var n,d,m;F(!0);const i={ulbId:s==null?void 0:s.ulb,applicantName:s==null?void 0:s.applicantName,mobileNo:s==null?void 0:s.mobileNo,email:s==null?void 0:s.email,address:s==null?void 0:s.address,vehicleComapny:s==null?void 0:s.vehicleComapny,registrationNumber:s==null?void 0:s.registrationNumber};console.log(i,"payload====>>");for(let l in i)c.append(l,i[l]);c.append("documents[0][image]",(n=t==null?void 0:t.values)==null?void 0:n.fitness),c.append("documents[0][docCode]","FITNESS"),c.append("documents[0][ownerDtlId]",""),c.append("documents[1][image]",(d=t==null?void 0:t.values)==null?void 0:d.taxCopy),c.append("documents[1][docCode]","TAX"),c.append("documents[1][ownerDtlId]",""),c.append("documents[2][image]",(m=t==null?void 0:t.values)==null?void 0:m.license),c.append("documents[2][docCode]","LICENSE"),c.append("documents[2][ownerDtlId]",""),console.log("complete payload",c),f.post(M,c,I).then(l=>{var p,u,b;F(!1),l.data.status?(console.log("Form applied successfully"),o.data(l.data.data),console.log("1",l.data.data),o.screen(2),S((p=l==null?void 0:l.data)==null?void 0:p.message,"success")):(S((u=l==null?void 0:l.data)==null?void 0:u.message,"error"),C((b=l==null?void 0:l.data)==null?void 0:b.message),console.log("Failed to apply pet registration"))}).catch(l=>{var p,u,b,E;C((u=(p=l==null?void 0:l.response)==null?void 0:p.data)==null?void 0:u.error),S("Something Went wrong","error"),F(!1),console.log("Error while applying for pet registration..",(E=(b=l==null?void 0:l.response)==null?void 0:b.data)==null?void 0:E.error)})};r.useEffect(()=>{f.post(U,{},z).then(s=>{s.data.status?(D(s.data.data),console.log("vehicle master data",s.data)):console.log("Error fetching vehicle master list")}).catch(s=>{console.log("Error while getting vehicle master list")})},[]),r.useEffect(()=>{f.get(W,I).then(s=>{s.data.status?(g(s.data.data),console.log("ULB List",s.data)):console.log("Error fetching ulb list")}).catch(s=>{console.log("Error while getting ulb list")})},[]),r.useEffect(()=>{w(!0),f.post(_,{ulbId:t.values.ulb},I).then(s=>{w(!1),s.data.status?(j(s.data.data),console.log("Ward List",s.data)):console.log("Error fetching Ward list")}).catch(s=>{w(!1),console.log("Error while getting Ward list")})},[t.values.ulb]);const Y=async s=>{var n,d,m,l;const i=s.target.files[0];if(i){const p=await L(i),u=new File([p],(d=(n=s==null?void 0:s.target)==null?void 0:n.files[0])==null?void 0:d.name,{type:(l=(m=s==null?void 0:s.target)==null?void 0:m.files[0])==null?void 0:l.type});t.setFieldValue("fitness",u)}else t.setFieldValue("fitness",null)},X=async s=>{var n,d,m,l;const i=s.target.files[0];if(i){const p=await L(i),u=new File([p],(d=(n=s==null?void 0:s.target)==null?void 0:n.files[0])==null?void 0:d.name,{type:(l=(m=s==null?void 0:s.target)==null?void 0:m.files[0])==null?void 0:l.type});t.setFieldValue("taxCopy",u)}else t.setFieldValue("taxCopy",null)},Z=async s=>{var n,d,m,l;const i=s.target.files[0];if(i){const p=await L(i),u=new File([p],(d=(n=s==null?void 0:s.target)==null?void 0:n.files[0])==null?void 0:d.name,{type:(l=(m=s==null?void 0:s.target)==null?void 0:m.files[0])==null?void 0:l.type});t.setFieldValue("license",u)}else t.setFieldValue("license",null)};return e.jsxs(e.Fragment,{children:[R&&e.jsx(ee,{}),e.jsxs("form",{onSubmit:t.handleSubmit,onChange:H,className:"mb-20",children:[e.jsxs("div",{className:"overflow-y-auto ",children:[e.jsx("div",{className:"col-span-12 ml-2 my-2"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 bg-white shadow-md rounded-md py-2",children:e.jsxs("div",{className:"m-2",children:[e.jsxs("label",{className:a==null?void 0:a.label,htmlFor:"ulb",children:["Select ULB ",e.jsx("span",{className:a==null?void 0:a.required,children:"*"})]}),e.jsxs("select",{...t.getFieldProps("ulb"),name:"ulb",className:a==null?void 0:a.textFiled,children:[e.jsx("option",{value:"",children:"Select"}),h==null?void 0:h.map((s,i)=>e.jsx("option",{value:s.id,children:s.ulb_name},i))]}),e.jsx("p",{className:"text-red-500 text-xs",children:t.touched.ulb&&t.errors.ulb?t.errors.ulb:null})]})}),e.jsx("div",{className:"col-span-12 ml-2 my-2",children:e.jsx("div",{className:"text-lg text-left text-gray-600 font-semibold",children:"# Applicant Details"})}),e.jsxs("div",{className:"bg-white shadow-md rounded-md py-2",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 ",children:[e.jsxs("div",{className:"m-2",children:[e.jsxs("label",{className:a==null?void 0:a.label,htmlFor:"applicantName",children:["Name of Applicant",e.jsx("span",{className:a==null?void 0:a.required,children:"*"})]}),e.jsx("input",{...t.getFieldProps("applicantName"),maxLength:"70",type:"text",name:"applicantName",className:a==null?void 0:a.textFiled}),e.jsx("p",{className:"text-red-500 text-xs",children:t.touched.applicantName&&t.errors.applicantName?t.errors.applicantName:null})]}),e.jsxs("div",{className:"m-3",children:[e.jsxs("label",{className:a==null?void 0:a.label,htmlFor:"mobileNo",children:["Mobile No",e.jsx("span",{className:a==null?void 0:a.required,children:"*"})]}),e.jsx("input",{...t.getFieldProps("mobileNo"),type:"text",maxLength:10,name:"mobileNo",id:"mobileNo",className:a==null?void 0:a.textFiled,onChange:t.handleChange,onBlur:t.handleBlur,onKeyPress:s=>{s.key>="0"&&s.key<="9"||s.preventDefault()}}),e.jsx("p",{className:"text-red-500 text-xs",children:t.touched.mobileNo&&t.errors.mobileNo?t.errors.mobileNo:null})]}),e.jsxs("div",{className:"m-2",children:[e.jsx("label",{className:a==null?void 0:a.label,htmlFor:"email",children:"Email"}),e.jsx("input",{...t.getFieldProps("email"),type:"email",maxLength:"70",name:"email",className:a==null?void 0:a.textFiled}),e.jsx("p",{className:"text-red-500 text-xs",children:t.touched.email&&t.errors.email?t.errors.email:null})]})]}),e.jsxs("div",{className:"m-3",children:[e.jsxs("label",{className:a==null?void 0:a.label,htmlFor:"address",children:["Address",e.jsx("span",{className:a==null?void 0:a.required,children:"*"})]}),e.jsx("textarea",{...t.getFieldProps("address"),name:"address",maxLength:"500",rows:"3",className:a==null?void 0:a.textArea}),e.jsx("p",{className:"text-red-500 text-xs",children:t.touched.address&&t.errors.address?t.errors.address:null})]})]}),e.jsx("div",{className:"col-span-12 ml-2 my-2",children:e.jsx("div",{className:"text-lg text-left text-gray-600 font-semibold",children:"# Vehicle Details"})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 bg-white shadow-md rounded-md py-2",children:[e.jsxs("div",{className:"m-3",children:[e.jsxs("label",{className:a==null?void 0:a.label,htmlFor:"registrationNumber",children:["Registration No.",e.jsx("span",{className:a==null?void 0:a.required,children:"*"})]}),e.jsx("input",{...t.getFieldProps("registrationNumber"),maxLength:"10",type:"text",name:"registrationNumber",className:a==null?void 0:a.textFiled,onChange:s=>{const i=s.target.value.toUpperCase();t.setFieldValue("registrationNumber",i)}}),e.jsx("p",{className:"text-red-500 text-xs",children:t.touched.registrationNumber&&t.errors.registrationNumber?t.errors.registrationNumber:null})]}),e.jsxs("div",{className:"m-3",children:[e.jsxs("label",{className:a==null?void 0:a.label,htmlFor:"vehicleComapny",children:["VIN Number /CH No",e.jsx("span",{className:a==null?void 0:a.required,children:"*"})]}),e.jsx("input",{...t.getFieldProps("vehicleComapny"),maxLength:"17",type:"text",name:"vehicleComapny",className:a==null?void 0:a.textFiled,onChange:s=>{const i=s.target.value.toUpperCase();t.setFieldValue("vehicleComapny",i)}}),e.jsx("p",{className:"text-red-500 text-xs",children:t.touched.vehicleComapny&&t.errors.vehicleComapny?t.errors.vehicleComapny:null})]}),e.jsxs("div",{className:"m-3",children:[e.jsxs("label",{className:a==null?void 0:a.label,htmlFor:"fitness",children:["Pollution Certificate",e.jsx("span",{className:a==null?void 0:a.required,children:"*"})]}),e.jsx("input",{onChange:Y,maxLength:"50",type:"file",name:"fitness",className:a==null?void 0:a.textFiled}),e.jsx("p",{className:"text-red-500 text-xs",children:y})]}),e.jsxs("div",{className:"m-3",children:[e.jsxs("label",{className:a==null?void 0:a.label,htmlFor:"taxCopy",children:["Tax Copy",e.jsx("span",{className:a==null?void 0:a.required,children:"*"})]}),e.jsx("input",{onChange:X,maxLength:"50",type:"file",name:"taxCopy",className:a==null?void 0:a.textFiled}),e.jsx("p",{className:"text-red-500 text-xs",children:y})]}),e.jsxs("div",{className:"m-3",children:[e.jsxs("label",{className:a==null?void 0:a.label,htmlFor:"license",children:["Registration Of Certificate",e.jsx("span",{className:a==null?void 0:a.required,children:"*"})]}),e.jsx("input",{onChange:Z,maxLength:"50",type:"file",name:"license",className:a==null?void 0:a.textFiled}),e.jsx("p",{className:"text-red-500 text-xs",children:y})]})]})]}),e.jsxs("p",{className:"flex mt-3 gap-x-3",onClick:()=>A(!v),children:[e.jsx("input",{type:"checkbox",checked:v,name:"",id:"",onChange:s=>A(s.target.checked)}),e.jsx("p",{className:" select-none",children:"I have entered the correct information and agree to the terms and conditions."})]}),e.jsx("p",{className:"text-red-500 font-semibold text-center mt-3",children:q&&q}),e.jsx("div",{className:"flex justify-center my-5 ",children:P?e.jsx("p",{children:"Form Submitting.."}):e.jsx("button",{type:"submit",disabled:!v,className:"disabled:opacity-40 bg-indigo-600 hover:bg-indigo-700 px-8 py-2 text-white rounded shadow ",children:"Submit Application"})})]})]})},we=()=>{const[o,h]=r.useState(1),[g,N]=r.useState(),{setBreadCrumbData:j}=r.useContext(V);return r.useEffect(()=>{j(["Apply Pet Registration"])},[]),e.jsx(e.Fragment,{children:e.jsx("div",{className:"grid grid-cols-9 space-x-6 md:my-2 md:mx-8 mx-2",children:e.jsxs("div",{className:"col-span-9 border border-gray-400 rounded mt-6",children:[e.jsx("p",{className:"border-b border-indigo-300 bg-indigo-200 p-1 text-center text-xl shadow-md font-semibold",children:"Rig (HYDT) Registration Application"}),e.jsxs("div",{className:"md:p-5 p-2",children:[e.jsxs("p",{className:`${o==1?"block":"hidden"}`,children:["  ",e.jsx(ie,{screen:h,data:N})," "]}),e.jsxs("p",{className:`${o==2?"block":"hidden"}`,children:[" ",e.jsx(le,{screen:h,data:g})]})]})]})})})};export{we as default};
