import{j as t}from"./mui-8e804a04.js";import{r as i,u as _}from"./router-87042356.js";import{C as G}from"./CitizenApplyApiList-5b22da78.js";import{a as H}from"./axios-97164839.js";import{l as J,m as T}from"./index-0f28b603.js";import{B as Q}from"./BarLoader-9fd00c2c.js";import{C as U}from"./CommonModal-340f9ebb.js";import{B as X}from"./BottomErrorCard-b31e4e97.js";import"./react-09dd1212.js";import"./reactIcons-6a3b6da1.js";import"./redux-4db06ad6.js";import"./i18next-e99b4042.js";import"./index-4e794517.js";function de(r){const[h,j]=i.useState(!1);i.useState("");const{api_verifyMobileOtp:P}=G(),[D,x]=i.useState(!1),{notify:K}=i.useContext(J),[w,k]=i.useState(!1),[O,C]=i.useState(""),[I,N]=i.useState(!1),[A,z]=i.useState(null),[V,S]=i.useState(60),[s,o]=i.useState({first:"",second:"",third:"",fourth:"",fifth:"",sixth:""}),B=i.useRef(),m=i.useRef(),g=i.useRef(),v=i.useRef(),b=i.useRef(),L=i.useRef(),q=_(),[c,n]=i.useState("first"),l=(e,a)=>{C("");let u={...s,[a]:e.target.value};if(o({...s,[a]:e.target.value}),e.target.value.length===1)switch(a){case"first":m.current.focus(),n("second");break;case"second":g.current.focus(),n("third");break;case"third":v.current.focus(),n("fourth");break;case"fourth":b.current.focus(),n("fifth");break;case"fifth":L.current.focus(),n("sixth");break;case"sixth":n("sixth");break}F(u)},d=e=>{switch(e){case"second":B.current.focus(),o({...s,second:""}),n("first");break;case"third":m.current.focus(),o({...s,third:""}),n("second");break;case"fourth":g.current.focus(),o({...s,fourth:""}),n("third");break;case"fifth":v.current.focus(),o({...s,fifth:""}),n("fouth");break;case"sixth":b.current.focus(),o({...s,sixth:""}),n("fifth");break}},F=e=>{console.table(e),e.first!=""&&e.second!=""&&e.third!=""&&e.fourth!=""&&e.fifth!=""&&e.sixth!=""?k(!0):k(!1)},W=()=>{N(!1),x(!0);let e={otp:`${s.first}${s.second}${s.third}${s.fourth}${s.fifth}${s.sixth}`,mobileNo:r==null?void 0:r.verifedMobileNo};console.log("before verify otp...",e),H.post(P,e).then(a=>{var u,M,E;console.log("otp verify response",a==null?void 0:a.data),(u=a==null?void 0:a.data)!=null&&u.status?r==null||r.callback():(K("Wrong OTP, Please enter correct OTP","error"),C(T((M=a==null?void 0:a.data)==null?void 0:M.message)),y(!0,T((E=a==null?void 0:a.data)==null?void 0:E.message))),x(!1)}).catch(a=>{console.log("otp verify error",a),y(!0,"Error occured. Please try again later."),x(!1)})};let R,f=60;const $=()=>{R=setInterval(()=>{S(e=>e-1),f=f-1,f==0&&(j(!0),console.log("inside static stop..."),clearInterval(R))},1e3)};i.useEffect(()=>{$()},[]);const y=(e,a)=>{z(a),N(e)};return t.jsxs(t.Fragment,{children:[D&&t.jsx(Q,{}),I&&t.jsx(X,{activateBottomErrorCard:y,errorTitle:A}),t.jsx(U,{children:t.jsx("div",{class:"",children:t.jsx("div",{class:"container mx-auto",children:t.jsx("div",{class:"max-w-sm mx-auto md:max-w-lg",children:t.jsxs("div",{class:"w-full px-2 md:px-0",children:[t.jsxs("div",{className:"w-full text-center py-2  bg-gray-200 text-black relative",children:[r==null?void 0:r.headTitle,t.jsx("button",{onClick:r==null?void 0:r.closeOtpModal,type:"button",class:"absolute top-1 right-6 bg-transparent bg-gray-200 text-gray-900 rounded-lg text-sm p-1.5 ml-auto inline-flex items-center shadow-sm  hover:bg-red-200 hover:border-none",children:t.jsx("svg",{class:"w-5 h-5",fill:"currentColor",children:t.jsx("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})})})]}),t.jsxs("div",{class:"bg-white py-20 px-6 md:py-20 md:px-20 w-full md:w-auto rounded text-center shadow-xl relative",children:[t.jsx("div",{class:"text-2xl font-bold px-2",children:"OTP Verification"}),t.jsx("div",{class:"flex flex-col mt-4 text-center",children:t.jsx("span",{className:"text-center text-red-400",children:O})}),t.jsxs("div",{class:"flex flex-col mt-4",children:[t.jsx("span",{children:"Enter the OTP you received at"}),t.jsxs("span",{class:"font-bold",children:["+91 ",r==null?void 0:r.verifedMobileNo]})]}),t.jsxs("div",{id:"otp",class:"flex flex-row justify-center text-center px-2 mt-5",children:[t.jsx("input",{ref:B,type:"text",min:0,value:s.first,maxLength:1,onChange:e=>l(e,"first"),onKeyDown:e=>e.key==="Backspace"&&d("first"),className:`${c==="first"?"active":""} m-2 border h-10 w-10 text-center form-control rounded`}),t.jsx("input",{ref:m,type:"text",min:0,value:s.second,maxLength:1,onChange:e=>l(e,"second"),onKeyDown:e=>e.key==="Backspace"&&d("second"),className:`${c==="second"?"active":""} m-2 border h-10 w-10 text-center form-control rounded`}),t.jsx("input",{ref:g,type:"text",min:0,value:s.third,maxLength:1,onChange:e=>l(e,"third"),onKeyDown:e=>e.key==="Backspace"&&d("third"),className:`${c==="third"?"active":""} m-2 border h-10 w-10 text-center form-control rounded`}),t.jsx("input",{ref:v,type:"text",min:0,value:s.fourth,maxLength:1,onChange:e=>l(e,"fourth"),onKeyDown:e=>e.key==="Backspace"&&d("fourth"),className:`${c==="fourth"?"active":""} m-2 border h-10 w-10 text-center form-control rounded`}),t.jsx("input",{ref:b,type:"text",min:0,value:s.fifth,maxLength:1,onChange:e=>l(e,"fifth"),onKeyDown:e=>e.key==="Backspace"&&d("fifth"),className:`${c==="fifth"?"active":""} m-2 border h-10 w-10 text-center form-control rounded`}),t.jsx("input",{ref:L,type:"text",min:0,value:s.sixth,maxLength:1,onChange:e=>l(e,"sixth"),onKeyDown:e=>e.key==="Backspace"&&d("sixth"),className:`${c==="sixth"?"active":""} m-2 border h-10 w-10 text-center form-control rounded`})]}),t.jsxs("div",{class:"flex justify-center text-center mt-5",children:[!h&&t.jsx("div",{className:"w-10 h-10 bg-indigo-500 flex justify-center items-center rounded-full text-white",children:V}),t.jsxs("button",{disabled:!h,onClick:()=>{r==null||r.reSendOtp(),j(!1),S(60),f=60,$()},class:`ml-4 flex items-center ${h?"text-indigo-500 hover:text-blue-900 cursor-pointer":"text-gray-400 hover:text-none cursor-default"}`,children:[t.jsx("span",{class:"font-bold",children:"Resend OTP"}),t.jsx("i",{class:"bx bx-caret-right ml-1"})]})]}),t.jsxs("div",{class:"w-full text-center mt-5",children:[w&&t.jsx("button",{type:"button",onClick:W,className:"w-full  py-2.5 bg-indigo-600 text-white font-medium text-xs leading-tight  rounded shadow-md hover:bg-indigo-700 hover:shadow-lg focus:bg-indigo-700 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-indigo-800 active:shadow-lg transition duration-150 ease-in-out",children:"Submit"}),!w&&t.jsx("button",{type:"button",className:"w-full  py-2.5 bg-gray-400 text-white font-medium text-xs leading-tight  rounded shadow-md  hover:shadow-lg  focus:shadow-lg focus:outline-none focus:ring-0  transition duration-150 ease-in-out cursor-default ",children:"Submit"})]}),(r==null?void 0:r.bottomNaviation)!=!1&&t.jsx("div",{className:"text-left w-full mt-10 flex justify-center items-center",children:t.jsx("div",{className:"",children:t.jsx("span",{onClick:()=>q("/login"),className:"hover:underline text-indigo-500 font-semibold hover:bg-white px-3 py-1 cursor-pointer float-right",children:"Login "})})})]})]})})})})})]})}export{de as default};
