import{r as k}from"./router-87042356.js";var h={};Object.defineProperty(h,"__esModule",{value:!0});var S=h.useGeolocated=void 0;const e=k;function D(l={}){const{positionOptions:i={enableHighAccuracy:!0,maximumAge:0,timeout:1/0},isOptimisticGeolocationEnabled:d=!0,userDecisionTimeout:n=void 0,suppressLocationOnMount:f=!1,watchPosition:s=!1,geolocationProvider:t=typeof navigator<"u"?navigator.geolocation:void 0,watchLocationPermissionChange:y=!1,onError:a,onSuccess:c}=l,m=(0,e.useRef)(0),P=(0,e.useRef)(!0),g=(0,e.useRef)(0),[C,E]=(0,e.useState)(d),[T,b]=(0,e.useState)(),[A,I]=(0,e.useState)(),[x,w]=(0,e.useState)(),[M,O]=(0,e.useState)(),r=(0,e.useCallback)(()=>{m.current&&window.clearTimeout(m.current)},[]),u=(0,e.useCallback)(o=>{r(),P.current&&(b(()=>{}),E(!1),w(o)),a==null||a(o)},[a,r]),p=(0,e.useCallback)(o=>{r(),P.current&&(b(o.coords),I(o.timestamp),E(!0),w(()=>{})),c==null||c(o)},[c,r]),G=(0,e.useCallback)(()=>{if(!t||!t.getCurrentPosition||!t.watchPosition)throw new Error("The provided geolocation provider is invalid");n&&(m.current=window.setTimeout(()=>{u()},n)),s?g.current=t.watchPosition(p,u,i):t.getCurrentPosition(p,u,i)},[t,s,n,u,p,i]);return(0,e.useEffect)(()=>{let o;return y&&t&&"permissions"in navigator&&navigator.permissions.query({name:"geolocation"}).then(v=>{o=v,o.onchange=()=>{O(o.state)}}).catch(v=>{console.error("Error updating the permissions",v)}),()=>{o&&(o.onchange=null)}},[]),(0,e.useEffect)(()=>(f||G(),()=>{r(),s&&g.current&&(t==null||t.clearWatch(g.current))}),[M]),{getPosition:G,coords:T,timestamp:A,isGeolocationEnabled:C,isGeolocationAvailable:!!t,positionError:x}}S=h.useGeolocated=D;function L(){const{isGeolocationAvailable:l,isGeolocationEnabled:i,getPosition:d,coords:n,positionError:f,timestamp:s}=S({positionOptions:{enableHighAccuracy:!0,timeout:1/0,maximumAge:localStorage.getItem("geoMaxAge")||1/0},watchPosition:!0,userDecisionTimeout:5e3});return{isGeolocationAvailable:l,isGeolocationEnabled:i,coords:n,positionError:f,timestamp:s,getPosition:d}}export{L as u};
