import{j as e}from"./mui-8e804a04.js";import{f as ee,r as i,u as te}from"./router-87042356.js";import{b as y,c as ye,d as p,u as Ne,A as v,m as C,X as w,Z as je,Q as J,$ as we,a0 as K,v as ve,g as _e,P as ae,n as S,y as W}from"./index-0f28b603.js";import{B as oe}from"./BarLoader-9fd00c2c.js";import{B as le}from"./BottomErrorCard-b31e4e97.js";import{M as ne}from"./index-4e794517.js";import{C as ke}from"./CommonModal-340f9ebb.js";import{a as Ie}from"./index.esm-f717eb21.js";import{a as Se}from"./index.esm-799452e3.js";import{_ as Ce}from"./index-05fe6e4f.js";import"./RazorpayPaymentScreen-07e994d7.js";import{C as qe}from"./CitizenApplyApiList-5b22da78.js";import{U as Me}from"./UseRazorpay-62e4000a.js";import"./react-09dd1212.js";import"./axios-97164839.js";import"./reactIcons-6a3b6da1.js";import"./redux-4db06ad6.js";import"./i18next-e99b4042.js";import"./logo1-66954bc2.js";import"./WaterApiList-5dfb5a8b.js";import"./index-48d14c2d.js";const Pe={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",backgroundColor:"white",border:"none"}};ne.setAppElement("#root");function Ee(l){var V,U,$,Q;const{handlePayment:q}=Me(),{id:g}=ee(),{marriageOrderId:_}=ae(),{api_getTransactionNoForReceipt:k,api_generatedreceipt:r}=qe(),[M,P]=i.useState(!1),[E,c]=i.useState(!1),[A,b]=i.useState(null),[F,d]=i.useState(!1),[f,N]=i.useState(!1),[D,I]=i.useState(null),[re,se]=i.useState(null),[de,ie]=i.useState(!1),[O,ce]=i.useState(0);window.localStorage.getItem("citizen_token");const R=te();console.log("saf submit response data at payment...",y()),i.useState(!1);const[L,me]=i.useState();i.useState(!1);let B;function T(){N(!1)}B=ye({paymentMode:p().required("select payment mode"),remarks:p(),bankName:p(),branchName:p(),cheque_dd_no:p(),cheque_dd_date:p()});const o=Ne({initialValues:{paymentMode:"CASH",remarks:"",bankName:"",branchName:"",cheque_dd_no:"",cheque_dd_date:"",payAdvance:"",advanceAmount:""},onSubmit:t=>{console.log("values at submit payment",t),xe(t)&&z()},validationSchema:B}),ue=async t=>{console.log("generateReceipt",t),console.log(t);let s={applicationId:t==null?void 0:t.applicationId,departmentId:t==null?void 0:t.departmentId,status:"",captured:"1",card_id:"",amount:t==null?void 0:t.amount,payment_method:"upi/netbanking",workflow_id:t==null?void 0:t.workflowId,user_id:t==null?void 0:t.user_id,ulb_id:t==null?void 0:t.ulbId,payment_order_id:t==null?void 0:t.razorpay_order_id,payment_id:t==null?void 0:t.razorpay_payment_id,created_at:""};console.log("Receipt",t),v.post(r,s,y()).then(a=>{var m;console.log("genereted receipt",a),a.data.status==!0?(console.log("Oder ID Generated ++++dddddddddddddddddddddddd+++++",a.data),be({orderId:t==null?void 0:t.razorpay_order_id,paymentId:t==null?void 0:t.razorpay_payment_id}),R(`/marriage-payment-receipt/${(m=a==null?void 0:a.data)==null?void 0:m.data}`,{replace:!0})):J.error(a.data.message,"error")}).catch(a=>{console.log("Error genrating order id",a),J.error(a.message,"error")})},xe=t=>{if(console.log("vlaues at ruleset..",t),t.paymentMode=="CHEQUE"||t.paymentMode=="DD"){if(t.bankName==""||t.bankName==null)return u(!0,"Please enter bank name"),!1;if(t.branchName==""||t.branchName==null)return u(!0,"Please enter branch name"),!1;if(t.cheque_dd_no==""||t.cheque_dd_no==null)return u(!0,"Please enter cheque/dd no."),!1;if(t.cheque_dd_date==""||t.cheque_dd_date==null)return u(!0,"Please enter cheque/dd date"),!1}return!0},he=()=>{var t;N(!1),((t=o.values)==null?void 0:t.paymentMode)=="ONLINE"?z():fe(o.values)},ge=t=>{let s=t.target.name,a=t.target.value;s=="paymentMode"&&me(a),s=="remarks"&&o.setFieldValue("remarks",we(a,o.values.remarks,100)),s=="bankName"&&o.setFieldValue("bankName",K(a,o.values.bankName,100)),s=="branchName"&&o.setFieldValue("branchName",K(a,o.values.branchName,100)),s=="cheque_dd_no"&&o.setFieldValue("cheque_dd_no",ve(a,o.values.cheque_dd_no,20)),s=="advanceAmount"&&o.setFieldValue("advanceAmount",_e(a,o.values.advanceAmount,10))},be=t=>{console.log(t),c(!0),d(!1);let s={orderId:t==null?void 0:t.orderId,paymentId:t==null?void 0:t.paymentId};v.post(k,s,y()).then(function(a){var m,x,n,h,j;console.log((m=a==null?void 0:a.data)==null?void 0:m.data),(x=a==null?void 0:a.data)!=null&&x.status?(b((h=(n=a==null?void 0:a.data)==null?void 0:n.data)==null?void 0:h.transaction_no),console.log("transaction no get response...",a==null?void 0:a.data)):u(!0,C((j=a==null?void 0:a.data)==null?void 0:j.message)),c(!1)}).catch(function(a){console.log("transaction no get error...",a),d(!0),c(!1)})},z=async()=>{c(!0);let t,s;t=_,s={applicationId:g},console.log("before get order id...",s),v.post(t,s,y()).then(a=>{var m,x,n,h;console.log("Order Id Response ",a==null?void 0:a.data),((m=a==null?void 0:a.data)==null?void 0:m.status)===!0?(console.log("OrderId Generated True",(x=a==null?void 0:a.data)==null?void 0:x.data),q((n=a==null?void 0:a.data)==null?void 0:n.data,ue)):u(!0,C((h=a==null?void 0:a.data)==null?void 0:h.message)),c(!1)}).catch(a=>{console.log("ERROR :-  Unable to Generate Order Id ",a),c(!1),u(!0,"Unable to generate order id")})},fe=t=>{var m,x;d(!1),c(!0);let s,a;s="",a={id:g,amount:(m=l==null?void 0:l.paymentDetails)==null?void 0:m.totalDues,paymentMode:t==null?void 0:t.paymentMode,ulbId:(x=l==null?void 0:l.basicDetails)==null?void 0:x.ulb_id,chequeDate:t==null?void 0:t.cheque_dd_date,bankName:t==null?void 0:t.bankName,branchName:t==null?void 0:t.branchName,chequeNo:t==null?void 0:t.cheque_dd_no},console.log("before make payment..",a),v.post(s,a,y()).then(function(n){var h,j,G,H,Y,X,Z;console.log("property payment response...",n==null?void 0:n.data),(h=n==null?void 0:n.data)!=null&&h.status?(b((G=(j=n==null?void 0:n.data)==null?void 0:j.data)==null?void 0:G.TransactionNo),I((Y=(H=n==null?void 0:n.data)==null?void 0:H.data)==null?void 0:Y.tranNo),P((X=n==null?void 0:n.data)==null?void 0:X.status)):u(!0,C((Z=n==null?void 0:n.data)==null?void 0:Z.message)),c(!1)}).catch(function(n){console.log("property payment error..",n),u(!0,"Error occured. Please try again later."),c(!1)})};i.useEffect(()=>{var t,s;ce(parseFloat((t=l==null?void 0:l.demand)==null?void 0:t.payment_amount)+parseFloat((s=l==null?void 0:l.demand)==null?void 0:s.penalty_amount))},[]);const u=(t,s)=>{se(s),d(t)};if(E)return e.jsx(e.Fragment,{children:e.jsx(oe,{})});if(M==!0)return e.jsx(e.Fragment,{children:e.jsx("div",{className:"w-full h-full bg-white sm:p-20 p-2",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-center font-semibold text-3xl",children:"Your payment has been successfully done ! Now the application is sent for verification."}),e.jsxs("div",{className:"text-center mt-6",children:[e.jsx("button",{className:"mr-4 bg-indigo-500  text-white px-6 py-1 shadow-lg hover:scale-105 rounded-sm",onClick:()=>R(`/marriage-payment-receipt/${encodeURIComponent(A)}`),children:"View Receipt"}),e.jsx("button",{className:"mr-4 bg-white border border-indigo-500 text-indigo-500 px-4 py-1 shadow-lg hover:scale-105 rounded-sm",onClick:()=>R(`/marriage-details/${g}`),children:"View Application"})]})]})})});const pe=`upi://pay?pa=your-vpa@provider&pn=MerchantName&mc=1234&tid=1234567890&tr=order-id&tn=Payment%20Description&am=${(V=l==null?void 0:l.demand)==null?void 0:V.total_payable_amount}&cu=INR`;return de?e.jsx(ke,{children:e.jsxs("div",{className:"relative bg-white w-[90vw] md:w-[50vw] h-[80vh] md:h-[35vw] py-8 gap-8 border rounded-md shadow-lg shadow-indigo-50 border-indigo-600 flex flex-col justify-center items-center",children:[e.jsx("button",{className:"absolute top-4 right-4 font-bold bg-red-200 p-2 rounded-full shadow-sm hover:bg-red-400",onClick:()=>ie(!1),children:e.jsx(Se,{})}),e.jsx("div",{className:"flex justify-center",children:e.jsx("span",{className:"font-semibold border-b text-xl uppercase",children:"Scan To Pay"})}),e.jsx(Ce,{value:pe}),e.jsx("div",{className:" font-semibold bg-green-300 px-8 py-1.5 rounded-sm",children:w((U=l==null?void 0:l.demand)==null?void 0:U.total_payable_amount)})]})}):e.jsxs(e.Fragment,{children:[e.jsx(je,{position:"top-right",autoClose:2e3}),F&&e.jsx(le,{activateBottomErrorCard:u,errorTitle:re}),e.jsx("div",{className:" block sm:p-4 mt-4 w-full md:py-4 md:px-40 md:pb-0 md:pt-0 rounded-lg shadow-lg bg-white md:w-full mx-auto  overflow-x-auto mb-20 ",children:e.jsx("div",{className:" block p-4 w-full md:py-6 rounded-lg bg-white mx-auto ",children:e.jsxs("form",{onSubmit:o.handleSubmit,onChange:ge,className:"p-4 relative",children:[e.jsxs("div",{className:"grid grid-cols-12",children:[e.jsxs("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[e.jsxs("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:[e.jsx("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"}),"Payment Mode"]}),e.jsx("select",{...o.getFieldProps("paymentMode"),type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md cursor-pointer",children:e.jsx("option",{value:"ONLINE",children:"Online"})}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:o.touched.paymentMode&&o.errors.paymentMode?o.errors.paymentMode:null})]}),e.jsxs("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[e.jsx("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:"Remarks"}),e.jsx("input",{...o.getFieldProps("remarks"),type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md",placeholder:"Enter Remarks"}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:o.touched.remarks&&o.errors.remarks?o.errors.remarks:null})]}),(L=="CHEQUE"||L=="DD")&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[e.jsxs("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:[e.jsx("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"}),"Bank Name"]}),e.jsx("input",{...o.getFieldProps("bankName"),type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md",placeholder:"Enter Bank Name"}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:o.touched.bankName&&o.errors.bankName?o.errors.bankName:null})]}),e.jsxs("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[e.jsxs("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:[e.jsx("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"}),"Branch Name"]}),e.jsx("input",{...o.getFieldProps("branchName"),type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md",placeholder:"Enter Branch Name"}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:o.touched.branchName&&o.errors.branchName?o.errors.branchName:null})]}),e.jsxs("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[e.jsxs("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:[e.jsx("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"}),"Cheque/DD No"]}),e.jsx("input",{...o.getFieldProps("cheque_dd_no"),type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md",placeholder:"Enter Cheque/DD No"}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:o.touched.cheque_dd_no&&o.errors.cheque_dd_no?o.errors.cheque_dd_no:null})]}),e.jsxs("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[e.jsxs("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:[e.jsx("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"}),"Cheque/DD Date"]}),e.jsx("input",{...o.getFieldProps("cheque_dd_date"),type:"date",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md cursor-pointer",placeholder:"Enter new ward no."}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:o.touched.cheque_dd_date&&o.errors.cheque_dd_date?o.errors.cheque_dd_date:null})]})]}),e.jsx("div",{className:"col-span-12"}),e.jsxs("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[e.jsx("span",{children:"Amount :"})," ",e.jsx("span",{className:"font-mono font-semibold",children:w(($=l==null?void 0:l.demand)==null?void 0:$.payment_amount)})]}),e.jsxs("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[e.jsx("span",{children:"Penalty :"})," ",e.jsx("span",{className:"font-mono font-semibold",children:w((Q=l==null?void 0:l.demand)==null?void 0:Q.penalty_amount)})]}),e.jsx("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:e.jsxs("div",{className:"w-2/3",children:[e.jsx("span",{children:"Total Payable Amount :"})," ",e.jsx("span",{className:"font-mono font-semibold text-xl",children:w(O)})]})})]}),e.jsxs("div",{className:"col-span-12 grid grid-cols-2 sm:mt-10 mt-6",children:[e.jsx("div",{className:""}),e.jsx("div",{className:"md:pl-10 text-right",children:o.values.paymentMode!="ONLINE"?e.jsxs("button",{type:"submit",className:"sm:ml-4 font-bold sm:px-6 px-1.5 py-2 bg-indigo-500 text-white text-xs sm:text-sm leading-tight uppercase rounded  hover:bg-indigo-700 hover:shadow-lg focus:shadow-lg focus:outline-none focus:ring-0 active:bg-indigo-800 active:shadow-lg transition duration-150 ease-in-out shadow-xl border border-white",children:[e.jsx("span",{className:"sm:mr-2 mr-1",children:"Pay "}),w(O)]}):e.jsx("button",{type:"submit",className:"sm:ml-4 font-bold sm:px-6 px-1.5 py-2 bg-indigo-500 text-white text-xs sm:text-sm leading-tight uppercase rounded  hover:bg-indigo-700 hover:shadow-lg focus:shadow-lg focus:outline-none focus:ring-0 active:bg-indigo-800 active:shadow-lg transition duration-150 ease-in-out shadow-xl border border-white",children:e.jsx("span",{className:"sm:mr-2 mr-1",children:"Genrate QR"})})})]})]})})}),e.jsx(ne,{isOpen:f,onRequestClose:T,style:Pe,contentLabel:"Example Modal",children:e.jsxs("div",{class:"relative bg-white rounded-lg shadow-xl border-2 border-gray-50",children:[e.jsx("button",{onClick:T,type:"button",class:"absolute top-3 right-2.5 text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm p-1.5 ml-auto inline-flex items-center dark:hover:bg-gray-800 dark:hover:text-white",children:e.jsx("svg",{class:"w-5 h-5",fill:"currentColor",children:e.jsx("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})})}),e.jsxs("div",{class:"p-6 text-center",children:[e.jsxs("div",{className:"w-full flex h-10",children:[" ",e.jsx("span",{className:"mx-auto",children:e.jsx(Ie,{size:30})})]}),e.jsx("h3",{class:"mb-5 text-lg font-normal text-gray-500 dark:text-gray-400",children:"Confirm Payment"}),e.jsx("button",{type:"button",class:"text-white bg-green-600 hover:bg-green-800 focus:ring-4 focus:outline-none focus:ring-red-300 dark:focus:ring-red-800 font-medium rounded-lg text-sm inline-flex items-center px-5 py-2.5 text-center mr-2",onClick:he,children:"Yes, I'm sure"})]})]})})]})}const et=()=>{const l=te(),{api_getDetails:q}=ae(),{id:g}=ee(),[_,k]=i.useState(!1),[r,M]=i.useState(null),[P,E]=i.useState(!1),[c,A]=i.useState(""),b=(d,f)=>{A(f),E(d)};i.useEffect(()=>{F()},[]);const F=()=>{k(!0),v.post(q,{applicationId:g},y()).then(d=>{var f,N,D,I;console.log("getting response of user data => ",d),(f=d==null?void 0:d.data)!=null&&f.status?(console.log("user data => ",(N=d==null?void 0:d.data)==null?void 0:N.data),M((D=d==null?void 0:d.data)==null?void 0:D.data)):b(!0,C((I=d==null?void 0:d.data)==null?void 0:I.message))}).catch(d=>{console.log("getting error doc list for marriage => ",d),b(!0,"Error getting document list, please try again later !")}).finally(()=>{k(!1)})};return e.jsxs(e.Fragment,{children:[_&&e.jsx(oe,{}),!_&&e.jsxs("div",{className:"animate__animated animate__fadeIn animate__faster overflow-x-hidden overflow-y-scroll w-[99%] mx-auto rounded-md gap-6 h-full p-[1vw]",children:[e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx("h1",{className:"bg-white shadow-lg shadow-indigo-300 text-indigo-500 border-[0.17vw] border-indigo-500 px-[4vw] py-[1.5vh] w-max font-semibold text-[2.8vh]",children:"Marriage Payment Screen"})}),P&&e.jsx(le,{activateBottomErrorCard:b,errorTitle:c}),e.jsxs("div",{className:"flex items-center flex-wrap w-full text-sm bg-white p-4 shadow-lg gap-2 mt-4",children:[e.jsxs("div",{className:"flex flex-col flex-wrap justify-center w-full md:w-[22%]",children:[e.jsx("div",{children:"Application No. "}),e.jsx("div",{className:"font-semibold text-base",children:S(r==null?void 0:r.application_no)})]}),e.jsxs("div",{className:"flex flex-col flex-wrap justify-center w-full md:w-[22%]",children:[e.jsx("div",{children:"Groom Name "}),e.jsx("div",{className:"font-semibold text-base",children:S(r==null?void 0:r.groom_name)})]}),e.jsxs("div",{className:"flex flex-col flex-wrap justify-center w-full md:w-[22%]",children:[e.jsx("div",{children:"Bride Name "}),e.jsx("div",{className:"font-semibold text-base",children:S(r==null?void 0:r.bride_name)})]}),e.jsxs("div",{className:"flex flex-col flex-wrap justify-center w-full md:w-[22%]",children:[e.jsx("div",{children:"Marriage Date "}),e.jsx("div",{className:"font-semibold text-base",children:W(r==null?void 0:r.marriage_date)})]}),e.jsxs("div",{className:"flex flex-col flex-wrap justify-center w-full md:w-[22%]",children:[e.jsx("div",{children:"Marriage Place "}),e.jsx("div",{className:"font-semibold text-base",children:S(r==null?void 0:r.marriage_place)})]}),e.jsxs("div",{className:"flex flex-col flex-wrap justify-center w-full md:w-[22%]",children:[e.jsx("div",{children:"Appointment Date "}),e.jsx("div",{className:"font-semibold text-base",children:W(r==null?void 0:r.appointment_date)})]})]}),e.jsx("div",{children:r!=null&&r.is_bpl?e.jsx(e.Fragment,{children:e.jsx("div",{className:"w-full h-full bg-white sm:p-20 p-2",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-center font-semibold text-3xl",children:"As you belongs to BPL category, so you don't need to pay. And your application is sent for verification."}),e.jsx("div",{className:"text-center mt-6",children:e.jsx("button",{className:"mr-4 bg-white border border-indigo-500 text-indigo-500 px-4 py-1 shadow-lg hover:scale-105 rounded-sm",onClick:()=>l(`/marriage-details/${g}`),children:"View Application"})})]})})}):e.jsx(Ee,{demand:r})})]})]})};export{et as default};
